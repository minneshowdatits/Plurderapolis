<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PLURderapolis ‚Äî Community Harm Reduction & Safety for Minnesota's Music Scene</title>
    <meta name="description" content="A Minnesota-based hub for PLUR, safety, and substance harm reduction. Find non-judgmental resources, emergency tools, and community support for the Twin Cities electronic music scene.">
    <meta name="keywords" content="harm reduction, Minnesota, Minneapolis, rave, electronic music, PLUR, substance safety, overdose prevention, Narcan, naloxone, Minneapolis skyline, festival safety, consent, sober rave, mental health, Twin Cities">
    <meta name="author" content="PLURderapolis">
    <meta name="geo.region" content="US-MN">
    <meta name="geo.placename" content="Minneapolis, Saint Paul, Twin Cities">

    <!-- Open Graph / Social Media -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://plurderapolis.org/">
    <meta property="og:title" content="PLURderapolis ‚Äî Community Harm Reduction for Minnesota's Music Scene">
    <meta property="og:description" content="Your grassroots hub for safety, PLUR, and non-judgmental support in the Twin Cities electronic music community.">
    <meta property="og:image" content="https://plurderapolis.org/images/social-preview.jpg">

    <!-- Twitter Card -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://plurderapolis.org/">
    <meta property="twitter:title" content="PLURderapolis ‚Äî Community Harm Reduction for Minnesota's Music Scene">
    <meta property="twitter:description" content="Your grassroots hub for safety, PLUR, and non-judgmental support in the Twin Cities electronic music community.">
    <meta property="twitter:image" content="https://plurderapolis.org/images/social-preview.jpg">

    <!-- Structured Data for Local Organization -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "PLURderapolis",
        "description": "A community harm reduction organization serving Minnesota's electronic music scene.",
        "url": "https://plurderapolis.org",
        "logo": "https://plurderapolis.org/images/logo.png",
        "sameAs": [
            "https://www.instagram.com/plurderapolis",
            "https://www.facebook.com/plurderapolis"
        ],
        "areaServed": {
            "@type": "State",
            "name": "Minnesota"
        },
        "contactPoint": {
            "@type": "ContactPoint",
            "email": "plurderapolis@gmail.com",
            "contactType": "Customer service"
        }
    }
    </script>

    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üçë</text></svg>">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700;800;900&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Core Palette */
            --primary-neon: #00f7e0;
            --secondary-pink: #ff69b4;
            --accent-purple: #bf00bf;
            --accent-blue: #00b7ff;
            --accent-green: #00c896;
            --accent-orange: #ff9a7a;

            /* UI Colors */
            --bg-deep: #0a0a12;
            --bg-card: rgba(26, 15, 45, 0.85);
            --bg-card-solid: #1a0f2d;
            --text-light: #ffffff;
            --text-medium: #d0cae3;
            --text-muted: #8a7ca5;
            --border-glow: rgba(0, 247, 224, 0.3);

            /* Spacing */
            --space-xs: 0.5rem;
            --space-sm: 0.8rem;
            --space-md: 1.2rem;
            --space-lg: 1.8rem;
            --space-xl: 2.5rem;

            /* Border Radius */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 20px;

            /* Shadows & Glows */
            --shadow-card: 0 8px 32px rgba(0, 0, 0, 0.4);
            --shadow-glow: 0 0 15px var(--primary-neon);
            --shadow-glow-pink: 0 0 15px var(--secondary-pink);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            scroll-behavior: smooth;
            scroll-padding-top: 5rem;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--bg-deep);
            color: var(--text-light);
            line-height: 1.6;
            overflow-x: hidden;
            padding-bottom: 80px; /* Space for mobile HUD */
        }

        /* ==================== */
        /* ANIMATED BACKGROUND */
        /* ==================== */
        .animated-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
            overflow: hidden;
        }

        .bg-gradient {
            position: absolute;
            width: 100%;
            height: 100%;
            background:
                radial-gradient(circle at 10% 20%, rgba(191, 0, 191, 0.15) 0%, transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(0, 247, 224, 0.1) 0%, transparent 40%),
                radial-gradient(circle at 50% 50%, rgba(255, 105, 180, 0.05) 0%, transparent 50%);
            animation: gradientPulse 25s ease infinite alternate;
        }

        @keyframes gradientPulse {
            0% { opacity: 0.6; }
            100% { opacity: 1; }
        }

        .bg-particles {
            position: absolute;
            width: 100%;
            height: 100%;
        }

        .particle {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.05);
            animation: floatParticle 30s infinite linear;
        }

        .pulse-dot {
            position: absolute;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            background: var(--primary-neon);
            animation: pulseDot 4s infinite ease-in-out;
            opacity: 0.5;
        }

        @keyframes floatParticle {
            0% { transform: translateY(100vh) rotate(0deg); opacity: 0; }
            10%, 90% { opacity: 0.3; }
            100% { transform: translateY(-100px) rotate(360deg); opacity: 0; }
        }

        @keyframes pulseDot {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(2); opacity: 0.7; }
        }

        /* ==================== */
        /* MINNEAPOLIS SKYLINE */
        /* ==================== */
        .minneapolis-skyline {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 35%;
            z-index: -1;
            overflow: hidden;
        }

        .skyline-container {
            position: absolute;
            bottom: 0;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 2px;
        }

        .skyline-building {
            background: linear-gradient(to top, rgba(20, 10, 40, 0.9), rgba(60, 30, 90, 0.7));
            border-top-left-radius: 6px;
            border-top-right-radius: 6px;
            position: relative;
            box-shadow: inset 0 0 10px rgba(255, 255, 255, 0.05);
        }

        /* Representative Minneapolis building heights/widths */
        .building-1 { width: 30px; height: 140px; animation: buildingGlow 8s infinite alternate 0s; }
        .building-2 { width: 45px; height: 180px; animation: buildingGlow 8s infinite alternate 1s; } /* IDS-like */
        .building-3 { width: 25px; height: 100px; animation: buildingGlow 8s infinite alternate 2s; }
        .building-4 { width: 60px; height: 160px; animation: buildingGlow 8s infinite alternate 3s; }
        .building-5 { width: 35px; height: 120px; animation: buildingGlow 8s infinite alternate 4s; }
        .building-6 { width: 50px; height: 200px; animation: buildingGlow 8s infinite alternate 5s; } /* Capella-like */
        .building-7 { width: 40px; height: 110px; animation: buildingGlow 8s infinite alternate 6s; }

        .skyline-building::before {
            content: '';
            position: absolute;
            top: 10px;
            left: 5px;
            right: 5px;
            bottom: 10px;
            background-image:
                linear-gradient(90deg, transparent 10%, rgba(0, 247, 224, 0.07) 10%, rgba(0, 247, 224, 0.07) 20%, transparent 20%),
                linear-gradient(180deg, transparent 10%, rgba(255, 105, 180, 0.05) 10%, rgba(255, 105, 180, 0.05) 20%, transparent 20%);
            background-size: 20px 20px;
            opacity: 0.4;
        }

        /* Rave Antennas/Lights */
        .building-2::after, .building-6::after {
            content: '';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 10px;
            height: 15px;
            background: var(--primary-neon);
            border-radius: 50% 50% 0 0;
            box-shadow: 0 0 10px var(--primary-neon);
            animation: antennaFlash 2s infinite;
        }

        .building-6::after {
            background: var(--secondary-pink);
            box-shadow: 0 0 10px var(--secondary-pink);
            animation-delay: 0.5s;
        }

        @keyframes buildingGlow {
            0% { box-shadow: inset 0 0 5px rgba(0, 247, 224, 0.1); }
            100% { box-shadow: inset 0 0 15px rgba(255, 105, 180, 0.2); }
        }

        @keyframes antennaFlash {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .mississippi-river {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 20px;
            background: linear-gradient(to bottom, rgba(0, 183, 255, 0.25), rgba(0, 247, 224, 0.1));
            border-top: 1px solid rgba(0, 247, 224, 0.3);
        }

        /* Stone Arch Bridge Representation */
        .stone-arch-bridge {
            position: absolute;
            bottom: 20px;
            left: 25%;
            width: 50%;
            height: 8px;
            background: linear-gradient(to bottom, #4a3765, #2d1b4e);
            border-radius: 8px 8px 0 0;
            box-shadow: 0 0 10px rgba(0, 247, 224, 0.2);
        }

        .stone-arch-bridge::before {
            content: '';
            position: absolute;
            top: -12px;
            left: 0;
            right: 0;
            height: 12px;
            background:
                repeating-linear-gradient(90deg,
                    transparent,
                    transparent 15px,
                    rgba(0, 247, 224, 0.15) 15px,
                    rgba(0, 247, 224, 0.15) 30px
                );
        }

        /* ==================== */
        /* HEADER & NAVIGATION */
        /* ==================== */
        .site-header {
            text-align: center;
            padding: var(--space-lg) var(--space-md) var(--space-sm);
            position: relative;
            z-index: 10;
        }

        .logo-title {
            font-family: 'Montserrat', sans-serif;
            font-weight: 900;
            font-size: clamp(2.5rem, 8vw, 3.5rem);
            letter-spacing: 0.1em;
            text-transform: uppercase;
            margin-bottom: var(--space-xs);
            background: linear-gradient(90deg, var(--primary-neon), var(--secondary-pink), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            filter: drop-shadow(0 0 8px rgba(0, 247, 224, 0.4));
        }

        .tagline {
            font-family: 'Inter', sans-serif;
            font-weight: 500;
            font-size: clamp(0.9rem, 3vw, 1.1rem);
            color: var(--text-medium);
            letter-spacing: 0.05em;
            max-width: 600px;
            margin: 0 auto;
        }

        /* Mobile Navigation Toggle */
        .mobile-nav-toggle {
            position: fixed;
            top: var(--space-sm);
            left: var(--space-sm);
            z-index: 1002;
            width: 48px;
            height: 48px;
            border-radius: var(--radius-sm);
            background: rgba(26, 15, 45, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid var(--border-glow);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mobile-nav-toggle span {
            display: block;
            width: 22px;
            height: 2px;
            background-color: var(--primary-neon);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .mobile-nav-toggle.active span:nth-child(1) {
            transform: rotate(45deg) translate(5px, 5px);
        }
        .mobile-nav-toggle.active span:nth-child(2) {
            opacity: 0;
        }
        .mobile-nav-toggle.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -6px);
        }

        /* Mobile Navigation Drawer */
        .mobile-nav {
            position: fixed;
            top: 0;
            left: -100%;
            width: 85%;
            max-width: 320px;
            height: 100%;
            background: rgba(10, 5, 20, 0.98);
            backdrop-filter: blur(20px);
            z-index: 1001;
            padding: var(--space-xl) var(--space-lg) var(--space-lg);
            overflow-y: auto;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            border-right: 1px solid var(--border-glow);
        }

        .mobile-nav.active {
            left: 0;
        }

        .nav-category {
            margin-bottom: var(--space-lg);
        }

        .nav-category-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.1rem;
            color: var(--primary-neon);
            margin-bottom: var(--space-sm);
            padding-bottom: var(--space-xs);
            border-bottom: 1px solid rgba(255, 105, 180, 0.2);
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
        }

        .nav-category-title .toggle-icon {
            transition: transform 0.3s ease;
            font-size: 0.9rem;
        }

        .nav-category.active .nav-category-title .toggle-icon {
            transform: rotate(180deg);
        }

        .nav-links {
            display: flex;
            flex-direction: column;
            gap: var(--space-xs);
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.4s ease;
        }

        .nav-category.active .nav-links {
            max-height: 500px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: var(--space-sm);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            color: var(--text-light);
            text-decoration: none;
            font-size: 0.95rem;
            transition: all 0.2s ease;
            border-left: 3px solid transparent;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(4px);
            border-left-color: var(--secondary-pink);
        }

        .nav-link .icon {
            margin-right: var(--space-sm);
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
        }

        .nav-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(3px);
            z-index: 1000;
        }

        .nav-overlay.active {
            display: block;
        }

        /* ==================== */
        /* SEARCH CONTAINER */
        /* ==================== */
        .search-container {
            position: relative;
            width: 90%;
            max-width: 700px;
            margin: var(--space-lg) auto;
            z-index: 5;
        }

        .search-box {
            display: flex;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-lg);
            border: 1px solid var(--border-glow);
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-card);
        }

        .search-box:focus-within {
            border-color: var(--primary-neon);
            box-shadow: var(--shadow-glow);
        }

        .search-box input {
            flex: 1;
            padding: var(--space-md) var(--space-lg);
            border: none;
            background: transparent;
            color: var(--text-light);
            font-size: 1rem;
            font-family: 'Inter', sans-serif;
            outline: none;
        }

        .search-box input::placeholder {
            color: var(--text-muted);
        }

        .search-box button {
            padding: 0 var(--space-lg);
            border: none;
            background: linear-gradient(135deg, var(--primary-neon), var(--accent-blue));
            color: var(--bg-deep);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.2s ease;
            font-family: 'Montserrat', sans-serif;
            min-width: 80px;
        }

        .search-box button:hover {
            opacity: 0.9;
        }

        #searchResults {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: var(--bg-card-solid);
            border-radius: 0 0 var(--radius-lg) var(--radius-lg);
            max-height: 350px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: var(--shadow-card);
            border: 1px solid var(--primary-neon);
            border-top: none;
        }

        #searchResults ul {
            list-style: none;
        }

        #searchResults li {
            padding: var(--space-md);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background 0.2s ease;
            display: flex;
            align-items: center;
        }

        #searchResults li:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        #searchResults li .result-icon {
            margin-right: var(--space-sm);
            font-size: 1.2rem;
        }

        #searchResults li .result-category {
            margin-left: auto;
            font-size: 0.75rem;
            color: var(--text-muted);
            background: rgba(0, 0, 0, 0.3);
            padding: 3px 8px;
            border-radius: 20px;
        }

        /* ==================== */
        /* MAIN CONTENT GRID */
        /* ==================== */
        .main-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: var(--space-lg);
            padding: var(--space-md);
            max-width: 1400px;
            margin: 0 auto;
        }

        @media (min-width: 1024px) {
            .main-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .content-card {
            background: var(--bg-card);
            backdrop-filter: blur(10px);
            border-radius: var(--radius-md);
            padding: var(--space-lg);
            box-shadow: var(--shadow-card);
            transition: all 0.3s ease;
            border: 1px solid transparent;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .content-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, var(--primary-neon), var(--secondary-pink));
        }

        .content-card:hover {
            transform: translateY(-5px);
            border-color: var(--border-glow);
            box-shadow: var(--shadow-card), 0 5px 20px rgba(0, 247, 224, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: var(--space-md);
        }

        .card-header h2 {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--text-light);
            line-height: 1.3;
        }

        .card-icon {
            font-size: 1.8rem;
            margin-bottom: var(--space-sm);
        }

        .card-content {
            color: var(--text-medium);
            font-size: 0.95rem;
            line-height: 1.6;
            flex-grow: 1;
            margin-bottom: var(--space-lg);
        }

        .card-cta {
            display: inline-block;
            margin-top: auto;
            padding: var(--space-sm) var(--space-md);
            background: linear-gradient(135deg, var(--primary-neon), var(--accent-blue));
            color: var(--bg-deep);
            text-decoration: none;
            border-radius: var(--radius-sm);
            font-weight: 700;
            text-align: center;
            transition: all 0.2s ease;
            border: none;
            font-family: 'Montserrat', sans-serif;
            font-size: 0.95rem;
        }

        .card-cta:hover {
            opacity: 0.9;
            transform: scale(1.03);
        }

        /* ==================== */
        /* DONATION SECTION */
        /* ==================== */
        #donate-section {
            grid-column: 1 / -1; /* Full width */
            background: linear-gradient(135deg, rgba(58, 0, 82, 0.9), rgba(191, 0, 191, 0.7));
            border: 1px solid var(--secondary-pink);
        }

        #donate-section::before {
            background: linear-gradient(90deg, var(--secondary-pink), var(--accent-purple));
        }

        .donate-header {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .donate-header h2 {
            color: #fff;
            margin: 0;
        }

        .donate-qr {
            text-align: center;
            margin: var(--space-lg) 0;
            padding: var(--space-md);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-md);
        }

        .qr-placeholder {
            width: 180px;
            height: 180px;
            margin: 0 auto var(--space-md);
            background: linear-gradient(45deg, #fff 25%, #eee 25%, #eee 50%, #fff 50%, #fff 75%, #eee 75%);
            background-size: 20px 20px;
            border-radius: var(--radius-sm);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--bg-deep);
            font-weight: 900;
            font-size: 1.2rem;
        }

        .venmo-handle {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.8rem;
            color: #fff;
            margin: var(--space-sm) 0;
            letter-spacing: 1px;
        }

        .venmo-handle span {
            color: var(--primary-neon);
        }

        .donate-note {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.8);
            font-style: italic;
            margin-top: var(--space-md);
        }

        /* ==================== */
        /* MOBILE HUD */
        /* ==================== */
        .mobile-hud {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background: rgba(26, 15, 45, 0.95);
            backdrop-filter: blur(15px);
            display: flex;
            justify-content: space-around;
            padding: var(--space-sm);
            z-index: 990;
            border-top: 1px solid var(--border-glow);
        }

        @media (min-width: 768px) {
            .mobile-hud {
                display: none;
            }
        }

        .hud-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-light);
            text-decoration: none;
            font-size: 0.7rem;
            padding: 5px;
            flex: 1;
            text-align: center;
            transition: all 0.2s ease;
            border-radius: var(--radius-sm);
        }

        .hud-btn span {
            font-size: 1.3rem;
            margin-bottom: 3px;
        }

        .hud-btn:hover {
            background: rgba(255, 105, 180, 0.15);
        }

        /* ==================== */
        /* PANIC BUTTON */
        /* ==================== */
        #panicButtonWrapper {
            position: fixed;
            top: 140px;
            right: 20px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            touch-action: none;
        }

        @media (max-width: 768px) {
            #panicButtonWrapper {
                top: auto;
                bottom: 90px;
                right: 20px;
            }
        }

        #panicButton {
            width: 70px;
            height: 70px;
            font-size: 3rem;
            background: radial-gradient(circle at 30% 30%, #ffb07c, #ff6f91);
            border-radius: 50% 50% 45% 55% / 60% 55% 45% 50%;
            position: relative;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            text-decoration: none;
            color: #fff;
            box-shadow:
                0 0 15px var(--secondary-pink),
                0 0 30px rgba(0, 247, 224, 0.3);
            animation: panicPulse 3s infinite;
            user-select: none;
            border: 2px solid #fff;
        }

        #panicButton:hover {
            animation: none;
            transform: scale(1.15);
            box-shadow:
                0 0 20px var(--secondary-pink),
                0 0 40px rgba(0, 247, 224, 0.5);
        }

        #panicButton::before {
            content: "";
            position: absolute;
            top: -10px;
            left: 25px;
            width: 20px;
            height: 15px;
            background: linear-gradient(135deg, #ff9a7a, #ff7a5a);
            border-radius: 50%;
            transform: rotate(-20deg);
        }

        .panic-help-text {
            color: #ff9a7a;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(255, 154, 122, 0.6);
            font-size: 0.8rem;
            text-align: center;
            animation: blink 2s infinite;
        }

        @keyframes panicPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* ==================== */
        /* EMERGENCY MODAL */
        /* ==================== */
        .emergency-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: var(--space-md);
        }

        .modal-content {
            background: var(--bg-card-solid);
            padding: var(--space-lg);
            border-radius: var(--radius-md);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 2px solid var(--primary-neon);
            box-shadow: var(--shadow-glow);
            position: relative;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-lg);
            padding-bottom: var(--space-sm);
            border-bottom: 1px solid var(--primary-neon);
        }

        .modal-header h2 {
            color: var(--primary-neon);
            font-size: 1.6rem;
        }

        .close-modal {
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 2rem;
            cursor: pointer;
            line-height: 1;
            padding: 0;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .emergency-steps ol {
            padding-left: 1.5rem;
            margin-bottom: var(--space-lg);
        }

        .emergency-steps li {
            margin-bottom: var(--space-sm);
            color: var(--text-medium);
        }

        .mn-resource-box {
            background: rgba(0, 0, 0, 0.3);
            padding: var(--space-md);
            border-radius: var(--radius-sm);
            margin-top: var(--space-md);
            border-left: 4px solid var(--accent-green);
        }

        .mn-resource-box h4 {
            color: var(--accent-green);
            margin-bottom: var(--space-xs);
        }

        /* ==================== */
        /* FOOTER */
        /* ==================== */
        footer {
            margin-top: var(--space-xl);
            padding: var(--space-lg) var(--space-md);
            background: rgba(0, 0, 0, 0.7);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            text-align: center;
            font-size: 0.9rem;
            color: var(--text-muted);
        }

        .footer-links {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: var(--space-lg);
            margin: var(--space-lg) 0;
        }

        .footer-column h3 {
            color: var(--primary-neon);
            font-size: 1rem;
            margin-bottom: var(--space-sm);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .footer-column a {
            display: block;
            color: var(--text-medium);
            text-decoration: none;
            margin-bottom: 5px;
            font-size: 0.85rem;
            transition: color 0.2s ease;
        }

        .footer-column a:hover {
            color: var(--primary-neon);
        }

        .social-row {
            display: flex;
            justify-content: center;
            gap: var(--space-md);
            margin: var(--space-lg) 0;
        }

        .social-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: var(--space-sm) var(--space-md);
            background: rgba(255, 255, 255, 0.05);
            border-radius: var(--radius-sm);
            color: var(--text-light);
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.2s ease;
            border: 1px solid transparent;
        }

        .social-btn:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--primary-neon);
            transform: translateY(-2px);
        }

        .legal-disclaimer {
            font-size: 0.75rem;
            color: var(--text-muted);
            margin-top: var(--space-lg);
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <!-- Animated Background with Minneapolis Skyline -->
    <div class="animated-background">
        <div class="bg-gradient"></div>
        <div class="bg-particles" id="particles"></div>
        <div class="minneapolis-skyline">
            <div class="skyline-container">
                <div class="skyline-building building-1"></div>
                <div class="skyline-building building-2"></div>
                <div class="skyline-building building-3"></div>
                <div class="skyline-building building-4"></div>
                <div class="skyline-building building-5"></div>
                <div class="skyline-building building-6"></div>
                <div class="skyline-building building-7"></div>
            </div>
            <div class="stone-arch-bridge"></div>
            <div class="mississippi-river"></div>
        </div>
    </div>

    <!-- Mobile Navigation Toggle -->
    <button class="mobile-nav-toggle" id="mobileNavToggle">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <!-- Navigation Overlay -->
    <div class="nav-overlay" id="navOverlay"></div>

    <!-- Mobile Navigation Drawer -->
    <nav class="mobile-nav" id="mobileNav">
        <div class="nav-category active">
            <div class="nav-category-title">
                Safety & Emergency
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="nav-links">
                <a href="panic.html" class="nav-link"><span class="icon">üö®</span>Panic Button</a>
                <a href="emergency.html" class="nav-link"><span class="icon">üÜò</span>Emergency Guides</a>
                <a href="spiking.html" class="nav-link"><span class="icon">üö´</span>Drink Spiking Info</a>
                <a href="badtrip.html" class="nav-link"><span class="icon">üåà</span>Bad Trip Support</a>
                <a href="ride-safety.html" class="nav-link"><span class="icon">üåÉ</span>Rideshare Safety</a>
            </div>
        </div>

        <div class="nav-category">
            <div class="nav-category-title">
                Substance Information
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="nav-links">
                <a href="polydrug.html" class="nav-link"><span class="icon">‚ö°</span>Interaction Tool</a>
                <a href="rx-combos.html" class="nav-link"><span class="icon">üíä</span>RX + Substance Combos</a>
                <a href="health.html" class="nav-link"><span class="icon">üíö</span>Raver Health Guide</a>
                <a href="symptoms.html" class="nav-link"><span class="icon">ü§í</span>Symptom Checker</a>
                <a href="fake.html" class="nav-link"><span class="icon">‚ö†Ô∏è</span>Substance Alerts</a>
            </div>
        </div>

        <div class="nav-category">
            <div class="nav-category-title">
                Consent & Community
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="nav-links">
                <a href="consent.html" class="nav-link"><span class="icon">‚úÖ</span>Consent Basics</a>
                <a href="accountability.html" class="nav-link"><span class="icon">‚öñÔ∏è</span>Accountability</a>
                <a href="rejection-based-violence.html" class="nav-link"><span class="icon">üõ°Ô∏è</span>Violence Prevention</a>
            </div>
        </div>

        <div class="nav-category">
            <div class="nav-category-title">
                Local Scene
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="nav-links">
                <a href="venues-guide.html" class="nav-link"><span class="icon">üè¢</span>Venues Guide</a>
                <a href="booth.html" class="nav-link"><span class="icon">üéâ</span>Our Harm Reduction Booth</a>
            </div>
        </div>

        <div class="nav-category">
            <div class="nav-category-title">
                More Resources
                <span class="toggle-icon">‚ñº</span>
            </div>
            <div class="nav-links">
                <a href="seasonal-tips.html" class="nav-link"><span class="icon">üåû</span>Seasonal Tips</a>
                <a href="sober.html" class="nav-link"><span class="icon">üö´</span>Sober Ravers</a>
                <a href="resources.html" class="nav-link"><span class="icon">üìö</span>MN Resources</a>
            </div>
        </div>

        <!-- Donation Link in Nav -->
        <a href="#donate" class="card-cta" style="margin-top: var(--space-lg); background: linear-gradient(135deg, var(--secondary-pink), var(--accent-purple));">
            üíñ Support Our Mission
        </a>
    </nav>

    <!-- Main Header -->
    <header class="site-header">
        <h1 class="logo-title">PLURderapolis</h1>
        <p class="tagline">Peace, Love, Unity, Respect & Harm Reduction for the Twin Cities Music Community[citation:4]</p>
    </header>

    <!-- Site Search -->
    <div class="search-container">
        <div class="search-box">
            <input type="text" id="searchInput" placeholder="Search for safety info, resources, guides...">
            <button onclick="performSiteSearch()">SEARCH</button>
        </div>
        <div id="searchResults"></div>
    </div>

    <!-- Main Content Grid -->
    <main class="main-grid">
        <!-- Card 1: Emergency Tools -->
        <section class="content-card">
            <div class="card-icon">üö®</div>
            <div class="card-header">
                <h2>Emergency Tools & Quick Response</h2>
            </div>
            <p class="card-content">Immediate access to life-saving guides, emergency contacts, and step-by-step crisis response for overdose and medical situations in Minnesota.</p>
            <a href="panic.html" class="card-cta">Access Emergency Tools</a>
        </section>

        <!-- Card 2: Substance Safety -->
        <section class="content-card">
            <div class="card-icon">üî¨</div>
            <div class="card-header">
                <h2>Substance Safety & Interaction Info</h2>
            </div>
            <p class="card-content">Non-judgmental information about substance effects, risky combinations, and how to reduce potential harm. Includes Minnesota-specific alerts.</p>
            <a href="polydrug.html" class="card-cta">Explore Safety Info</a>
        </section>

        <!-- Card 3: Hydration & Wellness -->
        <section class="content-card">
            <div class="card-icon">üíß</div>
            <div class="card-header">
                <h2>Hydration & Buddy Check-ins</h2>
            </div>
            <p class="card-content">Set customizable timers to remind you to drink water, eat, and check on your friends. Essential for long events and festivals.</p>
            <a href="#hydration" class="card-cta">Set a Reminder</a>
        </section>

        <!-- Card 4: Our Mission -->
        <section class="content-card">
            <div class="card-icon">üí°</div>
            <div class="card-header">
                <h2>What We Do: Grassroots Harm Reduction</h2>
            </div>
            <p class="card-content">PLURderapolis provides resources, education, and direct support to make Minnesota's electronic music scene safer and more inclusive for everyone[citation:1][citation:6].</p>
            <a href="booth.html" class="card-cta">Learn About Our Work</a>
        </section>

        <!-- Card 5: MN Resources -->
        <section class="content-card">
            <div class="card-icon">üìö</div>
            <div class="card-header">
                <h2>Minnesota Resources Directory</h2>
            </div>
            <p class="card-content">A curated list of local clinics, mental health support, naloxone (Narcan) access, and other essential services in the Twin Cities area.</p>
            <a href="resources.html" class="card-cta">Find Local Help</a>
        </section>

        <!-- Card 6: Sober & Substance-Free -->
        <section class="content-card">
            <div class="card-icon">üçπ</div>
            <div class="card-header">
                <h2>Sober & Substance-Free Community</h2>
            </div>
            <p class="card-content">Resources, mocktail recipes, and support for enjoying the music scene without substances. You're welcome here[citation:1].</p>
            <a href="sober.html" class="card-cta">Explore Sober Resources</a>
        </section>

        <!-- Card 7: Consent & Safety -->
        <section class="content-card">
            <div class="card-icon">üõ°Ô∏è</div>
            <div class="card-header">
                <h2>Consent Culture & Violence Prevention</h2>
            </div>
            <p class="card-content">Tools and education to foster respect, prevent harassment, and build accountable communities where everyone feels safe.</p>
            <a href="consent.html" class="card-cta">Build Safer Spaces</a>
        </section>

        <!-- Card 8: About Us -->
        <section class="content-card">
            <div class="card-icon">üìñ</div>
            <div class="card-header">
                <h2>Our Story: Minnesota Roots</h2>
            </div>
            <p class="card-content">Born from years of grassroots work at Twin Cities warehouse shows, clubs, and festivals, we're your partners in creating a safer, kinder scene[citation:1][citation:6].</p>
            <a href="booth.html" class="card-cta">Read Our Story</a>
        </section>

        <!-- DONATION SECTION - Full Width -->
        <section id="donate-section" class="content-card">
            <div class="donate-header">
                <div class="card-icon">üíñ</div>
                <div>
                    <h2>Support Our Harm Reduction Work</h2>
                    <p class="card-content">Your donation directly funds naloxone kits, test strips, booth supplies, and education for Minnesota events.</p>
                </div>
            </div>

            <div class="donate-qr">
                <div class="qr-placeholder">QR Code</div>
                <p>Scan with Venmo to donate</p>
                <div class="venmo-handle">@<span>plurderapolis</span></div>
                <p style="color: var(--text-medium); margin-top: var(--space-sm);">Every contribution helps keep our community safer.</p>

                <a href="https://venmo.com/plurderapolis" target="_blank" class="card-cta" style="background: linear-gradient(135deg, #3D95CE, #8B5BFF); margin-top: var(--space-md);">
                    Open Venmo to Donate
                </a>
            </div>

            <p class="donate-note">Free sticker with every donation! Email plurderapolis@gmail.com after donating with your mailing address[citation:6].</p>
        </section>
    </main>

    <!-- Mobile HUD -->
    <nav class="mobile-hud">
        <a href="panic.html" class="hud-btn"><span>üö®</span>Panic</a>
        <a href="polydrug.html" class="hud-btn"><span>üî¨</span>Tool</a>
        <a href="resources.html" class="hud-btn"><span>üìö</span>MN Help</a>
        <a href="#donate" class="hud-btn"><span>üíñ</span>Donate</a>
        <a href="badtrip.html" class="hud-btn"><span>üåà</span>Calm</a>
    </nav>

    <!-- Panic Button -->
    <div id="panicButtonWrapper">
        <div id="panicButton">üçë</div>
        <div class="panic-help-text">HELP!</div>
    </div>

    <!-- Emergency Modal -->
    <div class="emergency-modal" id="emergencyModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üö® Emergency Assistance</h2>
                <button class="close-modal" onclick="closeEmergencyModal()">&times;</button>
            </div>

            <div class="emergency-steps">
                <h3>If someone is unresponsive:</h3>
                <ol>
                    <li><strong>Check for responsiveness</strong> ‚Äì Tap shoulder and shout.</li>
                    <li><strong>Call 911 immediately</strong> ‚Äì Give clear location details.</li>
                    <li><strong>Check breathing</strong> ‚Äì Look for chest movement for 5-10 seconds.</li>
                    <li><strong>Administer Naloxone (Narcan)</strong> if available and you are trained.</li>
                    <li><strong>Perform rescue breaths</strong> if they are not breathing.</li>
                    <li><strong>Place in recovery position</strong> if breathing but unconscious.</li>
                </ol>

                <h3>Signs of Opioid Overdose:</h3>
                <ul>
                    <li>Unresponsive to loud voice or firm touch</li>
                    <li>Slow, irregular, or stopped breathing</li>
                    <li>Pale, ashen, or clammy skin</li>
                    <li>Blue or purple lips/fingertips</li>
                    <li>Gurgling or snoring sounds</li>
                </ul>
            </div>

            <div class="mn-resource-box">
                <h4>Minnesota-Specific Good Samaritan Law</h4>
                <p>Minnesota law (151.37) provides protection from arrest and prosecution for certain drug-related crimes for a person who seeks medical assistance for another person experiencing a drug-related overdose[citation:9]. <strong>Your call for help can save a life.</strong></p>
            </div>

            <div class="mn-resource-box">
                <h4>Minnesota Crisis & Overdose Prevention Resources</h4>
                <p><strong>Statewide Crisis Line:</strong> Call or Text <strong>988</strong> or **CRISIS (**74747)</p>
                <p><strong>MN Poison Control:</strong> 1-800-222-1222</p>
                <p><strong>MN Naloxone Finder:</strong> Visit mn.gov/naloxone</p>
            </div>

            <div style="display: flex; gap: var(--space-sm); flex-wrap: wrap; margin-top: var(--space-lg);">
                <a href="emergency.html" class="card-cta">More Detailed Guides</a>
                <a href="resources.html" class="card-cta" style="background: linear-gradient(135deg, var(--secondary-pink), var(--accent-purple));">Find MN Narcan</a>
                <button class="card-cta" onclick="closeEmergencyModal()" style="background: var(--text-muted);">Close</button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="footer-links">
            <div class="footer-column">
                <h3>Safety & Emergency</h3>
                <a href="panic.html">Panic Button</a>
                <a href="emergency.html">Emergency Guides</a>
                <a href="spiking.html">Drink Spiking Info</a>
                <a href="badtrip.html">Bad Trip Support</a>
                <a href="ride-safety.html">Rideshare Safety</a>
            </div>
            <div class="footer-column">
                <h3>Substance Info</h3>
                <a href="polydrug.html">Interaction Tool</a>
                <a href="rx-combos.html">RX + Substance Combos</a>
                <a href="health.html">Raver Health</a>
                <a href="symptoms.html">Symptom Checker</a>
                <a href="fake.html">Substance Alerts</a>
            </div>
            <div class="footer-column">
                <h3>Community</h3>
                <a href="consent.html">Consent Basics</a>
                <a href="accountability.html">Accountability</a>
                <a href="rejection-based-violence.html">Violence Prevention</a>
                <a href="venues-guide.html">Venues Guide</a>
                <a href="booth.html">Our Booth</a>
            </div>
            <div class="footer-column">
                <h3>More</h3>
                <a href="seasonal-tips.html">Seasonal Tips</a>
                <a href="sober.html">Sober Ravers</a>
                <a href="resources.html">MN Resources</a>
                <a href="#donate">Donate</a>
                <a href="mailto:plurderapolis@gmail.com">Contact</a>
            </div>
        </div>

        <div class="social-row">
            <a href="https://www.facebook.com/plurderapolis" class="social-btn" target="_blank">
                <span>üìò</span> Facebook
            </a>
            <a href="https://www.instagram.com/plurderapolis" class="social-btn" target="_blank">
                <span>üì∑</span> Instagram
            </a>
            <a href="https://venmo.com/plurderapolis" class="social-btn" target="_blank" style="background: linear-gradient(135deg, #3D95CE, #8B5BFF);">
                <span>üíñ</span> Venmo
            </a>
        </div>

        <p class="legal-disclaimer">
            <strong>Disclaimer:</strong> PLURderapolis provides harm reduction education and resources for the Minnesota community. This information is not medical or legal advice. In an emergency, always call 911. We support the principles of PLUR (Peace, Love, Unity, Respect) and strive to create safer spaces for all[citation:4]. Content is intended for adults and complies with Minnesota state laws regarding harm reduction education.
        </p>

        <p style="margin-top: var(--space-md); color: var(--text-muted); font-size: 0.8rem;">
            &copy; 2025 PLURderapolis ‚Äî Community Harm Reduction. Your partners in shine. ‚ú¶
        </p>
    </footer>

    <script>
        // ============================================
        // 1. INITIALIZATION & UTILITIES
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            initializePage();
            createParticles();
            loadTimerSettings();
            setupSearch();
        });

        function initializePage() {
            // Set current year in footer if needed
            // document.querySelector('footer p').innerHTML = document.querySelector('footer p').innerHTML.replace('2025', new Date().getFullYear());
            console.log('PLURderapolis initialized. Peace, Love, Unity, Respect[citation:4].');
        }

        // ============================================
        // 2. PARTICLE BACKGROUND
        // ============================================
        function createParticles() {
            const container = document.getElementById('particles');
            const colors = [
                'rgba(0, 247, 224, 0.15)',
                'rgba(255, 105, 180, 0.12)',
                'rgba(191, 0, 191, 0.1)',
                'rgba(0, 183, 255, 0.1)'
            ];

            // Create floating particles
            for (let i = 0; i < 25; i++) {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                const size = 1 + Math.random() * 5;
                particle.style.width = size + 'px';
                particle.style.height = size + 'px';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.background = colors[Math.floor(Math.random() * colors.length)];
                particle.style.animationDelay = Math.random() * 25 + 's';
                particle.style.animationDuration = (20 + Math.random() * 20) + 's';
                container.appendChild(particle);
            }

            // Create pulse dots
            for (let i = 0; i < 15; i++) {
                const dot = document.createElement('div');
                dot.classList.add('pulse-dot');
                dot.style.left = Math.random() * 100 + '%';
                dot.style.top = Math.random() * 100 + '%';
                dot.style.animationDelay = Math.random() * 6 + 's';
                container.appendChild(dot);
            }
        }

        // ============================================
        // 3. MOBILE NAVIGATION
        // ============================================
        const mobileNavToggle = document.getElementById('mobileNavToggle');
        const mobileNav = document.getElementById('mobileNav');
        const navOverlay = document.getElementById('navOverlay');
        const navCategories = document.querySelectorAll('.nav-category');

        mobileNavToggle.addEventListener('click', () => {
            mobileNavToggle.classList.toggle('active');
            mobileNav.classList.toggle('active');
            navOverlay.classList.toggle('active');
            document.body.style.overflow = mobileNav.classList.contains('active') ? 'hidden' : '';
        });

        navOverlay.addEventListener('click', () => {
            mobileNavToggle.classList.remove('active');
            mobileNav.classList.remove('active');
            navOverlay.classList.remove('active');
            document.body.style.overflow = '';
        });

        navCategories.forEach(category => {
            const title = category.querySelector('.nav-category-title');
            title.addEventListener('click', () => {
                category.classList.toggle('active');
            });
        });

        // ============================================
        // 4. PANIC BUTTON & EMERGENCY MODAL
        // ============================================
        const panicButton = document.getElementById('panicButton');
        const emergencyModal = document.getElementById('emergencyModal');
        const panicWrapper = document.getElementById('panicButtonWrapper');

        panicButton.addEventListener('click', (e) => {
            e.preventDefault();
            showEmergencyModal();
            logAnalyticsEvent('panic_button', 'emergency_modal_opened');
        });

        function showEmergencyModal() {
            emergencyModal.style.display = 'flex';
            document.body.style.overflow = 'hidden';
        }

        function closeEmergencyModal() {
            emergencyModal.style.display = 'none';
            document.body.style.overflow = '';
        }

        // Close modal on outside click
        emergencyModal.addEventListener('click', (e) => {
            if (e.target === emergencyModal) closeEmergencyModal();
        });

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && emergencyModal.style.display === 'flex') {
                closeEmergencyModal();
            }
        });

        // Draggable Panic Button for desktop
        if (window.innerWidth > 768) {
            makeDraggable(panicWrapper);
        }

        function makeDraggable(element) {
            let isDragging = false;
            let startX, startY, initialX, initialY;

            element.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', stopDrag);

            function startDrag(e) {
                if (e.target === panicButton) return; // Don't drag if clicking the peach itself
                isDragging = true;
                startX = e.clientX;
                startY = e.clientY;
                const rect = element.getBoundingClientRect();
                initialX = rect.left;
                initialY = rect.top;
                element.style.cursor = 'grabbing';
            }

            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();
                const dx = e.clientX - startX;
                const dy = e.clientY - startY;

                let newX = initialX + dx;
                let newY = initialY + dy;

                // Boundary checks
                newX = Math.max(10, Math.min(newX, window.innerWidth - element.offsetWidth - 10));
                newY = Math.max(10, Math.min(newY, window.innerHeight - element.offsetHeight - 10));

                element.style.left = newX + 'px';
                element.style.top = newY + 'px';
                element.style.right = 'auto';
                element.style.bottom = 'auto';
            }

            function stopDrag() {
                isDragging = false;
                element.style.cursor = '';
            }
        }

        // ============================================
        // 5. SITE SEARCH FUNCTIONALITY
        // ============================================
        // Comprehensive site index for search
        const siteIndex = [
            {
                title: "Home",
                url: "index.html",
                category: "Main",
                keywords: ["harm reduction", "PLUR", "Minnesota", "Minneapolis", "rave", "community", "safety"],
                content: "PLURderapolis homepage: Harm reduction resources, safety tools, and community support for Minnesota's electronic music scene."
            },
            {
                title: "Panic Button & Emergency Guide",
                url: "panic.html",
                category: "Safety",
                keywords: ["panic", "emergency", "overdose", "naloxone", "Narcan", "911", "crisis", "response", "help"],
                content: "Immediate emergency instructions for overdose response, Minnesota Good Samaritan law, and life-saving steps."
            },
            {
                title: "Substance Interaction Tool",
                url: "polydrug.html",
                category: "Substance Safety",
                keywords: ["interaction", "combination", "risk", "polydrug", "mix", "danger", "effects", "safety"],
                content: "Interactive tool to understand risks of combining different substances. Learn about dangerous interactions."
            },
            {
                title: "Minnesota Resources Directory",
                url: "resources.html",
                category: "Local",
                keywords: ["Minnesota", "Twin Cities", "Minneapolis", "St Paul", "clinic", "mental health", "counseling", "naloxone", "Narcan", "where to get help"],
                content: "Directory of Minnesota-based resources: clinics, mental health services, naloxone access, crisis lines, and support groups."
            },
            {
                title: "Consent & Community Culture",
                url: "consent.html",
                category: "Community",
                keywords: ["consent", "boundaries", "respect", "harassment", "violence prevention", "safer spaces", "accountability"],
                content: "Educational resources on consent, building respectful communities, and preventing harassment at events."
            },
            {
                title: "Sober & Substance-Free Resources",
                url: "sober.html",
                category: "Community",
                keywords: ["sober", "substance-free", "mocktail", "recovery", "alcohol-free", "enjoy without substances"],
                content: "Support and resources for enjoying the music scene without substances, including mocktail recipes and community tips."
            },
            {
                title: "Our Harm Reduction Booth",
                url: "booth.html",
                category: "Local",
                keywords: ["booth", "event", "festival", "volunteer", "naloxone", "test strips", "water", "safe space", "PLURderapolis booth"],
                content: "Information about our physical harm reduction booth at Twin Cities events. See our schedule, services, and how to request us."
            },
            {
                title: "Hydration & Buddy Check-in Timer",
                url: "#",
                category: "Tool",
                keywords: ["timer", "hydrate", "water", "buddy", "check-in", "reminder", "wellness", "self-care"],
                content: "Set customizable timers to remind you to drink water, eat, and check on your friends during events."
            },
            {
                title: "RX & Substance Combinations",
                url: "rx-combos.html",
                category: "Substance Safety",
                keywords: ["prescription", "medication", "RX", "antidepressant", "SSRI", "mix", "risk", "interaction"],
                content: "Information about the risks of combining prescription medications with other substances."
            },
            {
                title: "Bad Trip & Difficult Experience Support",
                url: "badtrip.html",
                category: "Safety",
                keywords: ["bad trip", "difficult experience", "calm", "grounding", "panic", "anxiety", "support"],
                content: "Resources and techniques to help manage difficult psychoactive experiences, including grounding exercises."
            },
            {
                title: "Drink Spiking Prevention & Response",
                url: "spiking.html",
                category: "Safety",
                keywords: ["drink spiking", "date rape", "prevention", "safety", "roofie", "awareness"],
                content: "Information on how to prevent drink spiking, recognize signs, and respond if it happens."
            },
            {
                title: "Venue Safety Guide",
                url: "venues-guide.html",
                category: "Local",
                keywords: ["venue", "Minneapolis", "St Paul", "club", "safety", "layout", "exits", "medical"],
                content: "Guide to Twin Cities music venues, including safety features, medical tent locations, and harm reduction resources."
            }
        ];

        const searchInput = document.getElementById('searchInput');
        const searchResults = document.getElementById('searchResults');

        function setupSearch() {
            searchInput.addEventListener('input', debounce(performSiteSearch, 250));
            searchInput.addEventListener('focus', () => { if (searchInput.value) performSiteSearch(); });

            // Close results on click outside
            document.addEventListener('click', (e) => {
                if (!e.target.closest('.search-container')) {
                    searchResults.style.display = 'none';
                }
            });
        }

        function performSiteSearch() {
            const query = searchInput.value.trim().toLowerCase();
            searchResults.innerHTML = '';
            searchResults.style.display = 'none';

            if (query.length < 2) return;

            const results = [];

            siteIndex.forEach(item => {
                let score = 0;
                const titleMatch = item.title.toLowerCase().includes(query);
                const contentMatch = item.content.toLowerCase().includes(query);
                const keywordMatch = item.keywords.some(kw => kw.toLowerCase().includes(query));

                if (titleMatch) score += 10;
                if (contentMatch) score += 5;
                if (keywordMatch) score += 3;

                if (score > 0) {
                    results.push({ ...item, score });
                }
            });

            // Sort by score
            results.sort((a, b) => b.score - a.score);

            if (results.length > 0) {
                const resultsList = document.createElement('ul');
                results.slice(0, 8).forEach(item => { // Limit to 8 results
                    const li = document.createElement('li');
                    li.innerHTML = `
                        <span class="result-icon">${getIconForCategory(item.category)}</span>
                        <div style="flex: 1;">
                            <strong>${item.title}</strong><br>
                            <small style="color: var(--text-medium);">${item.content.substring(0, 80)}...</small>
                        </div>
                        <span class="result-category">${item.category}</span>
                    `;
                    li.addEventListener('click', () => {
                        window.location.href = item.url;
                        logAnalyticsEvent('search_click', item.title);
                    });
                    resultsList.appendChild(li);
                });
                searchResults.appendChild(resultsList);
                searchResults.style.display = 'block';
            } else {
                searchResults.innerHTML = '<div style="padding: var(--space-md); text-align: center; color: var(--text-medium);">No results found. Try different keywords.</div>';
                searchResults.style.display = 'block';
            }
        }

        function getIconForCategory(category) {
            switch(category) {
                case 'Safety': return 'üö®';
                case 'Substance Safety': return 'üî¨';
                case 'Local': return 'üìç';
                case 'Community': return 'üë•';
                case 'Tool': return 'üõ†Ô∏è';
                case 'Main': return 'üè†';
                default: return 'üìÑ';
            }
        }

        // Debounce for search performance
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // ============================================
        // 6. HYDRATION TIMER FUNCTIONALITY
        // ============================================
        let timers = {
            water: { running: false, endTime: null, interval: 60, element: 'water-status' },
            buddy: { running: false, endTime: null, interval: 120, element: 'buddy-status' },
            eat: { running: false, endTime: null, interval: 180, element: 'eat-status' }
        };

        function loadTimerSettings() {
            const saved = localStorage.getItem('plurderapolisTimers');
            if (saved) {
                const parsed = JSON.parse(saved);
                Object.keys(timers).forEach(key => {
                    if (parsed[key]) {
                        timers[key] = { ...timers[key], ...parsed[key] };
                        // If timer was running, check if it's expired
                        if (timers[key].running && timers[key].endTime) {
                            if (Date.now() > timers[key].endTime) {
                                timers[key].running = false;
                                timers[key].endTime = null;
                            }
                        }
                    }
                });
            }
            updateAllTimerDisplays();
            setInterval(updateAllTimerDisplays, 1000);
        }

        function startTimer(type) {
            if (!timers[type]) return;
            timers[type].running = true;
            timers[type].endTime = Date.now() + (timers[type].interval * 60 * 1000);
            saveTimers();
            updateTimerDisplay(type);

            // Show notification if permission granted
            if ("Notification" in window && Notification.permission === "granted") {
                new Notification(`PLURderapolis ${type} reminder started`, {
                    body: `I'll remind you in ${timers[type].interval} minutes.`,
                    icon: '/favicon.ico'
                });
            }
        }

        function updateAllTimerDisplays() {
            Object.keys(timers).forEach(key => updateTimerDisplay(key));
        }

        function updateTimerDisplay(type) {
            const timer = timers[type];
            const element = document.getElementById(timer.element);
            if (!element) return;

            if (timer.running && timer.endTime) {
                const remaining = timer.endTime - Date.now();
                if (remaining <= 0) {
                    element.textContent = "NOW!";
                    element.style.color = "var(--secondary-pink)";
                    element.style.fontWeight = "bold";
                    // Trigger browser notification
                    if ("Notification" in window && Notification.permission === "granted") {
                        new Notification(`Time to ${type === 'water' ? 'drink water' : type === 'buddy' ? 'check on your buddy' : 'eat something'}!`, {
                            body: 'Take care of yourself and your friends.',
                            icon: '/favicon.ico'
                        });
                    }
                } else {
                    const minutes = Math.floor(remaining / 60000);
                    const seconds = Math.floor((remaining % 60000) / 1000);
                    element.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
                    element.style.color = "var(--primary-neon)";
                    element.style.fontWeight = "normal";
                }
            } else {
                element.textContent = "--:--";
                element.style.color = "var(--text-muted)";
            }
        }

        function saveTimers() {
            localStorage.setItem('plurderapolisTimers', JSON.stringify(timers));
        }

        // Request notification permission on first timer start
        function requestNotificationPermission() {
            if ("Notification" in window && Notification.permission === "default") {
                Notification.requestPermission();
            }
        }

        // ============================================
        // 7. ANALYTICS & USAGE TRACKING (Local, Anonymous)
        // ============================================
        let analyticsData = {
            totalVisits: 0,
            lastVisit: null,
            resourcesClicked: {},
            sectionsOpened: {},
            panicButtonClicks: 0
        };

        function loadAnalytics() {
            const saved = localStorage.getItem('plurderapolisAnalytics');
            if (saved) {
                analyticsData = JSON.parse(saved);
            }
            analyticsData.totalVisits++;
            analyticsData.lastVisit = new Date().toISOString();
            saveAnalytics();
        }

        function logAnalyticsEvent(event, detail) {
            if (!analyticsData[event]) analyticsData[event] = 0;
            analyticsData[event]++;
            saveAnalytics();
        }

        function saveAnalytics() {
            localStorage.setItem('plurderapolisAnalytics', JSON.stringify(analyticsData));
        }

        // Load analytics on page load
        loadAnalytics();

        // ============================================
        // 8. SMOOTH SCROLLING & MOBILE UX
        // ============================================
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                if (targetId === '#') return;

                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    // Close mobile nav if open
                    mobileNav.classList.remove('active');
                    mobileNavToggle.classList.remove('active');
                    navOverlay.classList.remove('active');
                    document.body.style.overflow = '';

                    // Scroll to element
                    window.scrollTo({
                        top: targetElement.offsetTop - 80,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Add a subtle hover effect to all cards on desktop
        if (window.innerWidth > 768) {
            document.querySelectorAll('.content-card').forEach(card => {
                card.addEventListener('mouseenter', () => {
                    card.style.transform = 'translateY(-8px)';
                });
                card.addEventListener('mouseleave', () => {
                    card.style.transform = 'translateY(0)';
                });
            });
        }
    </script>
</body>
</html>
