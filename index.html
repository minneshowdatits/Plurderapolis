<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PLURderapolis ‚Äî mobile prototype</title>
<style>
  :root{
    --bg:#1C1C1C;
    --text:#F5F5F5;
    --plum:#5D3A7D;
    --pink:#E040FB;
    --teal:#00CED1;
    --peach:#FF8C69;
    --card-radius:12px;
  }
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;}
  .app{max-width:420px;margin:0 auto;padding:18px 16px 120px;box-sizing:border-box;}
  /* Header + skyline */
  .header{position:relative;padding-top:6px;padding-bottom:12px;text-align:center}
  .brand{font-weight:800;font-size:34px;letter-spacing:0.6px;color:var(--teal);text-shadow:0 6px 18px rgba(0,206,209,0.08)}
  .tag{font-size:12px;color:var(--text);opacity:.85;margin-top:6px}
  .skyline-wrap{position:relative;margin-top:12px;height:90px;overflow:visible}
  .skyline{width:100%;height:100%;display:block;opacity:.85;filter:drop-shadow(0 8px 36px rgba(90,30,120,0.06));}
  /* Search */
  .search-row{display:flex;gap:8px;margin:14px 0;align-items:center}
  .search{flex:1;position:relative}
  .search input{width:100%;padding:12px 12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:var(--text);outline:none;font-size:15px}
  .lang{background:transparent;color:var(--text);border:none;padding:8px;border-radius:8px}
  .search-suggestions{position:absolute;left:0;right:0;top:100%;background:linear-gradient(180deg,#141218, #17151a);border-radius:10px;margin-top:8px;padding:6px 6px;box-shadow:0 8px 36px rgba(0,0,0,0.6);z-index:40;display:none;max-height:240px;overflow:auto}
  .search-suggestions li{list-style:none;padding:10px;border-radius:8px;color:var(--text);font-size:14px;cursor:pointer}
  .search-suggestions li:hover{background:rgba(255,255,255,0.02)}
  /* CTA */
  .cta{display:block;margin:12px auto 18px;padding:12px 18px;border-radius:14px;background:var(--peach);color:#111;font-weight:700;text-align:center;box-shadow:0 6px 18px rgba(255,140,105,0.18)}
  /* Quick grid */
  .section-head{color:var(--plum);font-weight:700;margin:8px 0 12px}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  .card{border-radius:var(--card-radius);padding:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border:1px solid rgba(255,255,255,0.03);display:flex;gap:10px;align-items:center;min-height:64px}
  .card .icon{width:36px;height:36px;border-radius:8px;display:flex;align-items:center;justify-content:center}
  .card .label{font-size:15px;font-weight:600}
  /* Color accents */
  .c-peach{border:2px solid rgba(255,140,105,0.15;)}
  .c-peach .icon{color:var(--peach)}
  .c-teal .icon{color:var(--teal)}
  .c-pink .icon{color:var(--pink)}
  .c-plum .icon{color:var(--plum)}
  /* Footer */
  footer{margin-top:18px;padding-top:12px;border-top:1px solid rgba(255,255,255,0.03);font-size:13px;line-height:1.5;opacity:.95}
  .footer-links{display:flex;flex-wrap:wrap;gap:10px;margin:8px 0}
  .group{min-width:48%;margin-bottom:6px}
  .legal{font-size:12px;color:rgba(255,255,255,0.68);margin-top:12px}
  /* Floating peach */
  #peachBtn{position:fixed;right:14px;bottom:18px;width:64px;height:64px;border-radius:999px;display:flex;align-items:center;justify-content:center;background:var(--peach);box-shadow:0 10px 34px rgba(255,140,105,0.28);z-index:999;touch-action:none;border:none}
  #peachBtn svg{width:42px;height:42px}
  #peachBtn:focus{outline:3px solid rgba(255,255,255,0.12)}
  /* Nav - hamburger */
  .hamburger{position:fixed;left:12px;top:12px;z-index:1000;background:transparent;border:0;padding:8px;display:flex;align-items:center;justify-content:center}
  .hamburger .bars{width:28px;height:18px;position:relative}
  .hamburger .bars span{position:absolute;height:3px;background:linear-gradient(90deg,var(--pink),var(--teal));left:0;right:0;border-radius:3px}
  .hamburger .bars span:nth-child(1){top:0}
  .hamburger .bars span:nth-child(2){top:7px}
  .hamburger .bars span:nth-child(3){top:14px}
  .side-nav{position:fixed;left:-280px;top:0;height:100%;width:280px;background:linear-gradient(0deg,#0f0f11, #131116);padding:48px 18px;transition:left .32s cubic-bezier(.2,.9,.2,1);z-index:980;box-shadow:6px 0 40px rgba(0,0,0,0.6)}
  .side-nav.open{left:0}
  .side-nav h3{color:var(--pink);margin-top:6px}
  .side-nav nav a{display:block;padding:10px 6px;border-radius:8px;color:var(--text);text-decoration:none;margin-bottom:6px}
  /* small devices tweaks */
  @media(min-width:640px){
    .app{max-width:640px}
  }
</style>
</head>
<body>
<button class="hamburger" id="hamburger" aria-label="Open menu" aria-expanded="false">
  <span class="bars" aria-hidden="true"><span></span><span></span><span></span></span>
</button>

<div class="side-nav" id="sideNav" aria-hidden="true">
  <h3>PLURderapolis</h3>
  <nav>
    <strong style="color:var(--teal)">Safety</strong>
    <a href="#panic">Panic Button</a>
    <a href="#emergency">Emergency Response</a>
    <a href="#drink">Drink Spiking</a>
    <a href="#raver-safety">Raver Safety</a>

    <strong style="color:var(--pink)">Drug Info</strong>
    <a href="#polydrug">Polydrug Tool</a>
    <a href="#rxcombos">RX + Party Combos</a>
    <a href="#health">Raver Health</a>

    <strong style="color:var(--plum)">Consent</strong>
    <a href="#consent">Consent Basics</a>
    <a href="#accountability">Accountability</a>

    <strong style="color:var(--teal)">Local Scene</strong>
    <a href="#mn-resources">MN Resources</a>
    <a href="#venues">Venue Guide</a>
    <a href="#calendar">Event Calendar</a>

    <strong style="color:var(--pink)">Other</strong>
    <a href="#badtrip">Bad Trip</a>
    <a href="#spotify">Spotify</a>
    <a href="#seasonal">Seasonal Tips</a>

    <hr style="opacity:.06;margin:10px 0" />
    <button id="lockPeach" style="padding:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--text);border-radius:8px;width:100%;">Lock panic button</button>
  </nav>
</div>

<div class="app" id="app">
  <header class="header">
    <div class="brand">PLURderapolis</div>
    <div class="tag">Harm reduction, safety, and community care for Minnesota ravers</div>

    <div class="skyline-wrap" aria-hidden="true">
      <!-- Simple neon skyline placeholder: replace with your detailed Minneapolis SVG -->
      <svg class="skyline" viewBox="0 0 800 120" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
        <defs>
          <linearGradient id="g" x1="0" x2="1"><stop offset="0" stop-color="var(--plum)"/><stop offset="1" stop-color="var(--teal)"/></linearGradient>
        </defs>
        <rect fill="transparent" width="100%" height="100%"></rect>
        <g stroke="url(#g)" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round" transform="translate(0,12)">
          <!-- stylized blocks -->
          <path d="M10 80 L10 50 L40 50 L40 80" />
          <path d="M60 80 L60 30 L110 30 L110 80" />
          <path d="M130 80 L130 45 L170 45 L170 80" />
          <path d="M190 80 L190 20 L230 20 L230 80" />
          <path d="M250 80 L250 65 L280 65 L280 80" />
          <path d="M300 80 L300 36 L360 36 L360 80" />
          <path d="M380 80 L380 60 L410 60 L410 80" />
          <path d="M430 80 L430 28 L470 28 L470 80" />
          <path d="M490 80 L490 50 L540 50 L540 80" />
          <path d="M560 80 L560 22 L610 22 L610 80" />
          <path d="M630 80 L630 46 L680 46 L680 80" />
        </g>
      </svg>
    </div>
  </header>

  <div class="search-row">
    <div class="search" style="flex:1">
      <input id="searchInput" inputmode="search" placeholder="Search the site ‚Äî try 'naloxone', 'bad trip', 'venues'..." aria-label="Site search" autocomplete="off">
      <ul id="suggestions" class="search-suggestions" role="listbox" aria-live="polite"></ul>
    </div>
    <select id="lang" class="lang" aria-label="Select language">
      <option value="en">EN</option>
      <option value="es">ES</option>
      <option value="hm">HM</option>
      <option value="ar">AR</option>
    </select>
  </div>

  <a class="cta" href="#howto">HOW TO USE THIS SITE</a>

  <div>
    <div class="section-head">QUICK ACCESS</div>
    <div style="display:flex;justify-content:flex-end;margin-bottom:6px;color:var(--text);opacity:.9">Espa√±ol ‚ñæ</div>
    <div class="grid" role="list">
      <a class="card c-peach" href="#panic"><div class="icon">‚ö†Ô∏è</div><div class="label">Emergency</div></a>
      <a class="card c-teal" href="#badtrip"><div class="icon">‚òπÔ∏è</div><div class="label">Bad Trip Mode</div></a>

      <a class="card c-pink" href="#polydrug"><div class="icon">üíä</div><div class="label">Polydrug Tool</div></a>
      <a class="card c-teal" href="#sober"><div class="icon">‚≠ê</div><div class="label">Sober Ravers</div></a>

      <a class="card c-plum" href="#drink"><div class="icon">ü•§</div><div class="label">Drink Safety</div></a>
      <a class="card c-pink" href="#consent"><div class="icon">ü§ù</div><div class="label">Consent</div></a>

      <a class="card c-teal" href="#mn-resources"><div class="icon">üìç</div><div class="label">MN Resources</div></a>
      <a class="card c-teal" href="#raver-safety"><div class="icon">üéß</div><div class="label">Raver Safety</div></a>
    </div>
  </div>

  <footer>
    <div class="footer-links">
      <div class="group">
        <strong>Safety</strong><br>
        <a href="#panic">Panic / Emergency</a> ¬∑ <a href="#drink">Drink Safety</a> ¬∑ <a href="#raver-safety">Raver Safety</a>
      </div>
      <div class="group">
        <strong>Drug Info</strong><br>
        <a href="#polydrug">Polydrug Tool</a> ¬∑ <a href="#rxcombos">RX + Party Combos</a> ¬∑ <a href="#health">Raver Health</a>
      </div>
      <div class="group">
        <strong>Consent</strong><br>
        <a href="#consent">Consent Basics</a> ¬∑ <a href="#accountability">Accountability</a>
      </div>
      <div class="group">
        <strong>Local</strong><br>
        <a href="#mn-resources">MN Resources</a> ¬∑ <a href="#venues">Venue Guide</a> ¬∑ <a href="#calendar">Event Calendar</a>
      </div>
    </div>

    <div class="legal">
      PLURderapolis provides harm reduction resources for educational purposes only. We do not encourage illegal activity. Always prioritize your safety and follow local laws.
    </div>
  </footer>
</div>

<!-- Peach panic button (movable, snap to screen edge, saves position) -->
<button id="peachBtn" title="Peach panic button - drag me" aria-label="Peach panic button">
  <!-- simple peach SVG - you can replace with your branded SVG -->
  <svg viewBox="0 0 64 64" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <g transform="translate(0,2)">
      <ellipse cx="32" cy="34" rx="17" ry="16" fill="#FFAC86"/>
      <ellipse cx="26" cy="28" rx="7" ry="7" fill="#fff" opacity="0.12"/>
      <path d="M42 17c-2-5-9-8-12-6" fill="none" stroke="#6FAF73" stroke-width="2" stroke-linecap="round"/>
      <path d="M40 14c1.3 1.2 2.5 3.8 2.5 6" fill="none" stroke="#7DAE7D" stroke-width="2" stroke-linecap="round"/>
    </g>
  </svg>
</button>

<script>
/* ---------------------------
   Basic client-side search
   --------------------------- */
const pages = [
  { id:'home', title:'Home', url:'#home', keywords:['home']},
  { id:'panic', title:'Panic Button', url:'#panic', keywords:['panic','emergency']},
  { id:'emergency', title:'Emergency Response', url:'#emergency', keywords:['overdose','naloxone','911']},
  { id:'drink', title:'Drink Safety', url:'#drink', keywords:['drink','spiking']},
  { id:'polydrug', title:'Polydrug Tool', url:'#polydrug', keywords:['polydrug','mix','combos']},
  { id:'rxcombos', title:'RX + Party Combos', url:'#rxcombos', keywords:['rx','meds','combinations']},
  { id:'health', title:'Raver Health', url:'#health', keywords:['health','safety']},
  { id:'consent', title:'Consent Basics', url:'#consent', keywords:['consent','boundaries']},
  { id:'accountability', title:'Accountability', url:'#accountability', keywords:['accountability']},
  { id:'mn-resources', title:'MN Resources', url:'#mn-resources', keywords:['mn','resources','local']},
  { id:'venues', title:'Venue Guide', url:'#venues', keywords:['venue','map']},
  { id:'calendar', title:'Event Calendar', url:'#calendar', keywords:['events','calendar']},
  { id:'badtrip', title:'Bad Trip Mode', url:'#badtrip', keywords:['bad trip','panic','grounding']},
  { id:'spotify', title:'Spotify', url:'#spotify', keywords:['music','playlist']},
  { id:'seasonal', title:'Seasonal Tips', url:'#seasonal', keywords:['seasonal','weather']},
  { id:'sober', title:'Sober Ravers', url:'#sober', keywords:['sober','sober raver']},
  { id:'raver-safety', title:'Raver Safety', url:'#raver-safety', keywords:['safety','femme','buddy']},
  // add more pages as needed
];
const input = document.getElementById('searchInput');
const sugg = document.getElementById('suggestions');
const lang = document.getElementById('lang');

function renderSuggestions(list){
  sugg.innerHTML = '';
  if(!list.length){ sugg.style.display='none'; return; }
  for(const p of list.slice(0,8)){
    const li = document.createElement('li');
    li.textContent = p.title;
    li.tabIndex = 0;
    li.addEventListener('click', ()=> { location.href = p.url; });
    li.addEventListener('keydown', (e)=>{ if(e.key==='Enter') location.href = p.url; });
    sugg.appendChild(li);
  }
  sugg.style.display='block';
}

input.addEventListener('input', e=>{
  const q = (e.target.value||'').trim().toLowerCase();
  if(!q){ renderSuggestions([]); return; }
  const results = pages.filter(p => {
    return p.title.toLowerCase().includes(q) || (p.keywords && p.keywords.some(k=>k.includes(q)));
  });
  renderSuggestions(results);
});
document.addEventListener('click', (e)=>{ if(!e.target.closest('.search')) sugg.style.display='none'; });

/* ---------------------------
   Hamburger nav
   --------------------------- */
const hamburger = document.getElementById('hamburger');
const sideNav = document.getElementById('sideNav');
hamburger.addEventListener('click', ()=>{
  const open = sideNav.classList.toggle('open');
  hamburger.setAttribute('aria-expanded', open? 'true' : 'false');
  sideNav.setAttribute('aria-hidden', open? 'false' : 'true');
});

/* ---------------------------
   Peach button drag + snap
   --------------------------- */
const peach = document.getElementById('peachBtn');
let dragging=false, dragId=null, offsetX=0, offsetY=0;
let locked = false;

// restore saved pos
const saved = localStorage.getItem('plur_peach_pos');
if(saved){
  try{
    const pos = JSON.parse(saved);
    peach.style.left = pos.left; peach.style.top = pos.top; peach.style.right = 'auto'; peach.style.bottom = 'auto';
  }catch(e){}
}

function clamp(v,min,max){ return Math.min(max,Math.max(min,v)); }

peach.addEventListener('pointerdown', (e)=>{
  if(locked) return;
  dragging = true; dragId = e.pointerId;
  peach.setPointerCapture(dragId);
  const rect = peach.getBoundingClientRect();
  offsetX = e.clientX - rect.left; offsetY = e.clientY - rect.top;
  peach.style.transition = 'none';
});
document.addEventListener('pointermove', (e)=>{
  if(!dragging || e.pointerId !== dragId) return;
  const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
  const vh = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);
  let x = clamp(e.clientX - offsetX, 8, vw - peach.offsetWidth - 8);
  let y = clamp(e.clientY - offsetY, 8, vh - peach.offsetHeight - 8);
  peach.style.left = x + 'px';
  peach.style.top = y + 'px';
  peach.style.right = 'auto'; peach.style.bottom = 'auto';
});
document.addEventListener('pointerup', (e)=>{
  if(!dragging || e.pointerId !== dragId) return;
  dragging = false;
  peach.releasePointerCapture(dragId);
  dragId = null;
  // snap to nearest vertical edge
  snapPeach();
});

function snapPeach(){
  const rect = peach.getBoundingClientRect();
  const vw = Math.max(document.documentElement.clientWidth, window.innerWidth || 0);
  const leftDist = rect.left;
  const rightDist = vw - rect.right;
  const snapLeft = rightDist > leftDist;
  peach.style.transition = 'left .28s cubic-bezier(.2,.9,.2,1), top .18s linear';
  if(snapLeft){
    peach.style.left = '12px';
  } else {
    peach.style.left = (vw - peach.offsetWidth - 12) + 'px';
  }
  // clamp vertical
  let top = clamp(rect.top, 12, (window.innerHeight - peach.offsetHeight - 12));
  peach.style.top = top + 'px';
  // save
  savePeachPos();
}
function savePeachPos(){
  localStorage.setItem('plur_peach_pos', JSON.stringify({ left: peach.style.left || '', top: peach.style.top || '' }));
}

/* keyboard control for accessibility */
peach.tabIndex = 0;
peach.addEventListener('keydown', (e)=>{
  if(e.key.startsWith('Arrow')){
    e.preventDefault();
    const step = e.shiftKey ? 20 : 8;
    const rect = peach.getBoundingClientRect();
    let x = rect.left, y = rect.top;
    if(e.key==='ArrowLeft') x -= step;
    if(e.key==='ArrowRight') x += step;
    if(e.key==='ArrowUp') y -= step;
    if(e.key==='ArrowDown') y += step;
    x = clamp(x, 8, window.innerWidth - peach.offsetWidth - 8);
    y = clamp(y, 8, window.innerHeight - peach.offsetHeight - 8);
    peach.style.left = x + 'px'; peach.style.top = y + 'px';
    savePeachPos();
  }
  if(e.key === 'Enter' || e.key === ' '){
    e.preventDefault();
    openPanicAction();
  }
});

/* Lock toggle */
const lockBtn = document.getElementById('lockPeach');
lockBtn.addEventListener('click', ()=>{
  locked = !locked;
  lockBtn.textContent = locked ? 'Unlock panic button' : 'Lock panic button';
  lockBtn.style.background = locked ? 'rgba(255,140,105,0.06)' : 'transparent';
});

/* Peach action */
function openPanicAction(){
  // default action - replace with your panic modal or flow
  alert('Panic action triggered ‚Äî replace with your real flow (panic modal, call, SMS, or resources).');
}

/* click on peach calls panic action */
peach.addEventListener('click', (e)=>{
  if(dragging) return;
  openPanicAction();
});

/* prevent peach from blocking important interactions: allow pointer events to pass through when dragging */
peach.addEventListener('touchstart', (e)=>{ /* ensures mobile pointer capture happens */ });

/* on resize reposition if offscreen */
window.addEventListener('resize', ()=>{
  const rect = peach.getBoundingClientRect();
  const vw = window.innerWidth, vh = window.innerHeight;
  let left = parseFloat(peach.style.left) || rect.left;
  let top = parseFloat(peach.style.top) || rect.top;
  left = clamp(left, 8, vw - peach.offsetWidth - 8);
  top = clamp(top, 8, vh - peach.offsetHeight - 8);
  peach.style.left = left + 'px'; peach.style.top = top + 'px';
  savePeachPos();
});

/* small UX: hide suggestions on scroll */
window.addEventListener('scroll', ()=>{ sugg.style.display='none'; });

/* Parallax hint for skyline (very subtle) */
const skyline = document.querySelector('.skyline');
document.addEventListener('scroll', ()=>{
  const y = window.scrollY || window.pageYOffset;
  if(skyline) skyline.style.transform = `translateY(${Math.min(0, -y * 0.08)}px)`;
});
</script>
</body>
</html>
