<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>PLURderapolis üçë | Minnesota Rave Harm Reduction</title>
  <style>
    /* Reset & base */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #121212;
      color: #ffa3d0;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    a {
      color: #ff6ec7;
      text-decoration: none;
    }
    a:hover, a:focus {
      color: #ff99dd;
      outline: none;
      text-decoration: underline;
    }
    h1, h2, h3 {
      margin: 0 0 0.5rem 0;
      font-weight: 700;
    }
    h1 {
      font-size: 2.4rem;
      color: #ff6ec7;
      text-shadow: 0 0 10px #ff6ec7aa;
    }
    h2 {
      font-size: 1.8rem;
      color: #ffa3d0;
      text-shadow: 0 0 6px #ff6ec7cc;
    }
    h3 {
      font-size: 1.4rem;
      color: #ff6ec7;
      text-shadow: 0 0 6px #ff6ec7cc;
    }
    p {
      line-height: 1.5;
      font-weight: 500;
    }

    /* Header & rave alerts */
    header {
      background-color: #1a0a32;
      padding: 0.5rem 1rem 1rem 1rem;
      position: sticky;
      top: 0;
      z-index: 10050;
      box-shadow: 0 2px 10px #ff6ec7cc;
    }
    .rave-alert-bar {
      display: flex;
      gap: 1rem;
      overflow-x: auto;
      font-weight: 700;
      font-size: 0.9rem;
      color: #ff99dd;
      user-select: text;
      padding-bottom: 0.3rem;
    }
    .rave-alert-bar > div {
      display: flex;
      align-items: center;
      white-space: nowrap;
      padding: 0.1rem 0.6rem;
      background: #330050;
      border-radius: 6px;
      box-shadow: 0 0 12px #ff6ec7aa inset;
    }
    .alert-icon {
      font-size: 1.3rem;
      margin-right: 0.4rem;
      user-select: none;
    }
    time {
      font-size: 0.75rem;
      color: #ff99ddcc;
      user-select: text;
      margin-right: 0.5rem;
      font-weight: 600;
    }

    .site-title {
      text-align: center;
      margin-top: 0.6rem;
      margin-bottom: 1rem;
    }
    .site-title p {
      font-size: 1.1rem;
      font-weight: 600;
      color: #ffa3d0cc;
      margin-top: 0.2rem;
      user-select: none;
    }

    /* Navigation */
    nav.main-nav {
      position: relative;
    }
    nav.main-nav ul {
      list-style: none;
      padding: 0;
      margin: 0;
      display: flex;
      gap: 1rem;
      justify-content: center;
      flex-wrap: wrap;
    }
    nav.main-nav ul li a {
      color: #ffa3d0;
      font-weight: 600;
      padding: 0.4rem 0.8rem;
      border-radius: 6px;
      transition: background-color 0.3s ease, color 0.3s ease;
      display: inline-block;
    }
    nav.main-nav ul li a:hover,
    nav.main-nav ul li a:focus {
      background-color: #ff6ec7;
      color: #121212;
      outline: none;
      box-shadow: 0 0 10px #ff6ec7cc;
    }

    /* Hamburger menu for mobile */
    .nav-toggle {
      display: none;
      position: absolute;
      top: 0.6rem;
      right: 1rem;
      width: 36px;
      height: 36px;
      background: none;
      border: none;
      cursor: pointer;
      z-index: 10100;
    }
    .nav-toggle span,
    .nav-toggle span::before,
    .nav-toggle span::after {
      display: block;
      background-color: #ff6ec7;
      height: 3px;
      border-radius: 2px;
      position: relative;
      transition: all 0.3s ease;
    }
    .nav-toggle span {
      width: 26px;
      margin: 6px auto;
    }
    .nav-toggle span::before,
    .nav-toggle span::after {
      content: "";
      position: absolute;
      width: 26px;
    }
    .nav-toggle span::before {
      top: -8px;
    }
    .nav-toggle span::after {
      top: 8px;
    }
    nav.main-nav.open ul {
      display: flex;
      flex-direction: column;
      background-color: #330050;
      padding: 1rem;
      border-radius: 8px;
      position: absolute;
      top: 3.5rem;
      right: 1rem;
      width: 220px;
      box-shadow: 0 0 20px #ff6ec7cc;
      z-index: 10090;
    }
    nav.main-nav.open .nav-toggle span {
      background-color: transparent;
    }
    nav.main-nav.open .nav-toggle span::before {
      transform: rotate(45deg);
      top: 0;
    }
    nav.main-nav.open .nav-toggle span::after {
      transform: rotate(-45deg);
      top: 0;
    }

    @media (max-width: 720px) {
      nav.main-nav ul {
        display: none;
      }
      .nav-toggle {
        display: block;
      }
    }
        /* Main sections */
    main {
      max-width: 900px;
      margin: 1rem auto 4rem auto;
      padding: 0 1rem;
    }
    section {
      margin-bottom: 2rem;
      padding: 1rem;
      background: #1a0a32;
      border-radius: 8px;
      box-shadow: 0 0 15px #ff6ec7aa inset;
    }
    section:focus {
      outline: 3px solid #ff6ec7;
      outline-offset: 2px;
    }

    /* Buttons */
    button {
      background-color: #ff6ec7;
      border: none;
      color: #121212;
      font-weight: 700;
      padding: 0.6rem 1.2rem;
      border-radius: 6px;
      cursor: pointer;
      box-shadow: 0 0 15px #ff6ec7cc;
      transition: background-color 0.3s ease;
    }
    button:hover,
    button:focus {
      background-color: #ff99dd;
      outline: none;
    }

    /* Bad Trip Mode overlay */
    #btm-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: #330050ee;
      color: #ffa3d0;
      z-index: 10000;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 1rem;
      user-select: none;
    }
    #btm-overlay[aria-hidden="false"] {
      display: flex;
    }
    #breathing-circle {
      width: 140px;
      height: 140px;
      border: 8px solid #ff6ec7;
      border-radius: 50%;
      margin: 1rem auto 2rem auto;
      animation: breathe 4s infinite ease-in-out;
      box-shadow: 0 0 15px #ff6ec7cc;
    }
    @keyframes breathe {
      0%, 100% {
        transform: scale(1);
        box-shadow: 0 0 15px #ff6ec7cc;
      }
      50% {
        transform: scale(1.3);
        box-shadow: 0 0 30px #ff99ddcc;
      }
    }

    /* Bad Trip Mode buttons */
    #activate-btm {
      margin-top: 1rem;
      width: 100%;
      max-width: 300px;
    }
    #exit-btm {
      background-color: #ff99dd;
      margin-top: 1rem;
    }
    #exit-btm:hover,
    #exit-btm:focus {
      background-color: #ff6ec7;
      color: #121212;
    }

    /* Polydrug Roulette */
    .roulette-controls {
      display: flex;
      gap: 0.6rem;
      flex-wrap: wrap;
      justify-content: center;
      margin-top: 1rem;
      user-select: none;
    }
    select {
      padding: 0.5rem 0.8rem;
      font-weight: 600;
      border-radius: 6px;
      border: none;
      box-shadow: 0 0 8px #ff6ec7aa inset;
      background-color: #330050;
      color: #ffa3d0;
      cursor: pointer;
      user-select: none;
      min-width: 140px;
    }
    select:focus {
      outline: 2px solid #ff6ec7;
      outline-offset: 2px;
    }
    #roulette-result {
      margin-top: 1rem;
      font-weight: 700;
      font-size: 1rem;
      color: #ff99dd;
      min-height: 2.5em;
    }
    .risk-emojis {
      font-size: 1.4rem;
      margin-right: 0.4rem;
      user-select: none;
    }

    /* Quiz Mini */
    #od-quiz-mini {
      margin-top: 1rem;
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
      user-select: none;
    }
    .quiz-option-mini {
      background: #ff6ec7;
      color: #121212;
      font-weight: 700;
      padding: 0.5rem 1rem;
      border-radius: 6px;
      border: none;
      cursor: pointer;
      box-shadow: 0 0 15px #ff6ec7cc;
      transition: background-color 0.3s ease;
      user-select: none;
    }
    .quiz-option-mini:hover,
    .quiz-option-mini:focus {
      background-color: #ff99dd;
      outline: none;
    }

    /* Scene Alerts */
    #scene-alerts {
      margin-top: 1rem;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 0.8rem;
      user-select: text;
      position: relative;
    }
    #scene-alerts-list {
      display: flex;
      gap: 1rem;
      padding-left: 1rem;
    }
    .alert-card {
      flex: 0 0 280px;
      background: #330050;
      border-radius: 8px;
      padding: 1rem;
      box-shadow: 0 0 15px #ff6ec7aa inset;
      user-select: text;
      color: #ffa3d0;
      font-weight: 600;
      display: flex;
      flex-direction: column;
      gap: 0.3rem;
    }
    .alert-card time {
      font-size: 0.75rem;
      color: #ff99ddcc;
      user-select: text;
    }

    /* Horizontal scroll shadow fade on container edges */
    #scene-alerts::before,
    #scene-alerts::after {
      content: "";
      pointer-events: none;
      position: absolute;
      top: 40px;
      width: 40px;
      height: 100%;
      z-index: 1;
    }
    #scene-alerts::before {
      left: 0;
      background: linear-gradient(to right, #121212 0%, transparent 100%);
    }
    #scene-alerts::after {
      right: 0;
      background: linear-gradient(to left, #121212 0%, transparent 100%);
    }

    /* Local Resources Spotlight */
    #local-resources {
      text-align: center;
      color: #ffa3d0;
      font-weight: 600;
    }
    #local-resources a {
      color: #ff6ec7;
      font-weight: 700;
      text-decoration: underline;
    }
    #local-resources a:hover,
    #local-resources a:focus {
      color: #ff99dd;
      outline: none;
    }

    /* How To Use Section */
    #how-to-use {
      color: #d4c7e8;
      font-size: 1rem;
      font-weight: 500;
      line-height: 1.6;
      max-width: 800px;
      margin: 0 auto;
      padding: 0 1rem;
      user-select: text;
    }
    #how-to-use h3 {
      color: #ff6ec7;
      margin-top: 1.2rem;
      font-weight: 700;
      user-select: none;
    }

    /* FLOATING PEACH PANIC BUTTON */
    #peach-panic-btn {
      position: fixed;
      bottom: 5.5rem;
      right: 1.2rem;
      background: #ff6ec7;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      font-size: 2rem;
      color: white;
      box-shadow: 0 0 12px 3px #ff6ec7;
      cursor: pointer;
      transition: box-shadow 0.3s ease, transform 0.3s ease;
      z-index: 10020;
      display: flex;
      justify-content: center;
      align-items: center;
      user-select: none;
    }
    #peach-panic-btn:hover,
    #peach-panic-btn:focus {
      box-shadow: 0 0 20px 6px #ff99dd;
      outline: none;
      transform: scale(1.1);
    }
    #peach-panic-btn.dismissed {
      animation: slideDownFade 0.5s forwards;
      pointer-events: none;
    }
    @keyframes slideDownFade {
      to {
        transform: translateY(100%) scale(0);
        opacity: 0;
        visibility: hidden;
      }
    }

    /* BOTTOM QUICK ACCESS BAR */
    #quick-access {
      position: fixed;
      bottom: 0;
      left: 0;
      width: 100%;
      background-color: #1a0a32;
      display: flex;
      justify-content: space-around;
      border-top: 1px solid #ff6ec7;
      padding: 0.4rem 0;
      z-index: 10010;
      user-select: none;
    }
    #quick-access a {
      flex: 1;
      text-align: center;
      color: #ccc;
      font-size: 1.6rem;
      padding: 0.3rem 0;
      transition: color 0.3s ease, text-shadow 0.3s ease;
    }
    #quick-access a:hover,
    #quick-access a:focus {
      color: #fff;
      text-shadow: 0 0 8px #ff66cc;
      outline: none;
    }
  </style>
</head>
<body>
  <!-- HEADER & ALERTS -->
  <header role="banner" aria-label="PLURderapolis Site Header">
    <div class="rave-alert-bar" aria-live="polite" aria-atomic="false" aria-relevant="additions removals">
      <div><span class="alert-icon">üö®</span><time datetime="2025-08-08T15:00:00">15:00</time> Fentanyl contamination alert in Minneapolis venues.</div>
      <div><span class="alert-icon">‚ö°</span><time datetime="2025-08-08T14:30:00">14:30</time> Increase in GHB-related incidents reported.</div>
      <div><span class="alert-icon">üíä</span><time datetime="2025-08-08T13:45:00">13:45</time> Free test kits available this weekend at select shows.</div>
    </div>

    <div class="site-title" role="heading" aria-level="1">
      <h1>PLURderapolis üçë</h1>
      <p>Your Minnesota Rave Harm Reduction Hub</p>
    </div>

    <nav class="main-nav" role="navigation" aria-label="Primary site navigation">
      <button class="nav-toggle" aria-expanded="false" aria-controls="primary-menu" aria-label="Toggle menu">
        <span></span>
      </button>
      <ul id="primary-menu" tabindex="-1">
        <li><a href="/">Home</a></li>
        <li><a href="/polydrug.html">Polydrug Interaction Tool</a></li>
        <li><a href="/badtrip.html">Bad Trip Mode</a></li>
        <li><a href="/resources.html">MN Resources</a></li>
        <li><a href="/scenealerts.html">Scene Alerts</a></li>
        <li><a href="/about.html">About</a></li>
        <li><a href="/contact.html">Contact</a></li>
        <!-- Add your full existing links here, no deletion -->
      </ul>
    </nav>
  </header>

  <main role="main" tabindex="-1">
        <!-- What We Do -->
    <section id="what-we-do" tabindex="0" aria-label="What PLURderapolis Does">
      <h2>What We Do</h2>
      <p>PLURderapolis is your trusted harm reduction collective focused on keeping Minnesota's rave and nightlife communities safe, informed, and empowered. We provide tools, resources, and support to navigate the complex landscape of polydrug use and event safety.</p>
    </section>

    <!-- Polydrug Interaction Tool CTA -->
    <section id="polydrug-tool-cta" tabindex="0" aria-label="Polydrug Interaction Tool Call to Action">
      <h2>Polydrug Interaction Tool</h2>
      <p>Not sure about your drug combos? Use our interaction checker to stay ahead of risks and protect yourself.</p>
      <p><a href="/polydrug.html" class="button" role="button">Try the Full Polydrug Tool</a></p>
    </section>

    <!-- Bad Trip Mode trigger -->
    <section id="bad-trip-mode" tabindex="0" aria-label="Activate Bad Trip Mode">
      <h2>Bad Trip Mode</h2>
      <p>Feeling overwhelmed or anxious? Activate our Bad Trip Mode to get immediate calming visuals and guidance.</p>
      <button id="activate-btm" aria-pressed="false" aria-controls="btm-overlay">Activate Bad Trip Mode</button>
    </section>

    <!-- Polydrug Roulette mini widget -->
    <section id="polydrug-roulette" tabindex="0" aria-label="Polydrug Roulette Mini Tool">
      <h2>Polydrug Roulette</h2>
      <p>Spin for a random combo and get instant risk emojis plus tips.</p>
      <div class="roulette-controls">
        <select id="roulette-drug1" aria-label="First drug selector">
          <option value="" disabled selected>Select first drug</option>
          <option value="mdma">MDMA</option>
          <option value="cocaine">Cocaine</option>
          <option value="alcohol">Alcohol</option>
          <option value="ghb">GHB</option>
          <option value="ketamine">Ketamine</option>
          <option value="mushrooms">Mushrooms</option>
          <option value="lsd">LSD</option>
          <option value="poppers">Poppers</option>
          <option value="nitrous">Nitrous</option>
          <!-- Add more as needed -->
        </select>
        <select id="roulette-drug2" aria-label="Second drug selector">
          <option value="" disabled selected>Select second drug</option>
          <option value="mdma">MDMA</option>
          <option value="cocaine">Cocaine</option>
          <option value="alcohol">Alcohol</option>
          <option value="ghb">GHB</option>
          <option value="ketamine">Ketamine</option>
          <option value="mushrooms">Mushrooms</option>
          <option value="lsd">LSD</option>
          <option value="poppers">Poppers</option>
          <option value="nitrous">Nitrous</option>
          <!-- Add more as needed -->
        </select>
        <button id="roulette-spin" aria-label="Spin Polydrug Roulette">Spin</button>
      </div>
      <div id="roulette-result" aria-live="polite" aria-atomic="true" role="region"></div>
      <p><a href="/polydrug.html">Go to Full Polydrug Tool</a></p>
    </section>

    <!-- OD Quick Tap Mini Flow -->
    <section id="od-quick-tap" tabindex="0" aria-label="Overdose Quick Tap Mini Flow">
      <h2>OD Quick Tap</h2>
      <p>Quickly assess an overdose scenario and get immediate guidance.</p>
      <div id="od-quiz-mini" role="region" aria-live="polite" aria-atomic="true"></div>
    </section>

    <!-- Scene Alerts -->
    <section id="scene-alerts" tabindex="0" aria-label="Scene Alerts with timestamps">
      <h2>Scene Alerts</h2>
      <div id="scene-alerts-list" role="list">
        <article class="alert-card" role="listitem">
          <time datetime="2025-08-08T15:00:00">15:00</time>
          <p>üö® Fentanyl contamination confirmed in multiple venues in Minneapolis. Test kits strongly recommended.</p>
        </article>
        <article class="alert-card" role="listitem">
          <time datetime="2025-08-08T14:00:00">14:00</time>
          <p>‚ö° Increased reports of GHB overdoses at recent parties. Never use alone.</p>
        </article>
        <article class="alert-card" role="listitem">
          <time datetime="2025-08-08T13:30:00">13:30</time>
          <p>üíä Free fentanyl test strips and naloxone available at upcoming shows this weekend.</p>
        </article>
        <!-- Add more live alerts here -->
      </div>
    </section>

    <!-- MN Resources Preview -->
    <section id="local-resources" tabindex="0" aria-label="Minnesota Harm Reduction Resources">
      <h2>Local Minnesota Resources</h2>
      <p>Looking for support or supplies? <a href="/resources.html">Visit our full resources page</a> for trusted harm reduction centers, hotlines, and more.</p>
    </section>

    <!-- How To Use PLURderapolis -->
    <section id="how-to-use" tabindex="0" aria-label="How to use PLURderapolis website and tools">
      <h3>How to Use PLURderapolis</h3>
      <p>Browse scene alerts to stay updated on risks and changes. Use our polydrug tool before mixing substances. Activate Bad Trip Mode anytime you feel overwhelmed. If you suspect an overdose, use the OD Quick Tap for fast guidance. Reach out for help when you need it ‚Äî safety comes first.</p>
    </section>
      </main>

  <!-- Bad Trip Mode Overlay -->
  <div id="btm-overlay" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="btm-title" tabindex="-1">
    <h2 id="btm-title">Bad Trip Mode Activated</h2>
    <div id="breathing-circle" aria-hidden="true"></div>
    <p>Take slow, deep breaths. Focus on the circle expanding and contracting. You're safe.</p>
    <button id="exit-btm">Exit Bad Trip Mode</button>
  </div>

  <!-- Floating Peach Panic Button -->
  <button id="peach-panic-btn" aria-label="Peach Panic Button" title="Peach Panic üçë">üçë</button>

  <!-- Sticky Bottom Quick Access Bar -->
  <nav id="quick-access" aria-label="Quick access navigation">
    <a href="#peach-panic-btn" aria-label="Peach Panic Button">üçë</a>
    <a href="/resources.html" aria-label="Harm Reduction Resources">üíä</a>
    <a href="#bad-trip-mode" aria-label="Bad Trip Mode">üß†</a>
    <a href="/polydrug.html" aria-label="Polydrug Interaction Tool">üîÄ</a>
  </nav>
    <footer role="contentinfo" style="text-align:center; padding:1rem; font-size:0.85rem; color:#7a5a7a; background:#121212; border-top: 1px solid #330050;">
    <p>¬© 2025 PLURderapolis. This site provides harm reduction information and is not a substitute for professional medical advice. If you or someone else is in immediate danger, call 911.</p>
  </footer>

  <script>
    // Navigation toggle
    const navToggle = document.querySelector('.nav-toggle');
    const mainNav = document.querySelector('nav.main-nav');
    const primaryMenu = document.getElementById('primary-menu');

    navToggle.addEventListener('click', () => {
      const expanded = navToggle.getAttribute('aria-expanded') === 'true' || false;
      navToggle.setAttribute('aria-expanded', !expanded);
      mainNav.classList.toggle('open');
      if (!expanded) {
        primaryMenu.focus();
      }
    });

    // Polydrug Roulette logic
    const riskData = {
      'mdma_cocaine': {risk: '‚ö†Ô∏è‚ö†Ô∏è', advice: 'Mixing MDMA and cocaine increases heart strain. Stay hydrated, avoid overheating.'},
      'mdma_alcohol': {risk: '‚ö†Ô∏è', advice: 'Alcohol can dull MDMA effects and increase dehydration risk.'},
      'ghb_alcohol': {risk: '‚ùå', advice: 'Mixing GHB and alcohol can cause dangerous respiratory depression.'},
      'ketamine_alcohol': {risk: '‚ö†Ô∏è‚ö†Ô∏è', advice: 'Risk of blackouts and respiratory issues.'},
      'lsd_mushrooms': {risk: '‚ö†Ô∏è', advice: 'Both are psychedelics; combined effects can be intense and unpredictable.'},
      'poppers_nitrous': {risk: '‚ö†Ô∏è', advice: 'Can cause oxygen depletion; use cautiously and not together frequently.'},
      // Add more combos as needed
    };

    function getComboKey(d1, d2) {
      const sorted = [d1, d2].sort();
      return sorted.join('_');
    }

    const spinBtn = document.getElementById('roulette-spin');
    const drug1Select = document.getElementById('roulette-drug1');
    const drug2Select = document.getElementById('roulette-drug2');
    const rouletteResult = document.getElementById('roulette-result');

    spinBtn.addEventListener('click', () => {
      const d1 = drug1Select.value;
      const d2 = drug2Select.value;
      if (!d1 || !d2) {
        rouletteResult.textContent = 'Please select two different drugs.';
        return;
      }
      if (d1 === d2) {
        rouletteResult.textContent = 'Select two different drugs.';
        return;
      }
      const key = getComboKey(d1, d2);
      const riskInfo = riskData[key];
      if (riskInfo) {
        rouletteResult.innerHTML = `<span class="risk-emojis">${riskInfo.risk}</span> ${riskInfo.advice}`;
      } else {
        rouletteResult.innerHTML = `‚ö†Ô∏è Unknown combo. Use caution and test your substances.`;
      }
    });

    // OD Quick Tap Mini Flow
    const odQuizMini = document.getElementById('od-quiz-mini');
    const odQuestions = [
      {
        q: "Is the person breathing?",
        options: ["Yes", "No"],
        answers: [1] // If No, emergency required
      },
      {
        q: "Are they responsive?",
        options: ["Yes", "No"],
        answers: [1] // If No, emergency required
      },
      {
        q: "Do you have naloxone nearby?",
        options: ["Yes", "No"],
        answers: [0] // If Yes, give naloxone
      }
    ];
    let odStep = 0;

    function renderODStep() {
      if (odStep >= odQuestions.length) {
        odQuizMini.innerHTML = `<p style="color:#aaffaa; font-weight:700;">You're prepared! Stay calm, call 911 if needed.</p>`;
        return;
      }
      const current = odQuestions[odStep];
      let html = `<p>${current.q}</p>`;
      current.options.forEach((opt, i) => {
        html += `<button class="quiz-option-mini" data-index="${i}">${opt}</button>`;
      });
      odQuizMini.innerHTML = html;

      odQuizMini.querySelectorAll('.quiz-option-mini').forEach(btn => {
        btn.addEventListener('click', e => {
          const idx = parseInt(e.target.getAttribute('data-index'));
          if (current.answers.includes(idx)) {
            if (odStep === 0 || odStep === 1) {
              odQuizMini.innerHTML = `<p style="color:#ff6666; font-weight:700;">Call 911 immediately! Start rescue breaths now.</p>`;
            } else if (odStep === 2) {
              odQuizMini.innerHTML = `<p style="color:#aaffaa; font-weight:700;">Administer naloxone and monitor breathing.</p>`;
            }
          } else {
            odStep++;
            renderODStep();
          }
        });
      });
    }
    renderODStep();

    // Bad Trip Mode toggles
    const btmBtn = document.getElementById('activate-btm');
    const btmOverlay = document.getElementById('btm-overlay');
    const exitBtmBtn = document.getElementById('exit-btm');

    btmBtn.addEventListener('click', () => {
      btmOverlay.style.display = 'flex';
      btmOverlay.setAttribute('aria-hidden', 'false');
      btmBtn.setAttribute('aria-pressed', 'true');
      btmOverlay.focus();
      document.body.style.overflow = 'hidden'; // prevent background scroll
    });
    exitBtmBtn.addEventListener('click', () => {
      btmOverlay.style.display = 'none';
      btmOverlay.setAttribute('aria-hidden', 'true');
      btmBtn.setAttribute('aria-pressed', 'false');
      document.body.style.overflow = 'auto';
      btmBtn.focus();
    });

    // Peach Panic Button logic
    const peachBtn = document.getElementById('peach-panic-btn');
    let panicDismissed = false;

    peachBtn.addEventListener('click', () => {
      alert("Peach Panic activated! Reach out to your crew or emergency services if needed.");
    });

    // Dismiss with small animation (e.g. double tap to dismiss)
    let lastClick = 0;
    peachBtn.addEventListener('dblclick', () => {
      if (panicDismissed) return;
      panicDismissed = true;
      peachBtn.classList.add('dismissed');
      setTimeout(() => {
        peachBtn.style.display = 'none';
      }, 500);
    });
  </script>
</body>
</html>
