<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PLURderapolis ‚Äî Bad Trip Guide</title>
<meta name="description" content="A safe space for grounding during difficult psychedelic experiences">
<meta name="theme-color" content="#1c0028">
<link rel="manifest" href="manifest.json">
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  /* Base theme */
  :root{
    --bg:#1c0028;
    --card:#2a0040;
    --accent:#ff6ec7;
    --mint:#00f7e0;
    --text:#eee;
    --soft-purple:#3a0055;
    --light-purple:#4a0066;
    --transition-smooth: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --transition-bounce: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    --sidebar-width: 280px;
  }
  
  /* Fade in entire page */
  @keyframes pageFadeIn {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
  }
  
  html, body {
    height: 100%;
    scroll-behavior: smooth;
  }
  
  body{
    font-family: 'Roboto', sans-serif;
    background: var(--bg); 
    color: var(--text);
    line-height: 1.6;
    overflow-x: hidden;
    background: radial-gradient(ellipse at top, #2a0040 0%, #1c0028 100%);
    animation: pageFadeIn 0.8s ease-out;
  }
  
  h1, h2, h3, h4 {
    font-family: 'Montserrat', sans-serif; 
    font-weight: 600;
    margin-bottom: 0.5rem;
  }
  
  .container {
    display: flex;
    min-height: 100vh;
    position: relative;
  }
  
  /* Main Title */
  .main-title {
    font-size: 1.8rem; 
    color: var(--mint); 
    text-shadow: 0 0 8px rgba(0, 247, 224, 0.6);
    font-weight: 700;
    margin-bottom: 1.5rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid var(--soft-purple);
  }
  
  .main-title a {
    color: inherit;
    text-decoration: none;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    transition: var(--transition-smooth);
  }
  
  .main-title a:hover {
    color: #fff;
    text-shadow: 0 0 12px rgba(0, 247, 224, 0.8);
  }
  
  /* Sidebar Navigation */
  .sidebar {
    width: var(--sidebar-width);
    background: var(--card);
    padding: 1.5rem;
    position: fixed;
    height: 100vh;
    overflow-y: auto;
    z-index: 100;
    box-shadow: 5px 0 15px rgba(0,0,0,0.2);
    transition: transform 0.3s ease;
  }
  
  .sidebar-header {
    margin-bottom: 2rem;
  }
  
  .site-links {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid rgba(255,255,255,0.1);
  }
  
  .site-links h3 {
    font-size: 1rem;
    color: var(--mint);
    margin-bottom: 1rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  
  .site-link {
    display: block;
    color: var(--text);
    padding: 0.75rem 1rem;
    margin-bottom: 0.5rem;
    background: rgba(255,255,255,0.05);
    border-radius: 8px;
    text-decoration: none;
    transition: var(--transition-smooth);
  }
  
  .site-link:hover {
    background: rgba(255,255,255,0.1);
    transform: translateX(5px);
    color: var(--mint);
  }
  
  .nav-category {
    color: var(--accent);
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin: 1.5rem 0 0.75rem;
    padding-left: 0.5rem;
  }
  
  .nav-item {
    display: block;
    padding: 0.75rem 1rem;
    color: var(--text);
    text-decoration: none;
    border-radius: 8px;
    margin-bottom: 0.5rem;
    transition: var(--transition-smooth);
    background: rgba(255,255,255,0.03);
    border-left: 3px solid transparent;
  }
  
  .nav-item:hover, .nav-item.active {
    background: rgba(255,255,255,0.08);
    border-left-color: var(--mint);
    color: var(--mint);
    transform: translateX(5px);
  }
  
  .nav-item i {
    width: 24px;
    text-align: center;
    margin-right: 0.5rem;
  }
  
  /* Mobile Menu Toggle */
  .menu-toggle {
    display: none;
    position: fixed;
    top: 1rem;
    left: 1rem;
    z-index: 1000;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: var(--accent);
    color: #111;
    border: none;
    font-size: 1.5rem;
    box-shadow: 0 4px 12px rgba(255,110,199,0.4);
    cursor: pointer;
    transition: var(--transition-bounce);
  }
  
  .menu-toggle:hover {
    transform: scale(1.1);
  }
  
  /* Main Content */
  .main-content {
    flex: 1;
    margin-left: var(--sidebar-width);
    padding: 2rem;
    max-width: 100%;
    overflow-x: hidden;
  }
  
  /* Tool Grid Layout */
  .tool-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
  }
  
  .tool-card {
    background: var(--card);
    border-radius: 12px;
    padding: 1.5rem;
    box-shadow: 0 6px 16px rgba(0,0,0,0.2);
    transition: var(--transition-smooth);
    border: 1px solid rgba(255,255,255,0.05);
  }
  
  .tool-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 12px 24px rgba(0,0,0,0.3);
    border-color: var(--soft-purple);
  }
  
  .tool-header {
    display: flex;
    align-items: center;
    margin-bottom: 1rem;
    padding-bottom: 0.75rem;
    border-bottom: 1px solid rgba(255,255,255,0.1);
  }
  
  .tool-icon {
    font-size: 1.8rem;
    margin-right: 1rem;
    color: var(--mint);
  }
  
  .tool-title {
    font-size: 1.3rem;
    color: var(--text);
  }
  
  .tool-desc {
    color: rgba(255,255,255,0.8);
    margin-bottom: 1.5rem;
    font-size: 0.95rem;
  }
  
  /* Breathing Tool */
  .breathing-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
    margin: 0 auto;
  }
  
  .breathing-shape {
    width: 150px;
    height: 150px;
    border-radius: 50%;
    background: radial-gradient(circle, var(--accent) 0%, var(--soft-purple) 70%);
    box-shadow: 0 0 40px rgba(255,110,199,0.8);
    animation: breathe 8s infinite cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #fff;
    font-weight: 700;
    font-size: 1.2rem;
    transition: var(--transition-smooth);
  }
  
  @keyframes breathe {
    0% { transform: scale(1) rotate(0deg); opacity: 0.7; box-shadow: 0 0 30px rgba(255,110,199,0.6); }
    40% { transform: scale(1.4) rotate(5deg); opacity: 1; box-shadow: 0 0 60px rgba(255,110,199,0.9); }
    60% { transform: scale(1.4) rotate(-5deg); opacity: 1; box-shadow: 0 0 60px rgba(255,110,199,0.9); }
    100% { transform: scale(1) rotate(0deg); opacity: 0.7; box-shadow: 0 0 30px rgba(255,110,199,0.6); }
  }
  
  .breathing-controls {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 1rem;
    flex-wrap: wrap;
  }
  
  /* Grounding Tool */
  .ground-grid {
    display: grid;
    grid-template-columns: 1fr;
    gap: 0.8rem;
  }
  
  .ground-btn {
    background: var(--soft-purple);
    color: var(--text);
    padding: 1rem 1.2rem;
    border-radius: 10px;
    border: none;
    cursor: pointer;
    font-weight: 500;
    text-align: left;
    display: flex;
    align-items: center;
    gap: 0.75rem;
    transition: var(--transition-smooth);
    border-left: 4px solid var(--mint);
  }
  
  .ground-btn:hover {
    background: var(--light-purple);
    transform: translateX(5px);
  }
  
  .ground-btn.done {
    background: rgba(0, 247, 224, 0.1);
    color: var(--mint);
    text-decoration: line-through;
  }
  
  .ground-btn.done:before {
    content: '‚úì';
    font-weight: bold;
    color: var(--mint);
  }
  
  .grounding-complete {
    text-align: center;
    margin-top: 1.5rem;
    padding: 1rem;
    background: rgba(0, 247, 224, 0.1);
    border-radius: 10px;
    color: var(--mint);
    font-weight: 600;
    display: none;
  }
  
  /* Audio Tool */
  .audio-controls {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
    gap: 0.8rem;
    margin-top: 1rem;
  }
  
  .audio-btn {
    padding: 0.9rem 0.5rem;
    border-radius: 10px;
    border: none;
    background: var(--soft-purple);
    color: var(--text);
    cursor: pointer;
    font-weight: 500;
    transition: var(--transition-smooth);
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 0.5rem;
  }
  
  .audio-btn:hover {
    background: var(--light-purple);
    transform: translateY(-3px);
  }
  
  .audio-btn.playing {
    background: var(--accent);
    color: #111;
    box-shadow: 0 0 15px rgba(255, 110, 199, 0.4);
  }
  
  .audio-btn i {
    font-size: 1.2rem;
  }
  
  /* Mantra Tool */
  .mantra-box {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 1.5rem;
  }
  
  .mantra-text {
    font-weight: 600;
    color: var(--mint);
    font-size: 1.4rem;
    text-align: center;
    padding: 2rem;
    border-radius: 12px;
    background: rgba(255, 255, 255, 0.05);
    cursor: pointer;
    width: 100%;
    transition: var(--transition-smooth);
    min-height: 120px;
    display: flex;
    align-items: center;
    justify-content: center;
    line-height: 1.5;
  }
  
  .mantra-text:hover {
    background: rgba(255, 255, 255, 0.08);
    transform: scale(1.02);
  }
  
  .mantra-controls {
    display: flex;
    gap: 1rem;
    justify-content: center;
  }
  
  /* Timer Tool */
  .timer-display {
    font-size: 3rem;
    font-weight: 800;
    color: var(--accent);
    text-align: center;
    margin: 1.5rem 0;
    text-shadow: 0 0 20px rgba(255, 110, 199, 0.8);
    font-family: 'Montserrat', sans-serif;
  }
  
  .timer-controls {
    display: flex;
    gap: 0.8rem;
    justify-content: center;
    flex-wrap: wrap;
  }
  
  /* Buttons */
  .btn {
    padding: 0.8rem 1.5rem;
    border-radius: 50px;
    border: none;
    font-family: 'Montserrat', sans-serif;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition-bounce);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }
  
  .btn-primary {
    background: var(--mint);
    color: #111;
    box-shadow: 0 4px 12px rgba(0, 247, 224, 0.3);
  }
  
  .btn-primary:hover {
    background: #00d6c7;
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 8px 20px rgba(0, 247, 224, 0.4);
  }
  
  .btn-secondary {
    background: var(--accent);
    color: #111;
    box-shadow: 0 4px 12px rgba(255, 110, 199, 0.3);
  }
  
  .btn-secondary:hover {
    background: #ff49b2;
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 8px 20px rgba(255, 110, 199, 0.4);
  }
  
  .btn-outline {
    background: transparent;
    color: var(--mint);
    border: 2px solid var(--mint);
  }
  
  .btn-outline:hover {
    background: rgba(0, 247, 224, 0.1);
    transform: translateY(-3px);
  }
  
  /* Cheat Sheet Section */
  .cheat-sheet {
    margin-top: 3rem;
    padding: 2rem;
    background: rgba(255,255,255,0.03);
    border-radius: 12px;
    border: 1px solid rgba(0, 247, 224, 0.2);
  }
  
  .cheat-sheet h2 {
    color: var(--mint);
    margin-bottom: 1rem;
  }
  
  .cheat-sheet-content {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-top: 1.5rem;
  }
  
  .cheat-item {
    background: rgba(0,0,0,0.2);
    padding: 1.2rem;
    border-radius: 8px;
    border-left: 4px solid var(--accent);
  }
  
  .cheat-item h4 {
    color: var(--accent);
    margin-bottom: 0.5rem;
  }
  
  /* Mode Toggle */
  .mode-toggle {
    position: fixed;
    bottom: 1.5rem;
    right: 1.5rem;
    z-index: 99;
  }
  
  .mode-toggle .btn {
    border-radius: 50px;
    padding: 0.8rem 1.2rem;
    font-size: 0.9rem;
  }
  
  /* Footer */
  footer {
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid rgba(255,255,255,0.1);
    color: #aaa;
    font-size: 0.9rem;
  }
  
  .legal-disclaimer {
    font-size: 0.75rem;
    color: #888;
    margin-top: 1.5rem;
    padding: 1rem;
    background: rgba(0,0,0,0.2);
    border-radius: 8px;
    line-height: 1.4;
    text-align: left;
  }
  
  .legal-disclaimer strong {
    color: var(--mint);
    display: block;
    margin-bottom: 0.5rem;
  }
  
  /* Sensory Safe Mode */
  .sensory-safe {
    --bg: #0a0014;
    --card: #150020;
    --accent: #cc5aa3;
    --mint: #00c4b3;
    --text: #ddd;
    --soft-purple: #200030;
    --light-purple: #2a003a;
  }
  
  .sensory-safe .breathing-shape {
    animation-duration: 12s;
    box-shadow: 0 0 20px rgba(204,90,163,0.4);
  }
  
  /* Responsive Design */
  @media (max-width: 992px) {
    .sidebar {
      transform: translateX(-100%);
      width: 280px;
    }
    
    .sidebar.open {
      transform: translateX(0);
    }
    
    .main-content {
      margin-left: 0;
      padding: 1rem;
    }
    
    .menu-toggle {
      display: block;
    }
    
    .tool-grid {
      grid-template-columns: 1fr;
    }
  }
  
  @media (max-width: 768px) {
    .main-title {
      font-size: 1.5rem;
    }
    
    .timer-display {
      font-size: 2.5rem;
    }
    
    .breathing-shape {
      width: 120px;
      height: 120px;
    }
    
    .audio-controls {
      grid-template-columns: 1fr 1fr;
    }
    
    .mantra-text {
      font-size: 1.2rem;
      padding: 1.5rem;
    }
  }
  
  @media (max-width: 480px) {
    .main-content {
      padding: 1rem 0.75rem;
    }
    
    .tool-card {
      padding: 1.2rem;
    }
    
    .btn {
      padding: 0.7rem 1.2rem;
      font-size: 0.9rem;
    }
    
    .timer-controls, .breathing-controls, .mantra-controls {
      flex-direction: column;
      width: 100%;
    }
    
    .timer-controls .btn, .breathing-controls .btn, .mantra-controls .btn {
      width: 100%;
    }
  }
  
  /* Smooth scrolling anchor offset */
  :target {
    scroll-margin-top: 2rem;
  }
  
  /* Animation for tool cards */
  @keyframes cardAppear {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .tool-card {
    animation: cardAppear 0.5s ease-out forwards;
  }
  
  .tool-card:nth-child(1) { animation-delay: 0.1s; }
  .tool-card:nth-child(2) { animation-delay: 0.2s; }
  .tool-card:nth-child(3) { animation-delay: 0.3s; }
  .tool-card:nth-child(4) { animation-delay: 0.4s; }
  .tool-card:nth-child(5) { animation-delay: 0.5s; }
  .tool-card:nth-child(6) { animation-delay: 0.6s; }
  .tool-card:nth-child(7) { animation-delay: 0.7s; }
  .tool-card:nth-child(8) { animation-delay: 0.8s; }
  .tool-card:nth-child(9) { animation-delay: 0.9s; }
</style>
</head>
<body>
  <!-- Mobile Menu Toggle -->
  <button class="menu-toggle" id="menuToggle">
    <i class="fas fa-bars"></i>
  </button>
  
  <div class="container">
    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
      <div class="sidebar-header">
        <h1 class="main-title">
          <a href="https://plurderapolis.org">
            <i class="fas fa-peach"></i>
            Bad Trip Guide
          </a>
        </h1>
        <p style="color: rgba(255,255,255,0.7); font-size: 0.9rem; margin-bottom: 1rem;">
          A safe space for grounding during difficult psychedelic experiences
        </p>
      </div>
      
      <div class="nav-category">Immediate Help</div>
      <a href="#breathing" class="nav-item active">
        <i class="fas fa-wind"></i> Breathing
      </a>
      <a href="#grounding" class="nav-item">
        <i class="fas fa-mountain"></i> Grounding
      </a>
      <a href="#sounds" class="nav-item">
        <i class="fas fa-music"></i> Soothing Sounds
      </a>
      
      <div class="nav-category">Self-Care</div>
      <a href="#checkin" class="nav-item">
        <i class="fas fa-heart"></i> Self Check-In
      </a>
      <a href="#mantras" class="nav-item">
        <i class="fas fa-brain"></i> Mantras
      </a>
      <a href="#timer" class="nav-item">
        <i class="fas fa-hourglass-half"></i> Calm Timer
      </a>
      
      <div class="nav-category">Event Safety</div>
      <a href="#shows" class="nav-item">
        <i class="fas fa-headphones-alt"></i> At Shows
      </a>
      
      <div class="nav-category">Aftercare</div>
      <a href="#aftercare" class="nav-item">
        <i class="fas fa-comment-medical"></i> Reflection
      </a>
      <a href="#resources" class="nav-item">
        <i class="fas fa-life-ring"></i> Emergency Resources
      </a>
      
      <div class="site-links">
        <h3>More from PLURderapolis</h3>
        <a href="https://plurderapolis.org" class="site-link">
          <i class="fas fa-home"></i> Home Page
        </a>
        <a href="https://plurderapolis.org/panic.html" class="site-link">
          <i class="fas fa-exclamation-triangle"></i> Panic Button
        </a>
        <a href="https://plurderapolis.org/emergency.html" class="site-link">
          <i class="fas fa-ambulance"></i> Emergency Help
        </a>
        <a href="https://plurderapolis.org/harm-reduction.html" class="site-link">
          <i class="fas fa-shield-alt"></i> Harm Reduction
        </a>
        <a href="https://plurderapolis.org/community.html" class="site-link">
          <i class="fas fa-users"></i> Community
        </a>
      </div>
      
      <div style="margin-top: 2rem; padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.1);">
        <button id="downloadCheatSheet" class="btn btn-outline" style="width: 100%;">
          <i class="fas fa-download"></i> Download Cheat Sheet
        </button>
      </div>
    </nav>
    
    <!-- Main Content -->
    <main class="main-content">
      <!-- Header with current location -->
      <div style="margin-bottom: 2rem;">
        <div id="breadcrumb" style="font-size: 0.9rem; color: var(--mint); margin-bottom: 0.5rem;">
          <a href="#breathing" style="color: var(--mint); text-decoration: none;">Bad Trip Guide</a> 
          <span style="margin: 0 0.5rem;">/</span> 
          <span id="currentSection">Breathing Exercise</span>
        </div>
        <h1 style="color: var(--text); font-size: 2rem;">Bad Trip Grounding Tools</h1>
        <p style="color: rgba(255,255,255,0.8); margin-top: 0.5rem;">
          You are safe. These tools are designed to help you through difficult moments. 
          Use what feels right for you.
        </p>
      </div>
      
      <!-- Tool Grid -->
      <div class="tool-grid">
        <!-- Breathing Tool -->
        <div class="tool-card" id="breathing">
          <div class="tool-header">
            <div class="tool-icon">üí®</div>
            <h2 class="tool-title">Breathing Exercise</h2>
          </div>
          <p class="tool-desc">
            Follow the circle with your breath. Inhale as it expands, exhale as it contracts. 
            This helps regulate your nervous system.
          </p>
          <div class="breathing-container">
            <div id="breathShape" class="breathing-shape">Breathe</div>
            <div style="text-align:center;font-weight:600;color:var(--mint); font-size:1.1rem;">
              Breathe with the circle ‚Äî inhale as it expands, exhale as it shrinks.
            </div>
            <div class="breathing-controls">
              <button id="pauseBreathing" class="btn btn-primary">
                <i class="fas fa-pause"></i> Pause
              </button>
              <button id="resumeBreathing" class="btn btn-secondary">
                <i class="fas fa-play"></i> Resume
              </button>
            </div>
          </div>
        </div>
        
        <!-- Grounding Tool -->
        <div class="tool-card" id="grounding">
          <div class="tool-header">
            <div class="tool-icon">ü™®</div>
            <h2 class="tool-title">5-4-3-2-1 Grounding</h2>
          </div>
          <p class="tool-desc">
            Engage your senses to bring yourself to the present moment. 
            Click each item as you name it.
          </p>
          <div class="ground-grid">
            <button class="ground-btn" data-count="5">
              <i class="fas fa-eye"></i> 5 things you can see
            </button>
            <button class="ground-btn" data-count="4">
              <i class="fas fa-hand-paper"></i> 4 things you can touch
            </button>
            <button class="ground-btn" data-count="3">
              <i class="fas fa-assistive-listening-systems"></i> 3 things you can hear
            </button>
            <button class="ground-btn" data-count="2">
              <i class="fas fa-wind"></i> 2 things you can smell
            </button>
            <button class="ground-btn" data-count="1">
              <i class="fas fa-lemon"></i> 1 thing you can taste
            </button>
          </div>
          <div class="grounding-complete" id="groundingComplete">
            ‚úÖ Grounding complete ‚Äî you're anchored in the present.
          </div>
          <div style="margin-top: 1rem; text-align: center;">
            <button id="resetGrounding" class="btn btn-outline">
              <i class="fas fa-redo"></i> Reset Grounding
            </button>
          </div>
        </div>
        
        <!-- Soothing Sounds -->
        <div class="tool-card" id="sounds">
          <div class="tool-header">
            <div class="tool-icon">üé∂</div>
            <h2 class="tool-title">Soothing Sounds</h2>
          </div>
          <p class="tool-desc">
            Calm auditory environments to help soothe anxiety. 
            Only one sound plays at a time.
          </p>
          <div class="audio-controls">
            <button class="audio-btn" data-sound="whiteNoise">
              <i class="fas fa-volume-up"></i>
              <span>White Noise</span>
            </button>
            <button class="audio-btn" data-sound="ocean">
              <i class="fas fa-water"></i>
              <span>Ocean Waves</span>
            </button>
            <button class="audio-btn" data-sound="forest">
              <i class="fas fa-tree"></i>
              <span>Forest & Birds</span>
            </button>
            <button class="audio-btn" data-sound="rain">
              <i class="fas fa-cloud-rain"></i>
              <span>Gentle Rain</span>
            </button>
          </div>
          <div style="margin-top: 1rem; text-align: center;">
            <button id="stopAllAudio" class="btn btn-outline">
              <i class="fas fa-volume-mute"></i> Mute All Sounds
            </button>
          </div>
        </div>
        
        <!-- Self Check-In -->
        <div class="tool-card" id="checkin">
          <div class="tool-header">
            <div class="tool-icon">üßç</div>
            <h2 class="tool-title">Self Check-In</h2>
          </div>
          <p class="tool-desc">
            A quick checklist to assess your basic needs and comfort.
          </p>
          <div class="ground-grid">
            <button class="ground-btn" data-check="hydration">
              <i class="fas fa-tint"></i> Hydration: Sip water slowly
            </button>
            <button class="ground-btn" data-check="comfort">
              <i class="fas fa-tshirt"></i> Comfort: Adjust clothing
            </button>
            <button class="ground-btn" data-check="position">
              <i class="fas fa-couch"></i> Position: Sit or lie down
            </button>
            <button class="ground-btn" data-check="connection">
              <i class="fas fa-user-friends"></i> Connection: Reach out if needed
            </button>
            <button class="ground-btn" data-check="temperature">
              <i class="fas fa-thermometer-half"></i> Temperature: Adjust if needed
            </button>
          </div>
          <div style="margin-top: 1rem; font-style: italic; color: var(--mint); text-align: center;">
            If you can't do any of these, that's okay. Just breathe.
          </div>
        </div>
        
        <!-- Mantras -->
        <div class="tool-card" id="mantras">
          <div class="tool-header">
            <div class="tool-icon">üß†</div>
            <h2 class="tool-title">Calming Mantras</h2>
          </div>
          <p class="tool-desc">
            Repeating affirmations can help shift your mindset. 
            Tap the mantra to change it.
          </p>
          <div class="mantra-box">
            <div id="mantraText" class="mantra-text">
              I am safe and this will pass.
            </div>
            <div class="mantra-controls">
              <button id="prevMantra" class="btn btn-outline">
                <i class="fas fa-chevron-left"></i> Previous
              </button>
              <button id="nextMantra" class="btn btn-secondary">
                Next <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>
        
        <!-- Timer -->
        <div class="tool-card" id="timer">
          <div class="tool-header">
            <div class="tool-icon">‚è≥</div>
            <h2 class="tool-title">Calm Timer</h2>
          </div>
          <p class="tool-desc">
            Intense moments often pass within 10-20 minutes. 
            Use this timer to wait it out safely.
          </p>
          <div id="timerDisplay" class="timer-display">15:00</div>
          <div class="timer-controls">
            <button id="startTimer" class="btn btn-primary">
              <i class="fas fa-play"></i> Start
            </button>
            <button id="pauseTimer" class="btn btn-outline">
              <i class="fas fa-pause"></i> Pause
            </button>
            <button id="resetTimer" class="btn btn-secondary">
              <i class="fas fa-redo"></i> Reset
            </button>
          </div>
          <div id="timerMessage" style="text-align:center; margin-top:1.5rem; color:var(--mint);">
            Many people find things stabilize after ~10-20 minutes
          </div>
        </div>
        
        <!-- At Shows -->
        <div class="tool-card" id="shows">
          <div class="tool-header">
            <div class="tool-icon">üéµ</div>
            <h2 class="tool-title">Tripping at Shows</h2>
          </div>
          <p class="tool-desc">
            Safety tips for managing difficult experiences at music events.
          </p>
          <ul style="padding-left: 1.2rem; margin-bottom: 1.5rem;">
            <li style="margin-bottom: 0.75rem;"><strong>Hydrate:</strong> Sip water slowly and often</li>
            <li style="margin-bottom: 0.75rem;"><strong>Chill Zone:</strong> Find a quiet space if overwhelmed</li>
            <li style="margin-bottom: 0.75rem;"><strong>Buddy System:</strong> Stay with someone you trust</li>
            <li style="margin-bottom: 0.75rem;"><strong>Earplugs/Sunglasses:</strong> Reduce sensory input</li>
            <li style="margin-bottom: 0.75rem;"><strong>Know Staff:</strong> Locate medical/security teams</li>
            <li><strong>No Mixing:</strong> Avoid combining substances</li>
          </ul>
          <div style="text-align: center; margin-top: 1rem;">
            <button id="findChillZone" class="btn btn-outline">
              <i class="fas fa-map-marker-alt"></i> I need a chill zone
            </button>
          </div>
        </div>
        
        <!-- Aftercare -->
        <div class="tool-card" id="aftercare">
          <div class="tool-header">
            <div class="tool-icon">üí≠</div>
            <h2 class="tool-title">Reflection & Aftercare</h2>
          </div>
          <p class="tool-desc">
            After the experience passes, reflection can help integrate insights.
          </p>
          <div style="margin-bottom: 1.5rem;">
            <h4 style="color: var(--mint); margin-bottom: 0.5rem;">What helped during this experience?</h4>
            <textarea id="reflection1" placeholder="Jot down what worked for you..." 
              style="width:100%; min-height:80px; background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:8px; color:var(--text); padding:0.75rem; font-family:'Roboto', sans-serif;"></textarea>
          </div>
          <div>
            <h4 style="color: var(--mint); margin-bottom: 0.5rem;">What would I try next time?</h4>
            <textarea id="reflection2" placeholder="Note any insights or changes..." 
              style="width:100%; min-height:80px; background:rgba(255,255,255,0.05); border:1px solid rgba(255,255,255,0.1); border-radius:8px; color:var(--text); padding:0.75rem; font-family:'Roboto', sans-serif;"></textarea>
          </div>
          <div style="margin-top: 1.5rem; text-align: center;">
            <button id="saveReflections" class="btn btn-secondary">
              <i class="fas fa-save"></i> Save Reflections
            </button>
          </div>
        </div>
        
        <!-- Emergency Resources -->
        <div class="tool-card" id="resources">
          <div class="tool-header">
            <div class="tool-icon">üìû</div>
            <h2 class="tool-title">Emergency Resources</h2>
          </div>
          <p class="tool-desc">
            If you need human support right now, these resources are available.
          </p>
          <div style="display: flex; flex-direction: column; gap: 0.75rem;">
            <a href="https://tripsit.me/" target="_blank" class="btn btn-outline" style="text-align: center; text-decoration: none;">
              <i class="fas fa-comments"></i> TripSit Live Chat
            </a>
            <a href="https://firesideproject.org/" target="_blank" class="btn btn-outline" style="text-align: center; text-decoration: none;">
              <i class="fas fa-phone-alt"></i> Fireside Project
            </a>
            <a href="https://neverusealone.com/" target="_blank" class="btn btn-outline" style="text-align: center; text-decoration: none;">
              <i class="fas fa-user-check"></i> Never Use Alone
            </a>
            <a href="https://plurderapolis.org/panic.html" class="btn btn-secondary" style="text-align: center; text-decoration: none;">
              <i class="fas fa-exclamation-triangle"></i> Panic Button
            </a>
          </div>
          <div style="margin-top: 1.5rem; padding: 1rem; background: rgba(255,110,199,0.1); border-radius: 8px; text-align: center;">
            <strong>Medical Emergency?</strong> Call 911 or local emergency services immediately.
          </div>
        </div>
      </div>
      
      <!-- Cheat Sheet Section -->
      <div class="cheat-sheet">
        <h2><i class="fas fa-file-download"></i> Bad Trip Guide Cheat Sheet</h2>
        <p>Download a summary of all the tools on this page for offline use or quick reference.</p>
        
        <div class="cheat-sheet-content">
          <div class="cheat-item">
            <h4>Breathing (4-7-8)</h4>
            <p>Inhale 4 sec, hold 7 sec, exhale 8 sec. Repeat 5x.</p>
          </div>
          <div class="cheat-item">
            <h4>5-4-3-2-1 Grounding</h4>
            <p>5 things you see, 4 feel, 3 hear, 2 smell, 1 taste.</p>
          </div>
          <div class="cheat-item">
            <h4>Self Check-In</h4>
            <p>Hydrate, comfort, position, connection, temperature.</p>
          </div>
          <div class="cheat-item">
            <h4>Key Mantras</h4>
            <p>"This will pass." "I am safe." "I am not my thoughts."</p>
          </div>
          <div class="cheat-item">
            <h4>At Shows</h4>
            <p>Find chill zone, buddy system, hydrate, ear protection.</p>
          </div>
          <div class="cheat-item">
            <h4>Emergency Contacts</h4>
            <p>TripSit, Fireside Project, Never Use Alone, 911.</p>
          </div>
        </div>
        
        <div style="text-align: center; margin-top: 2rem;">
          <button id="generateCheatSheet" class="btn btn-primary">
            <i class="fas fa-file-pdf"></i> Generate & Download Cheat Sheet
          </button>
          <p style="margin-top: 0.75rem; font-size: 0.9rem; color: rgba(255,255,255,0.7);">
            Creates an HTML file you can save or print
          </p>
        </div>
      </div>
      
      <!-- Footer -->
      <footer>
        <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
          <div>
            <h3 style="color: var(--mint); margin-bottom: 0.5rem;">PLURderapolis</h3>
            <p style="color: rgba(255,255,255,0.7);">Your partners in shine üçë</p>
          </div>
          <div class="mode-toggle">
            <button id="toggleSafe" class="btn btn-outline" aria-pressed="false">
              <i class="fas fa-moon"></i> Sensory Safe Mode
            </button>
          </div>
        </div>
        
        <div class="legal-disclaimer">
          <strong>Disclaimer:</strong>
          This guide is provided for educational and harm reduction purposes only. It is not a substitute for professional medical advice, diagnosis, or treatment. Always seek the advice of your physician or other qualified health provider with any questions you may have regarding a medical condition. If you are experiencing a medical emergency, please call emergency services immediately. PLURderapolis is not responsible for any actions taken based on the information provided on this site. Use responsibly.
        </div>
      </footer>
    </main>
  </div>

<script>
// Menu Toggle for Mobile
const menuToggle = document.getElementById('menuToggle');
const sidebar = document.getElementById('sidebar');

menuToggle.addEventListener('click', () => {
  sidebar.classList.toggle('open');
  menuToggle.innerHTML = sidebar.classList.contains('open') 
    ? '<i class="fas fa-times"></i>' 
    : '<i class="fas fa-bars"></i>';
});

// Close sidebar when clicking on a link (for mobile)
document.querySelectorAll('.nav-item, .site-link').forEach(link => {
  link.addEventListener('click', () => {
    if (window.innerWidth <= 992) {
      sidebar.classList.remove('open');
      menuToggle.innerHTML = '<i class="fas fa-bars"></i>';
    }
  });
});

// Update breadcrumb based on scroll position
function updateBreadcrumb() {
  const sections = document.querySelectorAll('.tool-card');
  let currentSection = sections[0];
  
  sections.forEach(section => {
    const rect = section.getBoundingClientRect();
    if (rect.top <= 100 && rect.bottom >= 100) {
      currentSection = section;
    }
  });
  
  const sectionName = currentSection.querySelector('.tool-title').textContent;
  document.getElementById('currentSection').textContent = sectionName;
  
  // Update active nav item
  document.querySelectorAll('.nav-item').forEach(item => {
    item.classList.remove('active');
    if (item.getAttribute('href') === `#${currentSection.id}`) {
      item.classList.add('active');
    }
  });
}

window.addEventListener('scroll', updateBreadcrumb);
window.addEventListener('load', updateBreadcrumb);

// Smooth scrolling for anchor links
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function(e) {
    e.preventDefault();
    const targetId = this.getAttribute('href');
    if (targetId === '#') return;
    
    const targetElement = document.querySelector(targetId);
    if (targetElement) {
      window.scrollTo({
        top: targetElement.offsetTop - 20,
        behavior: 'smooth'
      });
    }
  });
});

// Breathing Tool
const breathShape = document.getElementById('breathShape');
let breathingPaused = false;
let breathAnimation;

function initBreathing() {
  if (breathAnimation) {
    breathShape.style.animation = 'none';
    setTimeout(() => {
      breathShape.style.animation = 'breathe 8s infinite cubic-bezier(0.4, 0, 0.2, 1)';
    }, 10);
  }
}

document.getElementById('pauseBreathing').addEventListener('click', () => {
  breathingPaused = true;
  breathShape.style.animationPlayState = 'paused';
  breathShape.textContent = 'Paused';
});

document.getElementById('resumeBreathing').addEventListener('click', () => {
  breathingPaused = false;
  breathShape.style.animationPlayState = 'running';
  breathShape.textContent = 'Breathe';
});

// Initialize breathing animation
window.addEventListener('load', initBreathing);

// Grounding Tool
const groundButtons = document.querySelectorAll('.ground-btn');
const groundingComplete = document.getElementById('groundingComplete');
let groundedCount = 0;

groundButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    if (btn.classList.contains('done')) return;
    
    btn.classList.add('done');
    groundedCount++;
    
    // Add visual feedback
    btn.style.transform = 'scale(0.98)';
    setTimeout(() => {
      btn.style.transform = '';
    }, 150);
    
    if (groundedCount >= groundButtons.length) {
      groundingComplete.style.display = 'block';
      groundingComplete.style.animation = 'cardAppear 0.5s ease-out';
    }
  });
});

document.getElementById('resetGrounding').addEventListener('click', () => {
  groundButtons.forEach(btn => {
    btn.classList.remove('done');
  });
  groundedCount = 0;
  groundingComplete.style.display = 'none';
});

// Self Check-In Tool
const checkButtons = document.querySelectorAll('[data-check]');
checkButtons.forEach(btn => {
  btn.addEventListener('click', () => {
    btn.classList.toggle('done');
  });
});

// Audio Tool
let audioContext = null;
let currentOscillator = null;
let currentGainNode = null;
let currentPlaying = null;

function initAudioContext() {
  if (!audioContext) {
    audioContext = new (window.AudioContext || window.webkitAudioContext)();
  }
}

function playSound(type) {
  // Stop any currently playing sound
  stopAllAudio();
  
  initAudioContext();
  
  // Update UI
  document.querySelectorAll('.audio-btn').forEach(btn => {
    btn.classList.remove('playing');
  });
  event.target.classList.add('playing');
  currentPlaying = event.target;
  
  // Create oscillator and gain node
  currentOscillator = audioContext.createOscillator();
  currentGainNode = audioContext.createGain();
  
  // Set frequency and type based on the selected sound
  switch(type) {
    case 'whiteNoise':
      // White noise is created with a buffer of random values
      createWhiteNoise();
      return;
    case 'ocean':
      currentOscillator.type = 'sine';
      currentOscillator.frequency.value = 110; // Low frequency for ocean-like sound
      // Add modulation for wave effect
      const lfo = audioContext.createOscillator();
      lfo.frequency.value = 0.2; // Slow modulation for wave effect
      const lfoGain = audioContext.createGain();
      lfoGain.gain.value = 20; // Modulation depth
      lfo.connect(lfoGain);
      lfoGain.connect(currentOscillator.frequency);
      lfo.start();
      break;
    case 'forest':
      currentOscillator.type = 'sine';
      currentOscillator.frequency.value = 500;
      break;
    case 'rain':
      currentOscillator.type = 'sine';
      currentOscillator.frequency.value = 300;
      // Add random modulation for rain effect
      const rainLFO = audioContext.createOscillator();
      rainLFO.frequency.value = 0.5;
      const rainGain = audioContext.createGain();
      rainGain.gain.value = 50;
      rainLFO.connect(rainGain);
      rainGain.connect(currentOscillator.frequency);
      rainLFO.start();
      break;
  }
  
  // Set volume
  currentGainNode.gain.value = 0.1;
  
  // Connect and start
  currentOscillator.connect(currentGainNode);
  currentGainNode.connect(audioContext.destination);
  currentOscillator.start();
}

function createWhiteNoise() {
  const bufferSize = 2 * audioContext.sampleRate;
  const noiseBuffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
  const output = noiseBuffer.getChannelData(0);
  
  for (let i = 0; i < bufferSize; i++) {
    output[i] = Math.random() * 2 - 1;
  }
  
  currentOscillator = audioContext.createBufferSource();
  currentOscillator.buffer = noiseBuffer;
  currentOscillator.loop = true;
  currentGainNode = audioContext.createGain();
  currentGainNode.gain.value = 0.05;
  
  currentOscillator.connect(currentGainNode);
  currentGainNode.connect(audioContext.destination);
  currentOscillator.start();
}

function stopAllAudio() {
  if (currentOscillator) {
    try {
      currentOscillator.stop();
      currentOscillator.disconnect();
    } catch(e) {}
    currentOscillator = null;
  }
  if (currentGainNode) {
    currentGainNode.disconnect();
    currentGainNode = null;
  }
  
  // Update UI
  document.querySelectorAll('.audio-btn').forEach(btn => {
    btn.classList.remove('playing');
  });
  currentPlaying = null;
}

// Audio button event listeners
document.querySelectorAll('.audio-btn').forEach(btn => {
  btn.addEventListener('click', function() {
    const soundType = this.getAttribute('data-sound');
    
    // If this sound is already playing, stop it
    if (this.classList.contains('playing')) {
      stopAllAudio();
    } else {
      playSound(soundType);
    }
  });
});

document.getElementById('stopAllAudio').addEventListener('click', stopAllAudio);

// Mantra Tool
let mantraIndex = 0;
const mantras = [
  "I am safe and this will pass.",
  "This feeling is temporary ‚Äî I can wait.",
  "I can breathe. I can slow down.",
  "I have survived this before. I will again.",
  "Small steps. One breath at a time.",
  "I am not my thoughts. I am the observer.",
  "This too shall pass. Everything changes.",
  "I am exactly where I need to be.",
  "I release what I cannot control.",
  "I am supported by the universe."
];

const mantraText = document.getElementById('mantraText');

function showMantra(index) {
  mantraText.style.opacity = '0.5';
  mantraText.style.transform = 'translateY(10px)';
  
  setTimeout(() => {
    mantraText.textContent = mantras[index];
    mantraText.style.opacity = '1';
    mantraText.style.transform = 'translateY(0)';
    mantraText.style.transition = 'all 0.3s ease';
  }, 150);
}

document.getElementById('nextMantra').addEventListener('click', () => {
  mantraIndex = (mantraIndex + 1) % mantras.length;
  showMantra(mantraIndex);
});

document.getElementById('prevMantra').addEventListener('click', () => {
  mantraIndex = (mantraIndex - 1 + mantras.length) % mantras.length;
  showMantra(mantraIndex);
});

mantraText.addEventListener('click', () => {
  mantraIndex = (mantraIndex + 1) % mantras.length;
  showMantra(mantraIndex);
});

// Timer Tool
let timer = null;
let timeLeft = 900; // 15 minutes in seconds
const timerDisplay = document.getElementById('timerDisplay');
const timerMessage = document.getElementById('timerMessage');

function updateTimerDisplay() {
  const minutes = Math.floor(timeLeft / 60);
  const seconds = timeLeft % 60;
  timerDisplay.textContent = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
  
  // Update message based on time left
  if (timeLeft === 600) { // 10 minutes left
    timerMessage.textContent = "You're about halfway there. Keep breathing.";
  } else if (timeLeft === 300) { // 5 minutes left
    timerMessage.textContent = "Almost there. This will pass soon.";
  } else if (timeLeft === 0) {
    timerMessage.textContent = "Time's up. How are you feeling now?";
  }
}

document.getElementById('startTimer').addEventListener('click', () => {
  if (timer) return; // Already running
  
  timer = setInterval(() => {
    if (timeLeft <= 0) {
      clearInterval(timer);
      timer = null;
      // Play a gentle sound or show message
      timerMessage.textContent = "Time's up. How are you feeling now?";
      return;
    }
    timeLeft--;
    updateTimerDisplay();
  }, 1000);
  
  timerMessage.textContent = "Timer started. Many people find things stabilize after ~10-20 minutes";
});

document.getElementById('pauseTimer').addEventListener('click', () => {
  if (timer) {
    clearInterval(timer);
    timer = null;
    timerMessage.textContent = "Timer paused. Resume when ready.";
  }
});

document.getElementById('resetTimer').addEventListener('click', () => {
  clearInterval(timer);
  timer = null;
  timeLeft = 900;
  updateTimerDisplay();
  timerMessage.textContent = "Timer reset. Many people find things stabilize after ~10-20 minutes";
});

// Initialize timer display
updateTimerDisplay();

// Sensory Safe Mode
const toggleSafeBtn = document.getElementById('toggleSafe');
toggleSafeBtn.addEventListener('click', () => {
  const isSafeMode = document.body.classList.toggle('sensory-safe');
  toggleSafeBtn.setAttribute('aria-pressed', isSafeMode);
  toggleSafeBtn.innerHTML = isSafeMode 
    ? '<i class="fas fa-moon"></i> Sensory Safe Mode (On)' 
    : '<i class="fas fa-moon"></i> Sensory Safe Mode';
  
  // Stop all audio when entering safe mode
  if (isSafeMode) {
    stopAllAudio();
  }
  
  // Reduce animations in safe mode
  if (isSafeMode) {
    breathShape.style.animationDuration = '12s';
  } else {
    breathShape.style.animationDuration = '8s';
  }
});

// Save Reflections
document.getElementById('saveReflections').addEventListener('click', () => {
  const reflection1 = document.getElementById('reflection1').value;
  const reflection2 = document.getElementById('reflection2').value;
  
  // In a real app, you would save to local storage or a server
  // For now, we'll just show a confirmation
  alert('Reflections saved! In a real implementation, these would be stored for your future reference.');
  
  // Reset the textareas
  document.getElementById('reflection1').value = '';
  document.getElementById('reflection2').value = '';
});

// Chill Zone Button
document.getElementById('findChillZone').addEventListener('click', () => {
  alert("At an event: Look for medical tents, 'safe spaces', or 'chill zones'. Ask staff for help finding a quiet area. If at home, find a comfortable, dimly lit room.");
});

// Generate Cheat Sheet
document.getElementById('generateCheatSheet').addEventListener('click', generateCheatSheet);
document.getElementById('downloadCheatSheet').addEventListener('click', generateCheatSheet);

function generateCheatSheet() {
  const cheatSheetContent = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PLURderapolis Bad Trip Guide Cheat Sheet</title>
<style>
  body {
    font-family: 'Helvetica', 'Arial', sans-serif;
    line-height: 1.6;
    margin: 0;
    padding: 20px;
    background: #f5f5f5;
    color: #333;
  }
  .container {
    max-width: 800px;
    margin: 0 auto;
    background: white;
    padding: 30px;
    border-radius: 10px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
  }
  h1, h2, h3 {
    color: #2a0040;
  }
  h1 {
    border-bottom: 3px solid #00f7e0;
    padding-bottom: 10px;
  }
  .section {
    margin-bottom: 25px;
    padding-bottom: 20px;
    border-bottom: 1px solid #eee;
  }
  .emergency {
    background: #fff0f0;
    border-left: 4px solid #ff6ec7;
    padding: 15px;
    margin: 20px 0;
  }
  .tip {
    background: #f0fff9;
    border-left: 4px solid #00f7e0;
    padding: 15px;
    margin: 15px 0;
  }
  ul {
    padding-left: 20px;
  }
  li {
    margin-bottom: 8px;
  }
  .header {
    text-align: center;
    margin-bottom: 30px;
  }
  .header img {
    max-width: 150px;
    margin-bottom: 10px;
  }
  @media print {
    body {
      background: white;
    }
    .container {
      box-shadow: none;
    }
    .no-print {
      display: none;
    }
  }
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>üçë PLURderapolis Bad Trip Guide Cheat Sheet</h1>
      <p><strong>Quick reference for difficult psychedelic experiences</strong></p>
      <p class="no-print">Generated on ${new Date().toLocaleDateString()}</p>
    </div>
    
    <div class="section">
      <h2>üå¨Ô∏è Immediate Breathing Technique (4-7-8)</h2>
      <div class="tip">
        <ol>
          <li>Inhale quietly through your nose for 4 seconds</li>
          <li>Hold your breath for 7 seconds</li>
          <li>Exhale completely through your mouth for 8 seconds</li>
          <li>Repeat 4-5 times</li>
        </ol>
        <p><em>This activates your parasympathetic nervous system.</em></p>
      </div>
    </div>
    
    <div class="section">
      <h2>ü™® 5-4-3-2-1 Grounding Method</h2>
      <div class="tip">
        <p>Engage your senses to return to the present:</p>
        <ul>
          <li><strong>5</strong> things you can SEE</li>
          <li><strong>4</strong> things you can TOUCH or FEEL</li>
          <li><strong>3</strong> things you can HEAR</li>
          <li><strong>2</strong> things you can SMELL</li>
          <li><strong>1</strong> thing you can TASTE</li>
        </ul>
        <p><em>Alternative: Name 3 favorite colors, 3 comforting objects, or 3 people who care about you.</em></p>
      </div>
    </div>
    
    <div class="section">
      <h2>üßç Self Check-In Checklist</h2>
      <ul>
        <li>‚úÖ <strong>Hydrate:</strong> Sip water slowly (not too fast)</li>
        <li>‚úÖ <strong>Comfort:</strong> Adjust clothing, remove anything tight</li>
        <li>‚úÖ <strong>Position:</strong> Sit or lie down in a safe place</li>
        <li>‚úÖ <strong>Connection:</strong> Reach out to a trusted person if possible</li>
        <li>‚úÖ <strong>Temperature:</strong> Adjust if too hot or cold</li>
        <li>‚úÖ <strong>Environment:</strong> Dim lights, reduce noise if possible</li>
      </ul>
    </div>
    
    <div class="section">
      <h2>üß† Calming Mantras</h2>
      <div class="tip">
        <p>Repeat these phrases slowly:</p>
        <ul>
          <li>"I am safe and this will pass."</li>
          <li>"This feeling is temporary ‚Äî I can wait."</li>
          <li>"I can breathe. I can slow down."</li>
          <li>"I have survived this before. I will again."</li>
          <li>"I am not my thoughts. I am the observer."</li>
          <li>"This too shall pass. Everything changes."</li>
        </ul>
      </div>
    </div>
    
    <div class="section">
      <h2>üéµ At Music Events/Shows</h2>
      <ul>
        <li><strong>Hydrate:</strong> Sip water slowly and often</li>
        <li><strong>Chill Zone:</strong> Find designated quiet spaces</li>
        <li><strong>Buddy System:</strong> Stay with someone you trust</li>
        <li><strong>Sensory Protection:</strong> Earplugs, sunglasses</li>
        <li><strong>Know Staff:</strong> Locate medical/security teams</li>
        <li><strong>No Mixing:</strong> Avoid combining substances</li>
        <li><strong>Eat Light:</strong> Simple carbs or fruit if possible</li>
      </ul>
    </div>
    
    <div class="section">
      <h2>‚è≥ The 20-Minute Rule</h2>
      <div class="tip">
        <p>Most intense moments pass within 10-20 minutes.</p>
        <p><strong>Set a timer for 15 minutes</strong> and focus on breathing.</p>
        <p>Remind yourself: "I just need to get through these next few minutes."</p>
      </div>
    </div>
    
    <div class="emergency">
      <h2>üö® Emergency Resources</h2>
      <p><strong>If you need immediate human support:</strong></p>
      <ul>
        <li><strong>TripSit:</strong> tripsit.me (live chat & resources)</li>
        <li><strong>Fireside Project:</strong> firesideproject.org (peer support line)</li>
        <li><strong>Never Use Alone:</strong> neverusealone.com (phone check-in service)</li>
        <li><strong>PLURderapolis Panic Button:</strong> plurderapolis.org/panic.html</li>
        <li><strong>Medical Emergency:</strong> Call 911 or local emergency services</li>
      </ul>
      <p><strong>Remember:</strong> You are not alone. Reaching out is a sign of strength.</p>
    </div>
    
    <div class="section">
      <h2>üí≠ Aftercare & Integration</h2>
      <p>After the experience passes:</p>
      <ul>
        <li>Rest and hydrate</li>
        <li>Eat nourishing, simple food</li>
        <li>Talk to someone you trust about the experience</li>
        <li>Write down insights or what helped</li>
        <li>Be gentle with yourself for the next 24-48 hours</li>
      </ul>
    </div>
    
    <div class="section no-print">
      <h2>üì± Full Interactive Guide</h2>
      <p>For the complete interactive guide with breathing animations, soothing sounds, and more tools, visit:</p>
      <p style="text-align: center; font-size: 1.2rem;"><strong>plurderapolis.org/bad-trip-guide</strong></p>
    </div>
    
    <div class="section" style="text-align: center; margin-top: 40px; padding-top: 20px; border-top: 2px solid #eee;">
      <p><strong>PLURderapolis ‚Äî Your partners in shine üçë</strong></p>
      <p><em>Harm reduction education & community support</em></p>
      <p style="font-size: 0.9rem; color: #666; margin-top: 20px;">
        This guide is for harm reduction purposes only. Not medical advice. 
        If experiencing a medical emergency, call emergency services immediately.
      </p>
    </div>
  </div>
  
  <div class="no-print" style="text-align: center; margin-top: 20px;">
    <button onclick="window.print()" style="padding: 10px 20px; background: #00f7e0; color: #111; border: none; border-radius: 5px; font-weight: bold; cursor: pointer;">
      Print This Cheat Sheet
    </button>
    <p style="margin-top: 10px; color: #666;">Save as PDF: Print ‚Üí Select "Save as PDF" as printer</p>
  </div>
</body>
</html>
`;

  // Create a Blob with the HTML content
  const blob = new Blob([cheatSheetContent], { type: 'text/html' });
  
  // Create a temporary link to download the file
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'PLURderapolis_Bad_Trip_Guide_Cheat_Sheet.html';
  
  // Trigger download
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
  
  // Show confirmation
  alert('Cheat sheet downloaded! Open the file to view and print it.');
}

// Initialize audio context on first user interaction
document.addEventListener('click', function initAudioOnInteraction() {
  if (!audioContext) {
    initAudioContext();
  }
  document.removeEventListener('click', initAudioOnInteraction);
}, { once: true });

// PWA Support
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js').catch(err => {
      console.log('Service Worker registration failed: ', err);
    });
  });
}

// Install prompt
let deferredPrompt;
window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  // You could show an install button here if desired
});

// Add ripple effect to buttons
document.addEventListener('click', function(e) {
  if (e.target.matches('.btn, .ground-btn, .audio-btn, .nav-item')) {
    const btn = e.target;
    const ripple = document.createElement('span');
    const rect = btn.getBoundingClientRect();
    const size = Math.max(rect.width, rect.height);
    const x = e.clientX - rect.left - size / 2;
    const y = e.clientY - rect.top - size / 2;
    
    ripple.style.cssText = `
      position: absolute;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.3);
      transform: scale(0);
      animation: ripple 0.6s linear;
      width: ${size}px;
      height: ${size}px;
      top: ${y}px;
      left: ${x}px;
      pointer-events: none;
    `;
    
    btn.style.position = 'relative';
    btn.style.overflow = 'hidden';
    btn.appendChild(ripple);
    
    setTimeout(() => {
      ripple.remove();
    }, 600);
  }
});

// Add ripple animation CSS
const rippleStyle = document.createElement('style');
rippleStyle.textContent = `
  @keyframes ripple {
    to {
      transform: scale(4);
      opacity: 0;
    }
  }
`;
document.head.appendChild(rippleStyle);

// Initialize everything when page loads
window.addEventListener('DOMContentLoaded', () => {
  console.log('PLURderapolis Bad Trip Guide loaded');
  
  // Set initial active section
  updateBreadcrumb();
});
</script>
</body>
</html>
