<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta name="description" content="PLURderapolis Polydrug Interaction Checker - Harm reduction focused tool to check drug combination risks and safety tips.">
<meta name="keywords" content="polydrug, drug interactions, harm reduction, PLURderapolis, drug safety, risk assessment">
<title>Polydrug Risks & Interaction Checker | PLURderapolis</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root{
    --bg:#121212;
    --card:#1b0b1b;
    --ink:#eee;
    --muted:#bcbcbc;
    --accent:#bf00bf;
    --accent-2:#e051ff;
    --line:#440044;
    --chip:#550055;
    --shadow:0 0 12px rgba(191,0,191,.25);
    --danger:#ff4d4d;
    --caution:#ffb84d;
    --low-risk:#4dff88;
    --card-gradient: linear-gradient(135deg, #1b0b1b 0%, #2a0a2a 100%);
    --glow: 0 0 15px rgba(191, 0, 191, 0.5);
  }
  *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:'Open Sans',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; scroll-behavior: smooth; overflow-x: hidden;}
  a{color:var(--accent); text-decoration: none; transition: all 0.3s ease;}
  a:hover {color: var(--accent-2); text-shadow: 0 0 8px rgba(224, 81, 255, 0.5);}
  .wrap{max-width:1000px;margin:auto;padding:16px; width: 100%;}
  h1,h2,h3{font-family:'Montserrat',sans-serif;letter-spacing:.2px; margin-top: 0;}
  h1{font-size:clamp(1.8rem,3vw,2.5rem);color:var(--accent);margin:8px 0 6px; text-align: center; text-shadow: 0 0 10px rgba(191, 0, 191, 0.4);}
  p.lede{color:#f0d1ff;margin:.25rem 0 1rem; font-size: 1.1rem; text-align: center; line-height: 1.5;}
  
  /* Header branding */
  .branding{display:flex;align-items:center;gap:10px;margin-bottom:10px; justify-content: center; flex-direction: column; text-align: center;}
  .logo{font-size:2.2rem;font-weight:800;color:var(--accent);background:linear-gradient(45deg, var(--accent), var(--accent-2), #ff00ff, #bf00bf);-webkit-background-clip:text;-webkit-text-fill-color:transparent; animation: logoPulse 4s infinite ease-in-out, logoColors 8s infinite linear; text-shadow: 0 0 15px rgba(191, 0, 191, 0.5); margin-bottom: 5px; cursor: pointer;}
  @keyframes logoPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }
  @keyframes logoColors {
    0% { filter: hue-rotate(0deg); }
    100% { filter: hue-rotate(360deg); }
  }
  .tagline{color:var(--muted);font-size:1rem; max-width: 500px; line-height: 1.4;}
  
  /* Mobile Header with Menu */
  .mobile-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: var(--card-gradient);
    border-bottom: 1px solid var(--line);
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: var(--shadow);
  }
  
  .mobile-header .logo {
    font-size: 1.6rem;
    margin: 0;
  }
  
  .mobile-menu-btn {
    background: var(--chip);
    color: var(--ink);
    border: 1px solid var(--line);
    border-radius: 8px;
    padding: 10px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
  }
  
  .mobile-menu-btn:hover {
    background: var(--accent);
    transform: translateY(-2px);
    box-shadow: var(--glow);
  }
  
  .mobile-nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    display: none;
    flex-direction: column;
    padding: 20px;
    overflow-y: auto;
  }
  
  .mobile-nav-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--line);
  }
  
  .mobile-nav-title {
    font-size: 1.4rem;
    color: var(--accent-2);
    font-weight: 700;
  }
  
  .mobile-nav-close {
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }
  
  .mobile-nav-close:hover {
    background: var(--accent-2);
    transform: scale(1.1);
  }
  
  .mobile-nav-section {
    margin-bottom: 25px;
  }
  
  .mobile-nav-section-title {
    font-size: 1.1rem;
    color: var(--accent-2);
    margin-bottom: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  
  .mobile-nav-links {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .mobile-nav-link {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 15px;
    background: var(--card-gradient);
    border-radius: 10px;
    border: 1px solid var(--line);
    color: var(--ink);
    transition: all 0.3s ease;
  }
  
  .mobile-nav-link:hover {
    background: rgba(191, 0, 191, 0.1);
    border-color: var(--accent);
    transform: translateX(5px);
  }
  
  .mobile-nav-link.highlight {
    background: var(--chip);
    font-weight: 700;
  }
  
  .mobile-nav-link.highlight:hover {
    background: var(--accent);
  }
  
  /* Top checker card */
  .tool{background:var(--card-gradient);border-radius:14px;padding:20px;box-shadow:var(--shadow);position:sticky;top:0.35rem;z-index:5; animation: fadeIn 0.8s ease-out; border: 1px solid var(--line); margin-bottom: 25px;}
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .tool h2{font-size:1.3rem;margin:.2rem 0 .6rem;color:var(--accent-2); text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px;}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .sel{flex:1 1 100%;min-width:0;display:flex;flex-direction:column;gap:6px}
  label{font-weight:700;color:var(--accent);font-size:.9rem; display: flex; align-items: center; gap: 5px;}
  select{width:100%;padding:.8rem 1rem;border:1px solid var(--line);border-radius:10px;background:#220022;color:var(--ink);appearance:none; transition: all 0.3s ease; font-size: 1rem;}
  select:focus {outline: none; border-color: var(--accent-2); box-shadow: 0 0 0 2px rgba(224, 81, 255, 0.3);}
  button.primary{background:var(--accent);color:#fff;border:0;border-radius:10px;padding:.9rem 1.2rem;font-weight:800;cursor:pointer; transition: all 0.3s ease; position: relative; overflow: hidden; font-size: 1rem; width: 100%;}
  button.primary:hover {background: var(--accent-2); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(191, 0, 191, 0.4);}
  button.primary:active{transform:translateY(1px)}
  button.primary::after {content: ''; position: absolute; top: 50%; left: 50%; width: 5px; height: 5px; background: rgba(255, 255, 255, 0.5); opacity: 0; border-radius: 100%; transform: scale(1, 1) translate(-50%); transform-origin: 50% 50%;}
  button.primary:focus:not(:active)::after {animation: ripple 1s ease-out;}
  @keyframes ripple {0% {transform: scale(0, 0); opacity: 0.5;} 100% {transform: scale(20, 20); opacity: 0;}}
  .icons{font-size:1.05rem;opacity:.95; animation: iconGlow 2s infinite alternate;}
  @keyframes iconGlow {
    from { text-shadow: 0 0 5px rgba(191, 0, 191, 0.5); }
    to { text-shadow: 0 0 10px rgba(224, 81, 255, 0.8); }
  }
  .result{margin-top:20px;border:1px dashed var(--line);border-radius:12px;padding:15px;background:#170717; animation: slideIn 0.5s ease-out; max-height: 500px; overflow-y: auto;}
  @keyframes slideIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .result h3{margin:.2rem 0 .4rem;color:#ffd6ff;font-size:1.2rem; text-align: center;}
  .pairs{margin:.4rem 0 0;padding-left:18px}
  .pair-detail{background:#1f001f;border-radius:8px;padding:15px;margin:12px 0;border-left:4px solid var(--accent); animation: fadeInUp 0.5s ease-out; box-shadow: 0 2px 8px rgba(0,0,0,0.2); position: relative;}
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .pair-detail.risk-low{border-left-color:var(--low-risk); box-shadow: 0 2px 8px rgba(77, 255, 136, 0.1);}
  .pair-detail.risk-caution{border-left-color:var(--caution); box-shadow: 0 2px 8px rgba(255, 184, 77, 0.1);}
  .pair-detail.risk-strong{border-left-color:var(--accent);}
  .pair-detail.risk-danger{border-left-color:var(--danger); box-shadow: 0 2px 8px rgba(255, 77, 77, 0.1);}
  .risk-icon {position: absolute; top: 15px; right: 15px; font-size: 1.5rem; animation: pulse 2s infinite;}
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }
  .legend{display:flex;gap:10px;flex-wrap:wrap;margin:15px 0 0;font-size:.95rem;color:var(--muted); justify-content: center;}
  .legend span{display:inline-flex;gap:6px;align-items:center;background:#200120;border:1px solid var(--line);border-radius:999px;padding:.4rem .8rem; transition: all 0.3s ease;}
  .legend span:hover {transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);}
  
  /* Matrix Key Section */
  .matrix-key {
    background: var(--card-gradient);
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
    border: 1px solid var(--line);
    box-shadow: var(--shadow);
    animation: fadeIn 0.8s ease-out;
  }
  
  .matrix-key h3 {
    color: var(--accent-2);
    margin-top: 0;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  
  .key-items {
    display: grid;
    grid-template-columns: 1fr;
    gap: 15px;
    margin-top: 15px;
  }
  
  .key-item {
    background: #1f001f;
    border-radius: 8px;
    padding: 15px;
    border-left: 4px solid;
    animation: fadeInUp 0.5s ease-out;
  }
  
  .key-item.low { border-left-color: var(--low-risk); }
  .key-item.caution { border-left-color: var(--caution); }
  .key-item.strong { border-left-color: var(--accent); }
  .key-item.danger { border-left-color: var(--danger); }
  
  .key-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .key-icon {
    font-size: 1.5rem;
  }
  
  .key-title {
    font-weight: 700;
    font-size: 1.1rem;
  }
  
  /* Share Results */
  .share-results {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .share-btn {
    background: var(--chip);
    color: var(--ink);
    border: 1px solid var(--line);
    border-radius: 999px;
    padding: 10px 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 0.9rem;
    flex: 1;
    min-width: 140px;
    justify-content: center;
  }
  
  .share-btn:hover {
    background: var(--accent);
    transform: translateY(-2px);
    box-shadow: var(--glow);
  }
  
  /* Matrix */
  .controls{display:flex;align-items:center;gap:15px;margin:20px 0 15px;flex-wrap:wrap; justify-content: center;}
  .download{background:var(--accent);color:#fff;border:0;border-radius:999px;padding:.9rem 1.4rem;font-weight:800;cursor:pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; font-size: 1rem;}
  .download:hover {background: var(--accent-2); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(191, 0, 191, 0.4);}
  .share{background:#2a002a;color:#fff;border:1px solid var(--line);border-radius:999px;padding:.9rem 1.4rem;font-weight:700;cursor:pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; font-size: 1rem;}
  .share:hover {background: #3a003a; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);}
  .matrix{overflow:auto;border-radius:12px;box-shadow:var(--shadow);border:1px solid var(--line);background:#160616; animation: fadeIn 0.8s ease-out 0.2s both; margin-bottom: 25px;}
  table{border-collapse:collapse;width:100%;min-width:980px;font-size:.92rem}
  th,td{border:1px solid var(--line);padding:.45rem .55rem;text-align:center;vertical-align:middle; transition: all 0.3s ease; position: relative;}
  thead th{position:sticky;top:0;background:#3b0a3b;color:#ffe5ff;z-index:2; box-shadow: 0 2px 5px rgba(0,0,0,0.2);}
  tbody th{position:sticky;left:0;background:#2a002a;color:#fff;z-index:1; box-shadow: 2px 0 5px rgba(0,0,0,0.2);}
  td{background:#1f001f; transition: all 0.3s ease; cursor: pointer;}
  td:hover {transform: scale(1.05); z-index: 3; box-shadow: 0 0 10px rgba(191, 0, 191, 0.5); animation: cellPulse 0.5s;}
  @keyframes cellPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1.05); }
  }
  td.risk-low{background:#0a2a14}
  td.risk-caution{background:#2a200a}
  td.risk-strong{background:#2a0a2a}
  td.risk-danger{background:#2a0a0a}
  .chip {display:inline-block;background:var(--chip);border-radius:999px;padding:.18rem .55rem;font-weight:700; transition: all 0.3s ease;}
  .chip:hover {transform: scale(1.05); background: var(--accent);}
  
  /* Sections at bottom (accordion) */
  details.info{background:var(--card-gradient);border:1px solid var(--line);border-radius:12px;padding:.8rem 1rem;margin:.8rem 0; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1);}
  details.info:hover {border-color: var(--accent); transform: translateY(-2px);}
  details.info summary{cursor:pointer;font-weight:800;list-style:none; transition: all 0.3s ease; display: flex; align-items: center; padding: 12px 0; font-size: 1.1rem;}
  details.info summary:hover {color: var(--accent-2);}
  details.info summary::marker, details.info summary::-webkit-details-marker{display:none}
  details.info summary .tag{margin-left:.5rem;opacity:.85; font-size: 0.8rem; background: var(--chip); padding: 2px 8px; border-radius: 10px;}
  details.info[open] {animation: accordionOpen 0.5s ease-out;}
  @keyframes accordionOpen {
    from { opacity: 0; max-height: 0; }
    to { opacity: 1; max-height: 500px; }
  }
  
  /* Back to top button */
  .back-to-top{position:fixed;bottom:20px;right:20px;background:var(--accent);color:#fff;border:0;border-radius:50%;width:50px;height:50px;font-size:1.5rem;cursor:pointer;box-shadow:var(--shadow);z-index:100;display:none; transition: all 0.3s ease; animation: bounce 2s infinite;}
  @keyframes bounce {
    0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
    40% {transform: translateY(-10px);}
    60% {transform: translateY(-5px);}
  }
  .back-to-top:hover {background: var(--accent-2); transform: translateY(-3px) scale(1.1); box-shadow: 0 6px 15px rgba(191, 0, 191, 0.5);}
  
  /* Footer */
  footer{border-top:1px solid var(--line);color:var(--muted);font-size:.9rem;padding:18px;margin-top:16px;text-align:center; animation: fadeIn 0.8s ease-out 0.4s both;}
  .pill{display:inline-block;background:var(--chip);padding:.22rem .6rem;border-radius:999px;font-weight:800; transition: all 0.3s ease;}
  .pill:hover {transform: scale(1.05); background: var(--accent);}
  
  /* Footer Navigation */
  .footer-nav {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin: 20px 0;
  }
  
  .footer-link {
    color: var(--muted);
    transition: all 0.3s ease;
    padding: 10px 15px;
    border-radius: 20px;
    border: 1px solid transparent;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
  }
  
  .footer-link:hover {
    color: var(--accent-2);
    border-color: var(--accent);
    transform: translateY(-2px);
  }
  
  .footer-link.highlight {
    background: var(--chip);
    color: var(--ink);
    font-weight: 700;
  }
  
  .footer-link.highlight:hover {
    background: var(--accent);
  }
  
  /* Mobile swipe indicators */
  .swipe-indicator {
    display: block;
    text-align: center;
    margin: 10px 0;
    color: var(--muted);
    font-size: 0.9rem;
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
  }
  
  /* Section headings */
  .section-heading {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 25px 0 15px;
    color: var(--accent-2);
    font-size: 1.4rem;
    animation: fadeIn 0.8s ease-out;
  }
  
  .section-heading::after {
    content: '';
    flex: 1;
    height: 2px;
    background: linear-gradient(90deg, var(--accent-2), transparent);
  }
  
  /* Floating particles animation */
  .particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
  }
  
  .particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: var(--accent-2);
    border-radius: 50%;
    animation: float 15s infinite linear;
    opacity: 0.3;
  }
  
  @keyframes float {
    0% {
      transform: translateY(100vh) translateX(0);
      opacity: 0;
    }
    10% {
      opacity: 0.3;
    }
    90% {
      opacity: 0.3;
    }
    100% {
      transform: translateY(-100px) translateX(100px);
      opacity: 0;
    }
  }
  
  /* Matrix Detail Modal */
  .matrix-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 3000;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease-out;
    padding: 20px;
  }
  
  .matrix-modal-content {
    background: var(--card-gradient);
    border-radius: 12px;
    padding: 20px;
    width: 100%;
    max-width: 500px;
    box-shadow: var(--shadow);
    border: 1px solid var(--line);
    animation: slideIn 0.3s ease-out;
    max-height: 80vh;
    overflow-y: auto;
  }
  
  .matrix-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }
  
  .matrix-modal h3 {
    margin: 0;
    color: var(--accent-2);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.3rem;
  }
  
  .matrix-modal-close {
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 1rem;
  }
  
  .matrix-modal-close:hover {
    background: var(--accent-2);
    transform: scale(1.1);
  }
  
  /* Save page modal */
  .save-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 3000;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease-out;
    padding: 20px;
  }
  
  .save-modal-content {
    background: var(--card-gradient);
    border-radius: 12px;
    padding: 20px;
    width: 100%;
    max-width: 500px;
    box-shadow: var(--shadow);
    border: 1px solid var(--line);
    animation: slideIn 0.3s ease-out;
  }
  
  .save-modal h3 {
    margin-top: 0;
    color: var(--accent-2);
    text-align: center;
    font-size: 1.3rem;
  }
  
  .save-options {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
    margin: 15px 0;
  }
  
  .save-option {
    background: var(--chip);
    border: 1px solid var(--line);
    border-radius: 8px;
    padding: 15px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }
  
  .save-option:hover {
    background: var(--accent);
    transform: translateY(-2px);
  }
  
  .modal-close {
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    font-size: 1rem;
    font-weight: 700;
  }
  
  .modal-close:hover {
    background: var(--accent-2);
  }
  
  /* Desktop-only elements */
  .desktop-only {
    display: none;
  }
  
  /* Mobile optimizations */
  @media (min-width: 768px) {
    .mobile-header {
      display: none;
    }
    
    .desktop-only {
      display: block;
    }
    
    .sel {
      flex: 1 1 180px;
    }
    
    button.primary {
      width: auto;
    }
    
    .key-items {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .save-options {
      grid-template-columns: repeat(3, 1fr);
    }
    
    .share-btn {
      flex: 0 1 auto;
      min-width: auto;
    }
    
    .footer-nav {
      gap: 15px;
    }
    
    .footer-link {
      font-size: 1rem;
    }
  }
  
  @media (max-width: 767px) {
    .tool {
      position: static;
      margin-top: 20px;
    }
    
    .legend {
      font-size: .85rem;
    }
    
    table {
      font-size: .8rem;
      min-width: 800px;
    }
    
    .controls {
      flex-direction: column;
      align-items: stretch;
      gap: 10px;
    }
    
    .download, .share {
      width: 100%;
      justify-content: center;
    }
    
    .branding {
      display: none;
    }
    
    h1 {
      font-size: 1.6rem;
      margin-top: 10px;
    }
    
    p.lede {
      font-size: 1rem;
    }
  }
  
  /* Prevent text selection on interactive elements */
  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
</style>
</head>
<body>
  <!-- Floating particles -->
  <div class="particles" id="particles"></div>
  
  <!-- Mobile Header -->
  <div class="mobile-header">
    <div class="logo" id="mobileHomeLink">PLURderapolis</div>
    <button class="mobile-menu-btn" id="mobileMenuBtn">
      <i class="fas fa-bars"></i>
    </button>
  </div>
  
  <!-- Mobile Navigation Menu -->
  <div class="mobile-nav" id="mobileNav">
    <div class="mobile-nav-header">
      <div class="mobile-nav-title">Navigation</div>
      <button class="mobile-nav-close" id="mobileNavClose">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="mobile-nav-section">
      <div class="mobile-nav-section-title">Page Sections</div>
      <div class="mobile-nav-links">
        <a href="#tool" class="mobile-nav-link">
          <i class="fas fa-search-plus"></i>
          <span>Interaction Checker</span>
        </a>
        <a href="#matrix-key" class="mobile-nav-link">
          <i class="fas fa-key"></i>
          <span>Matrix Key</span>
        </a>
        <a href="#matrix" class="mobile-nav-link">
          <i class="fas fa-table"></i>
          <span>Risk Matrix</span>
        </a>
        <a href="#tips" class="mobile-nav-link">
          <i class="fas fa-lightbulb"></i>
          <span>Harm Reduction Tips</span>
        </a>
        <a href="#categories" class="mobile-nav-link">
          <i class="fas fa-layer-group"></i>
          <span>Combo Categories</span>
        </a>
      </div>
    </div>
    
    <div class="mobile-nav-section">
      <div class="mobile-nav-section-title">Site Pages</div>
      <div class="mobile-nav-links">
        <a href="rx-combos.html" class="mobile-nav-link highlight">
          <i class="fas fa-prescription-bottle"></i>
          <span>Rx Combos</span>
        </a>
        <a href="resources.html" class="mobile-nav-link">
          <i class="fas fa-book"></i>
          <span>Resources</span>
        </a>
        <a href="emergency.html" class="mobile-nav-link">
          <i class="fas fa-exclamation-triangle"></i>
          <span>Emergency</span>
        </a>
        <a href="spiking.html" class="mobile-nav-link">
          <i class="fas fa-skull-crossbones"></i>
          <span>Spiking</span>
        </a>
        <a href="fake.html" class="mobile-nav-link">
          <i class="fas fa-search"></i>
          <span>Fake Drugs</span>
        </a>
      </div>
    </div>
  </div>
  
  <div class="wrap">
    <!-- Desktop Branding (hidden on mobile) -->
    <div class="branding desktop-only">
      <div class="logo" id="homeLink">PLURderapolis</div>
      <div class="tagline">Harm Reduction & Community Safety - Empowering informed decisions through education and support</div>
    </div>
    
    <h1>Polydrug Interaction Checker <span class="icons">âš¡ðŸ’ŠðŸ’€ðŸŒˆ</span></h1>
    <p class="lede">Mobile-first, harm-reduction focused tool to check drug combination risks. Pick up to three substances and see detailed safety information. Matrix is downloadable + shareable.</p>

    <!-- ===== Interaction Checker (TOP) ===== -->
    <section class="tool" aria-label="Polydrug Interaction Checker" id="tool">
      <h2><i class="fas fa-search-plus"></i> Quick Check</h2>
      <div class="row">
        <div class="sel">
          <label for="drugA"><i class="fas fa-pills"></i> Substance A</label>
          <select id="drugA"></select>
        </div>
        <div class="sel">
          <label for="drugB"><i class="fas fa-pills"></i> Substance B</label>
          <select id="drugB"></select>
        </div>
        <div class="sel">
          <label for="drugC"><i class="fas fa-pills"></i> Substance C (optional)</label>
          <select id="drugC"></select>
        </div>
        <div class="sel">
          <button class="primary" id="checkBtn"><i class="fas fa-search"></i> Check Interactions <span class="icons">âš¡</span></button>
        </div>
      </div>

      <div class="legend" aria-label="Legend">
        <span><b>ðŸŒˆ</b> Low concern</span>
        <span><b>âš¡</b> Caution</span>
        <span><b>ðŸ’Š</b> Strong caution</span>
        <span><b>ðŸ’€</b> Dangerous</span>
      </div>

      <div class="result" id="resultBox" aria-live="polite">
        <h3><i class="fas fa-clipboard-list"></i> Results will appear here</h3>
        <p>We'll show A+B, A+C, B+C and a combined A+B+C overview with detailed harm-reduction pointers.</p>
        <div class="share-results" id="shareResults" style="display: none;">
          <button class="share-btn" id="copyResults"><i class="fas fa-copy"></i> Copy Results</button>
          <button class="share-btn" id="saveResults"><i class="fas fa-save"></i> Save Results</button>
          <button class="share-btn" id="shareTwitter"><i class="fab fa-twitter"></i> Tweet</button>
          <button class="share-btn" id="shareReddit"><i class="fab fa-reddit"></i> Reddit</button>
        </div>
      </div>
    </section>

    <!-- ===== Matrix Key ===== -->
    <div class="section-heading" id="matrix-key">
      <i class="fas fa-key"></i> Matrix Risk Key
    </div>

    <div class="matrix-key">
      <h3><i class="fas fa-info-circle"></i> Understanding the Risk Levels</h3>
      <div class="key-items">
        <div class="key-item low">
          <div class="key-header">
            <span class="key-icon">ðŸŒˆ</span>
            <span class="key-title">Low Risk (ðŸŒˆ)</span>
          </div>
          <p><strong>Minimal interaction concerns</strong> - These substances typically have minimal negative interactions when used together. However, individual responses can vary based on dosage, tolerance, and personal health factors.</p>
          <p><strong>Harm Reduction Tips:</strong> Start with lower doses than you would take individually, stay hydrated, and have a sober friend present if trying this combination for the first time.</p>
        </div>
        
        <div class="key-item caution">
          <div class="key-header">
            <span class="key-icon">âš¡</span>
            <span class="key-title">Caution (âš¡)</span>
          </div>
          <p><strong>Moderate interaction concerns</strong> - These combinations may increase side effects or intensify experiences beyond comfortable levels. Requires careful dosing and monitoring.</p>
          <p><strong>Potential Concerns:</strong> Increased heart rate, blood pressure changes, anxiety, or unexpected psychological effects.</p>
          <p><strong>Harm Reduction Tips:</strong> Use significantly lower doses than you would take individually, wait longer between doses to assess effects, and avoid operating vehicles or machinery.</p>
        </div>
        
        <div class="key-item strong">
          <div class="key-header">
            <span class="key-icon">ðŸ’Š</span>
            <span class="key-title">Strong Caution (ðŸ’Š)</span>
          </div>
          <p><strong>Significant interaction risk</strong> - These substances have known pharmacological interactions that can significantly increase risks. Should be approached with extreme caution.</p>
          <p><strong>Specific Risks:</strong> Potential for serotonin syndrome, respiratory depression, cardiovascular stress, or unpredictable psychological effects.</p>
          <p><strong>Harm Reduction Tips:</strong> Avoid this combination if possible. If combining, use minimal doses and have medical supervision available. Do not use alone.</p>
        </div>
        
        <div class="key-item danger">
          <div class="key-header">
            <span class="key-icon">ðŸ’€</span>
            <span class="key-title">Dangerous (ðŸ’€)</span>
          </div>
          <p><strong>High risk of severe harm or death</strong> - These combinations create a high risk of fatal overdose, severe medical complications, or permanent harm. Among the most dangerous drug combinations known.</p>
          <p><strong>Specific Life-Threatening Risks:</strong> Profound respiratory depression, cardiac arrest, seizure risk, extreme hyperthermia, or coma.</p>
          <p><strong>CRITICAL SAFETY INFORMATION:</strong> DO NOT COMBINE THESE SUBSTANCES. If accidental exposure occurs, call emergency services immediately.</p>
        </div>
      </div>
    </div>

    <!-- ===== Controls + Matrix ===== -->
    <div class="swipe-indicator">
      <i class="fas fa-arrows-left-right"></i> Swipe left/right to explore the full matrix
    </div>
    
    <div class="controls">
      <button class="download" id="savePageBtn"><i class="fas fa-download"></i> Save Page</button>
      <button class="share" id="shareBtn"><i class="fas fa-share-alt"></i> Share Page</button>
    </div>

    <div class="section-heading" id="matrix">
      <i class="fas fa-table"></i> Interaction Matrix
    </div>

    <div class="matrix" role="region" aria-label="Combo Risk Matrix">
      <table id="matrixTable"></table>
    </div>

    <!-- ===== Tips (quick) ===== -->
    <details class="info" open id="tips">
      <summary><i class="fas fa-lightbulb"></i> Harm Reduction Tips <span class="tag">(quick)</span></summary>
      <ul>
        <li><strong>Test what you can.</strong> Start low, go slow. Space redoses.</li>
        <li><span class="pill">Never stack depressants</span> (alcohol, benzos, GHB, opioids) â€” biggest driver of fatal ODs.</li>
        <li><strong>Heat + stimulants = risk.</strong> Cool environment, electrolyte sips, rest breaks.</li>
        <li><strong>Carry naloxone</strong> if opioids could be around. Don't use alone. Recovery position if someone is out.</li>
        <li><strong>On Rx meds?</strong> Avoid chasing "muted" effects by redosing â€” risk goes up even if euphoria doesn't.</li>
      </ul>
    </details>

    <!-- ===== Category cards at bottom ===== -->
    <div class="section-heading" id="categories">
      <i class="fas fa-layer-group"></i> Combo Categories
    </div>

    <details class="info"><summary><i class="fas fa-capsules"></i> Depressant Ã— Depressant <span class="tag">benzodiazepines, alcohol, GHB, opioids, trazodone, gabapentin</span></summary>
      <p><b>Risk:</b> <b>ðŸ’€</b> â€” synergistic respiratory depression, blackouts, aspiration.</p>
      <ul>
        <li>Keep people awake & breathing; recovery position if unresponsive.</li>
        <li>Naloxone reverses opioids (not benzos/GHB); still call EMS.</li>
      </ul>
    </details>

    <details class="info"><summary><i class="fas fa-bolt"></i> Stimulant Ã— Stimulant <span class="tag">MDMA, cocaine, ADHD meds, bupropion</span></summary>
      <p><b>Risk:</b> <b>ðŸ’Šâ†’ðŸ’€</b> â€” hypertension, hyperthermia, arrhythmia, panic.</p>
      <ul>
        <li>Avoid stacking; cool down, hydrate, don't chase muted highs.</li>
      </ul>
    </details>

    <details class="info"><summary><i class="fas fa-balance-scale"></i> Stimulant Ã— Depressant <span class="tag">e.g., cocaine+alcohol, MDMA+GHB</span></summary>
      <p><b>Risk:</b> <b>ðŸ’Š</b> â€” masking sedation, dehydration, liver stress (cocaethylene with alcohol+cocaine).</p>
      <ul>
        <li>Don't redose to "even it out". Watch breathing and heat load.</li>
      </ul>
    </details>

    <details class="info"><summary><i class="fas fa-cloud-sun"></i> Psychedelics with Cannabis</summary>
      <p>Can potentiate intensity/anxiety. Delay THC until past peak; micro-puffs if at all.</p>
    </details>

    <details class="info"><summary><i class="fas fa-head-side-virus"></i> Dissociative Ã— Depressant <span class="tag">ketamine/nitrous + alcohol/benzos/GHB</span></summary>
      <p>Hypoxia/airway risk + amnesia. Sit down, supervised, fresh air breaks.</p>
    </details>

    <!-- Footer Navigation -->
    <div class="footer-nav">
      <a href="rx-combos.html" class="footer-link highlight"><i class="fas fa-prescription-bottle"></i> Rx Combos</a>
      <a href="resources.html" class="footer-link"><i class="fas fa-book"></i> Resources</a>
      <a href="emergency.html" class="footer-link"><i class="fas fa-exclamation-triangle"></i> Emergency</a>
      <a href="spiking.html" class="footer-link"><i class="fas fa-skull-crossbones"></i> Spiking</a>
      <a href="fake.html" class="footer-link"><i class="fas fa-search"></i> Fake Drugs</a>
    </div>

    <!-- ===== Legal disclaimer (single) ===== -->
    <footer>
      <p><strong>Legal & Medical Disclaimer:</strong> The information provided on PLURderapolis.org is for educational and harm reduction purposes only. It is not intended as medical advice, diagnosis, or treatment. Always seek the advice of qualified healthcare providers with any questions regarding medical conditions or substance use.</p>
      
      <p>No information on this site should be interpreted as encouraging or promoting substance use. The interaction data presented is based on established harm reduction resources and clinical literature, but individual responses to substances vary widely based on numerous factors including genetics, tolerance, metabolism, underlying health conditions, dosage, and setting.</p>
      
      <p>PLURderapolis.org makes no representations or warranties about the accuracy, completeness, or suitability of the information provided. Users assume all risks associated with any actions taken based on this information. In case of medical emergency, contact emergency services immediately.</p>
      
      <p>By using this site, you acknowledge and agree that PLURderapolis.org, its creators, and contributors are not liable for any direct, indirect, incidental, consequential, or punitive damages arising from your use of or reliance on the information provided.</p>
      
      <p>Â© 2025 PLURderapolis â€¢ <span class="pill">Stay safe. Stay kind.</span></p>
    </footer>
  </div>

  <!-- Save Page Modal -->
  <div class="save-modal" id="saveModal">
    <div class="save-modal-content">
      <h3><i class="fas fa-save"></i> Save Page</h3>
      <p>Choose how you'd like to save this information:</p>
      <div class="save-options">
        <div class="save-option" id="savePdf">
          <i class="fas fa-file-pdf fa-2x"></i>
          <div>PDF</div>
        </div>
        <div class="save-option" id="saveHtml">
          <i class="fas fa-code fa-2x"></i>
          <div>HTML</div>
        </div>
        <div class="save-option" id="saveImage">
          <i class="fas fa-image fa-2x"></i>
          <div>Image</div>
        </div>
      </div>
      <button class="modal-close" id="closeModal">Close</button>
    </div>
  </div>

  <!-- Matrix Detail Modal -->
  <div class="matrix-modal" id="matrixModal">
    <div class="matrix-modal-content">
      <div class="matrix-modal-header">
        <h3 id="matrixModalTitle"><i class="fas fa-info-circle"></i> Interaction Details</h3>
        <button class="matrix-modal-close" id="matrixModalClose"><i class="fas fa-times"></i></button>
      </div>
      <div id="matrixModalBody"></div>
    </div>
  </div>

  <!-- Back to top button -->
  <button class="back-to-top" id="backToTop" aria-label="Back to top"><i class="fas fa-arrow-up"></i></button>

<script>
// Mobile navigation functionality
const mobileMenuBtn = document.getElementById('mobileMenuBtn');
const mobileNav = document.getElementById('mobileNav');
const mobileNavClose = document.getElementById('mobileNavClose');
const mobileHomeLink = document.getElementById('mobileHomeLink');

mobileMenuBtn.addEventListener('click', () => {
  mobileNav.style.display = 'flex';
  document.body.style.overflow = 'hidden';
});

mobileNavClose.addEventListener('click', () => {
  mobileNav.style.display = 'none';
  document.body.style.overflow = 'auto';
});

mobileHomeLink.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Close mobile nav when clicking on a link
document.querySelectorAll('.mobile-nav-link').forEach(link => {
  link.addEventListener('click', () => {
    mobileNav.style.display = 'none';
    document.body.style.overflow = 'auto';
  });
});

// Close mobile nav when clicking outside
mobileNav.addEventListener('click', (e) => {
  if (e.target === mobileNav) {
    mobileNav.style.display = 'none';
    document.body.style.overflow = 'auto';
  }
});

// Home link functionality
document.getElementById('homeLink').addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Substance list
const substances = [
  "Cannabis", "Ketamine", "MDMA", "Cocaine", "Alcohol", 
  "GHB", "Opioids", "Benzos", "SSRIs", "ADHD Meds", 
  "LSD", "Shrooms", "Nitrous", "DMT", "Viagra"
];

// Risk matrix data
const riskMatrix = {
  "Cannabis": ["â€”", "âš¡", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "âš¡", "ðŸŒˆ", "ðŸ’Š", "ðŸ’Š", "ðŸŒˆ", "ðŸ’Š", "âš¡"],
  "Ketamine": ["âš¡", "â€”", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "âš¡", "âš¡", "ðŸ’Š", "ðŸ’€", "ðŸ’€", "âš¡", "ðŸ’€", "âš¡"],
  "MDMA": ["ðŸ’Š", "ðŸ’€", "â€”", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’€", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’Š"],
  "Cocaine": ["ðŸ’Š", "ðŸ’€", "ðŸ’Š", "â€”", "ðŸ’Š", "ðŸ’€", "ðŸ’€", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’€"],
  "Alcohol": ["ðŸ’Š", "ðŸ’€", "ðŸ’Š", "ðŸ’Š", "â€”", "ðŸ’€", "ðŸ’€", "ðŸ’€", "âš¡", "âš¡", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’€", "âš¡"],
  "GHB": ["ðŸ’Š", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "â€”", "ðŸ’€", "ðŸ’€", "âš¡", "âš¡", "ðŸ’€", "ðŸ’€", "âš¡", "ðŸ’€", "âš¡"],
  "Opioids": ["ðŸ’Š", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "â€”", "ðŸ’€", "âš¡", "âš¡", "ðŸ’€", "ðŸ’€", "âš¡", "ðŸ’€", "âš¡"],
  "Benzos": ["ðŸ’Š", "âš¡", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’€", "ðŸ’€", "â€”", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "ðŸ’€", "âš¡"],
  "SSRIs": ["âš¡", "âš¡", "ðŸ’Š", "ðŸ’Š", "âš¡", "âš¡", "âš¡", "âš¡", "â€”", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡"],
  "ADHD Meds": ["ðŸŒˆ", "âš¡", "ðŸ’€", "ðŸ’€", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "â€”", "âš¡", "âš¡", "âš¡", "âš¡", "ðŸ’Š"],
  "LSD": ["ðŸ’Š", "ðŸ’€", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’€", "âš¡", "âš¡", "âš¡", "â€”", "ðŸŒˆ", "âš¡", "âš¡", "âš¡"],
  "Shrooms": ["ðŸ’Š", "ðŸ’€", "ðŸ’Š", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "ðŸ’€", "âš¡", "âš¡", "âš¡", "ðŸŒˆ", "â€”", "âš¡", "âš¡", "âš¡"],
  "Nitrous": ["ðŸŒˆ", "âš¡", "ðŸ’Š", "ðŸ’Š", "ðŸ’€", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "â€”", "âš¡", "âš¡"],
  "DMT": ["ðŸ’Š", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "ðŸ’€", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "â€”", "âš¡"],
  "Viagra": ["âš¡", "âš¡", "ðŸ’Š", "ðŸ’€", "âš¡", "âš¡", "âš¡", "âš¡", "âš¡", "ðŸ’Š", "âš¡", "âš¡", "âš¡", "âš¡", "â€”"]
};

// Detailed interaction descriptions
const interactionDetails = {
  "Cannabis|Ketamine": "Mild risk: may increase sedation or dizziness. Use with caution.",
  "Cannabis|MDMA": "Increased heart strain and anxiety risk. Monitor heart rate.",
  "Cannabis|Cocaine": "Increased cardiovascular strain. Avoid high doses.",
  "Cannabis|Alcohol": "Increased sedation and nausea. Moderate consumption.",
  "Cannabis|GHB": "Heightened sedation; risk of breathing suppression. Avoid.",
  "Cannabis|Opioids": "Severe respiratory depression risk. Dangerous combination.",
  "Cannabis|Benzos": "Increased sedation, cognitive impairment. Use extreme caution.",
  "Cannabis|SSRIs": "Mild interaction; usually safe but monitor for changes.",
  "Cannabis|ADHD Meds": "Generally safe combination with minimal interaction.",
  "Cannabis|LSD": "May intensify effects and anxiety. Start with low doses.",
  "Cannabis|Shrooms": "May intensify effects and anxiety. Start with low doses.",
  "Cannabis|Nitrous": "Generally safe combination with minimal interaction.",
  "Cannabis|DMT": "May increase anxiety and cardiovascular strain. Use caution.",
  "Cannabis|Viagra": "Mild interaction; monitor blood pressure.",
  
  "Ketamine|MDMA": "Dangerous combo: high risk of respiratory failure. AVOID.",
  "Ketamine|Cocaine": "Dangerous combo: high risk of heart issues. AVOID.",
  "Ketamine|Alcohol": "Dangerous combo: respiratory depression risk. AVOID.",
  "Ketamine|GHB": "Dangerous combo: high overdose risk. AVOID.",
  "Ketamine|Opioids": "Dangerous combo: high overdose risk. AVOID.",
  "Ketamine|Benzos": "Increased sedation. Use with caution.",
  "Ketamine|SSRIs": "Mild interaction. Generally safe.",
  "Ketamine|ADHD Meds": "Possible heart strain. Use with caution.",
  "Ketamine|LSD": "High risk of confusion, panic. AVOID.",
  "Ketamine|Shrooms": "High risk of confusion, panic. AVOID.",
  "Ketamine|Nitrous": "Mild sedation increase. Use with caution.",
  "Ketamine|DMT": "High risk; avoid combo. AVOID.",
  "Ketamine|Viagra": "Mild interaction. Generally safe.",
  
  "MDMA|Cocaine": "High heart strain risk. Avoid combination.",
  "MDMA|Alcohol": "Dehydration, liver strain. Moderate consumption.",
  "MDMA|GHB": "Very dangerous: respiratory failure risk. AVOID.",
  "MDMA|Opioids": "Very dangerous: respiratory failure risk. AVOID.",
  "MDMA|Benzos": "Mixed effects; sedation and stimulation. Use caution.",
  "MDMA|SSRIs": "Serotonin syndrome risk. Use extreme caution.",
  "MDMA|ADHD Meds": "Heart strain and serotonin syndrome risk. AVOID.",
  "MDMA|LSD": "Sensory overload, panic. Use extreme caution.",
  "MDMA|Shrooms": "Sensory overload, panic. Use extreme caution.",
  "MDMA|Nitrous": "Oxygen deprivation risk. Use caution.",
  "MDMA|DMT": "High risk, avoid combo. AVOID.",
  "MDMA|Viagra": "Cardiovascular strain. Use with caution.",
  
  "Cocaine|Alcohol": "Creates cocaethylene: very toxic to heart and liver. AVOID.",
  "Cocaine|GHB": "Extremely dangerous combo; fatal overdose risk. AVOID.",
  "Cocaine|Opioids": "Extremely dangerous combo; fatal overdose risk. AVOID.",
  "Cocaine|Benzos": "Risk of heart issues and sedation conflict. AVOID.",
  "Cocaine|SSRIs": "Serotonin syndrome risk. Use caution.",
  "Cocaine|ADHD Meds": "Severe heart strain risk. AVOID.",
  "Cocaine|LSD": "Possible anxiety and heart strain. AVOID.",
  "Cocaine|Shrooms": "Possible anxiety and heart strain. AVOID.",
  "Cocaine|Nitrous": "Possible heart strain. AVOID.",
  "Cocaine|DMT": "High risk; avoid combo. AVOID.",
  "Cocaine|Viagra": "Severe cardiovascular strain. AVOID.",
  
  "Alcohol|GHB": "Deadly combo: respiratory arrest risk. AVOID.",
  "Alcohol|Opioids": "Deadly combo: respiratory arrest risk. AVOID.",
  "Alcohol|Benzos": "Deadly combo: respiratory arrest risk. AVOID.",
  "Alcohol|SSRIs": "Increased sedation and liver strain. Use caution.",
  "Alcohol|ADHD Meds": "Increased heart strain and sedation. Use caution.",
  "Alcohol|LSD": "Increased nausea and anxiety. Use caution.",
  "Alcohol|Shrooms": "Increased nausea and anxiety. Use caution.",
  "Alcohol|Nitrous": "Increased sedation and oxygen deprivation risk. AVOID.",
  "Alcohol|DMT": "Increased nausea and unpredictable effects. AVOID.",
  "Alcohol|Viagra": "Blood pressure changes. Use caution.",
  
  "GHB|Opioids": "Deadly combo: respiratory arrest risk. AVOID.",
  "GHB|Benzos": "Deadly combo: respiratory arrest risk. AVOID.",
  "GHB|SSRIs": "Increased sedation. Use extreme caution.",
  "GHB|ADHD Meds": "Conflicting effects. Use extreme caution.",
  "GHB|LSD": "Unpredictable effects. AVOID.",
  "GHB|Shrooms": "Unpredictable effects. AVOID.",
  "GHB|Nitrous": "Increased sedation. AVOID.",
  "GHB|DMT": "Unpredictable effects. AVOID.",
  "GHB|Viagra": "Blood pressure changes. Use caution.",
  
  "Opioids|Benzos": "Deadly combo: respiratory arrest risk. AVOID.",
  "Opioids|SSRIs": "Increased sedation. Use extreme caution.",
  "Opioids|ADHD Meds": "Conflicting effects. Use extreme caution.",
  "Opioids|LSD": "Unpredictable effects. AVOID.",
  "Opioids|Shrooms": "Unpredictable effects. AVOID.",
  "Opioids|Nitrous": "Increased sedation. AVOID.",
  "Opioids|DMT": "Unpredictable effects. AVOID.",
  "Opioids|Viagra": "Blood pressure changes. Use caution.",
  
  "Benzos|SSRIs": "Increased sedation. Use caution.",
  "Benzos|ADHD Meds": "Conflicting effects. Use caution.",
  "Benzos|LSD": "May reduce anxiety but increase confusion. Use caution.",
  "Benzos|Shrooms": "May reduce anxiety but increase confusion. Use caution.",
  "Benzos|Nitrous": "Increased sedation. Use caution.",
  "Benzos|DMT": "Unpredictable effects. AVOID.",
  "Benzos|Viagra": "Blood pressure changes. Use caution.",
  
  "SSRIs|ADHD Meds": "Serotonin syndrome risk. Use caution.",
  "SSRIs|LSD": "Reduced effects or unpredictable response. Use caution.",
  "SSRIs|Shrooms": "Reduced effects or unpredictable response. Use caution.",
  "SSRIs|Nitrous": "Generally safe with minimal interaction.",
  "SSRIs|DMT": "Unpredictable effects. Use caution.",
  "SSRIs|Viagra": "Generally safe with minimal interaction.",
  
  "ADHD Meds|LSD": "Increased anxiety and cardiovascular strain. Use caution.",
  "ADHD Meds|Shrooms": "Increased anxiety and cardiovascular strain. Use caution.",
  "ADHD Meds|Nitrous": "Generally safe with minimal interaction.",
  "ADHD Meds|DMT": "Increased cardiovascular strain. Use caution.",
  "ADHD Meds|Viagra": "Cardiovascular strain. Use caution.",
  
  "LSD|Shrooms": "Generally safe with potential for intensified experience.",
  "LSD|Nitrous": "May intensify experience. Use with caution.",
  "LSD|DMT": "Intense experience. Use with extreme caution.",
  "LSD|Viagra": "Generally safe with minimal interaction.",
  
  "Shrooms|Nitrous": "May intensify experience. Use with caution.",
  "Shrooms|DMT": "Intense experience. Use with extreme caution.",
  "Shrooms|Viagra": "Generally safe with minimal interaction.",
  
  "Nitrous|DMT": "Unpredictable effects. Use caution.",
  "Nitrous|Viagra": "Generally safe with minimal interaction.",
  
  "DMT|Viagra": "Blood pressure changes. Use caution."
};

// Map risk to CSS class
function getRiskClass(risk) {
  switch(risk) {
    case "ðŸŒˆ": return "risk-low";
    case "âš¡": return "risk-caution";
    case "ðŸ’Š": return "risk-strong";
    case "ðŸ’€": return "risk-danger";
    default: return "";
  }
}

// Fill select dropdowns
function fillSelect(id) {
  const sel = document.getElementById(id);
  sel.innerHTML = '<option value="">â€” Select â€”</option>' + 
    substances.map(s => `<option value="${s}">${s}</option>`).join('');
}

// Initialize the matrix table
function initializeMatrix() {
  const table = document.getElementById('matrixTable');
  let html = '<thead><tr><th>â†“ / â†’</th>';
  
  // Create header row
  substances.forEach(substance => {
    html += `<th>${substance}</th>`;
  });
  html += '</tr></thead><tbody>';
  
  // Create data rows
  substances.forEach(rowSubstance => {
    html += `<tr><th>${rowSubstance}</th>`;
    substances.forEach(colSubstance => {
      let risk = "â€”";
      if (rowSubstance !== colSubstance) {
        risk = riskMatrix[rowSubstance][substances.indexOf(colSubstance)];
      }
      const riskClass = getRiskClass(risk);
      html += `<td class="${riskClass}" data-row="${rowSubstance}" data-col="${colSubstance}">${risk}</td>`;
    });
    html += '</tr>';
  });
  
  html += '</tbody>';
  table.innerHTML = html;
  
  // Add click events to cells
  table.querySelectorAll('td').forEach(cell => {
    if (cell.textContent !== "â€”") {
      cell.addEventListener('click', () => {
        const rowSubstance = cell.getAttribute('data-row');
        const colSubstance = cell.getAttribute('data-col');
        showMatrixDetail(rowSubstance, colSubstance);
      });
    }
  });
}

// Show matrix detail modal
function showMatrixDetail(substanceA, substanceB) {
  const modal = document.getElementById('matrixModal');
  const modalTitle = document.getElementById('matrixModalTitle');
  const modalBody = document.getElementById('matrixModalBody');
  
  // Get the risk level
  let risk = "â€”";
  if (substanceA !== substanceB) {
    risk = riskMatrix[substanceA][substances.indexOf(substanceB)];
  }
  
  modalTitle.innerHTML = `<i class="fas fa-info-circle"></i> ${substanceA} + ${substanceB} â†’ ${risk}`;
  
  let content = '';
  
  if (substanceA === substanceB) {
    content = `
      <div class="pair-detail ${getRiskClass(risk)}">
        <p><strong>Same Substance Combination:</strong> Using ${substanceA} with itself typically doesn't present additional interaction risks beyond the normal effects of the substance itself.</p>
        <p><strong>Harm Reduction Tips:</strong></p>
        <ul>
          <li>Be mindful of cumulative dosing and tolerance</li>
          <li>Follow standard harm reduction practices for this substance</li>
          <li>Remember that redosing increases risks even with the same substance</li>
        </ul>
      </div>
    `;
  } else {
    // Look up detailed interaction info
    const key1 = `${substanceA}|${substanceB}`;
    const key2 = `${substanceB}|${substanceA}`;
    const interaction = interactionDetails[key1] || interactionDetails[key2];
    
    if (interaction) {
      content = `
        <div class="pair-detail ${getRiskClass(risk)}">
          <p><strong>${risk} Risk:</strong> ${interaction}</p>
        </div>
      `;
    } else {
      // Generic description based on risk level
      let genericDesc = '';
      switch(risk) {
        case "ðŸŒˆ":
          genericDesc = "Minimal interaction risk. Still practice standard harm reduction measures.";
          break;
        case "âš¡":
          genericDesc = "Moderate interaction risk. Use caution, start with low doses, and monitor effects carefully.";
          break;
        case "ðŸ’Š":
          genericDesc = "Significant interaction risk. Consider avoiding this combination or use extreme caution with medical supervision.";
          break;
        case "ðŸ’€":
          genericDesc = "High risk combination. Avoid this combination due to potential for severe harm or fatal overdose.";
          break;
        default:
          genericDesc = "Interaction risk unknown. Always exercise caution when combining substances.";
      }
      
      content = `
        <div class="pair-detail ${getRiskClass(risk)}">
          <p><strong>${risk} Risk:</strong> ${genericDesc}</p>
          <p>No specific interaction data available. This does not mean the combination is safe. Always exercise caution and start with low doses when combining substances.</p>
        </div>
      `;
    }
  }
  
  modalBody.innerHTML = content;
  modal.style.display = 'flex';
  document.body.style.overflow = 'hidden';
}

// Check interactions for selected substances
function checkInteractions() {
  const drugA = document.getElementById('drugA').value;
  const drugB = document.getElementById('drugB').value;
  const drugC = document.getElementById('drugC').value;
  const resultBox = document.getElementById('resultBox');
  
  if (!drugA || !drugB) {
    resultBox.innerHTML = `<h3>Please select at least two substances.</h3>`;
    document.getElementById('shareResults').style.display = 'none';
    return;
  }
  
  const selectedSubstances = [drugA, drugB];
  if (drugC) selectedSubstances.push(drugC);
  
  let content = `<h3><i class="fas fa-clipboard-check"></i> Interaction Analysis</h3>`;
  let highestRisk = "ðŸŒˆ";
  
  // Check each pair
  for (let i = 0; i < selectedSubstances.length; i++) {
    for (let j = i + 1; j < selectedSubstances.length; j++) {
      const substanceA = selectedSubstances[i];
      const substanceB = selectedSubstances[j];
      
      let risk = "â€”";
      if (substanceA !== substanceB) {
        risk = riskMatrix[substanceA][substances.indexOf(substanceB)];
      }
      const riskClass = getRiskClass(risk);
      
      // Update highest risk
      const riskOrder = {"ðŸŒˆ": 1, "âš¡": 2, "ðŸ’Š": 3, "ðŸ’€": 4};
      if (riskOrder[risk] > riskOrder[highestRisk]) {
        highestRisk = risk;
      }
      
      // Look up detailed info
      const key1 = `${substanceA}|${substanceB}`;
      const key2 = `${substanceB}|${substanceA}`;
      const interaction = interactionDetails[key1] || interactionDetails[key2];
      
      let description = "No specific interaction data available. Exercise caution.";
      if (interaction) {
        description = interaction;
      }
      
      content += `
        <div class="pair-detail ${riskClass}">
          <div class="risk-icon">${risk}</div>
          <h4>${substanceA} + ${substanceB}</h4>
          <p>${description}</p>
        </div>
      `;
    }
  }
  
  // Add overall risk summary for 3+ substances
  if (selectedSubstances.length >= 3) {
    let overallRiskDesc = "";
    switch(highestRisk) {
      case "ðŸŒˆ":
        overallRiskDesc = "Overall low risk combination, but still practice harm reduction.";
        break;
      case "âš¡":
        overallRiskDesc = "Overall moderate risk combination. Use caution with dosing and monitoring.";
        break;
      case "ðŸ’Š":
        overallRiskDesc = "Overall high risk combination. Consider avoiding or use extreme caution.";
        break;
      case "ðŸ’€":
        overallRiskDesc = "Overall dangerous combination. Strongly recommend avoiding this combination.";
        break;
    }
    
    content += `
      <div class="pair-detail ${getRiskClass(highestRisk)}">
        <div class="risk-icon">${highestRisk}</div>
        <h4>Overall Combination Risk: ${selectedSubstances.join(" + ")}</h4>
        <p>${overallRiskDesc}</p>
        <p><strong>Additional precautions for multiple substances:</strong></p>
        <ul>
          <li>Start with much lower doses than you would take individually</li>
          <li>Space out consumption to assess effects</li>
          <li>Have a sober trip sitter present</li>
          <li>Be prepared for unexpected interactions</li>
        </ul>
      </div>
    `;
  }
  
  content += `<p style="margin-top:1rem;color:var(--muted);font-size:0.9rem;">Remember: individual responses vary based on dosage, tolerance, metabolism, and underlying health conditions. This information is for harm reduction purposes only.</p>`;
  
  resultBox.innerHTML = content;
  document.getElementById('shareResults').style.display = 'flex';
  resultBox.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
}

// Close matrix modal
document.getElementById('matrixModalClose').addEventListener('click', () => {
  document.getElementById('matrixModal').style.display = 'none';
  document.body.style.overflow = 'auto';
});

// Close modal when clicking outside
document.getElementById('matrixModal').addEventListener('click', (e) => {
  if (e.target === document.getElementById('matrixModal')) {
    document.getElementById('matrixModal').style.display = 'none';
    document.body.style.overflow = 'auto';
  }
});

// Save page functionality
const saveModal = document.getElementById('saveModal');
const savePageBtn = document.getElementById('savePageBtn');
const closeModal = document.getElementById('closeModal');

savePageBtn.addEventListener('click', () => {
  saveModal.style.display = 'flex';
  document.body.style.overflow = 'hidden';
});

closeModal.addEventListener('click', () => {
  saveModal.style.display = 'none';
  document.body.style.overflow = 'auto';
});

// Close save modal when clicking outside
saveModal.addEventListener('click', (e) => {
  if (e.target === saveModal) {
    saveModal.style.display = 'none';
    document.body.style.overflow = 'auto';
  }
});

// Back to top button functionality
const backToTopBtn = document.getElementById('backToTop');
window.addEventListener('scroll', () => {
  if (window.pageYOffset > 300) {
    backToTopBtn.style.display = 'block';
  } else {
    backToTopBtn.style.display = 'none';
  }
});

backToTopBtn.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Create floating particles
function createParticles() {
  const particlesContainer = document.getElementById('particles');
  const particleCount = 20;

  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement('div');
    particle.classList.add('particle');

    // Random position
    const left = Math.random() * 100;
    const delay = Math.random() * 15;
    const duration = 15 + Math.random() * 10;

    particle.style.left = `${left}vw`;
    particle.style.animationDelay = `${delay}s`;
    particle.style.animationDuration = `${duration}s`;

    particlesContainer.appendChild(particle);
  }
}

// Share page functionality
document.getElementById('shareBtn').addEventListener('click', () => {
  if (navigator.share) {
    navigator.share({
      title: 'PLURderapolis Polydrug Interaction Checker',
      text: 'Check drug combination risks with this harm reduction tool',
      url: window.location.href
    })
    .catch(err => console.log('Error sharing:', err));
  } else {
    // Fallback for browsers that don't support Web Share API
    navigator.clipboard.writeText(window.location.href)
      .then(() => alert('Page URL copied to clipboard!'))
      .catch(err => console.log('Error copying URL:', err));
  }
});

// Copy results functionality
document.getElementById('copyResults').addEventListener('click', () => {
  const resultText = document.getElementById('resultBox').innerText;
  navigator.clipboard.writeText(resultText)
    .then(() => alert('Results copied to clipboard!'))
    .catch(err => console.log('Error copying results:', err));
});

// Initialize everything when the page loads
window.addEventListener('DOMContentLoaded', () => {
  // Fill dropdowns
  ['drugA', 'drugB', 'drugC'].forEach(fillSelect);
  
  // Initialize matrix
  initializeMatrix();
  
  // Set up event listeners
  document.getElementById('checkBtn').addEventListener('click', checkInteractions);
  
  // Create particles
  createParticles();
});
</script>
</body>
</html>
