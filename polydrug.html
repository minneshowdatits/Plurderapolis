<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<meta name="description" content="PLURderapolis Polydrug Interaction Checker - Harm reduction focused tool to check drug combination risks and safety tips.">
<meta name="keywords" content="polydrug, drug interactions, harm reduction, PLURderapolis, drug safety, risk assessment">
<title>Polydrug Risks & Interaction Checker | PLURderapolis</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;800&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
  :root{
    --bg:#121212;
    --card:#1b0b1b;
    --ink:#eee;
    --muted:#bcbcbc;
    --accent:#bf00bf;
    --accent-2:#e051ff;
    --line:#440044;
    --chip:#550055;
    --shadow:0 0 12px rgba(191,0,191,.25);
    --danger:#ff4d4d;
    --caution:#ffb84d;
    --low-risk:#4dff88;
    --card-gradient: linear-gradient(135deg, #1b0b1b 0%, #2a0a2a 100%);
    --glow: 0 0 15px rgba(191, 0, 191, 0.5);
  }
  *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:'Open Sans',system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; scroll-behavior: smooth; overflow-x: hidden;}
  a{color:var(--accent); text-decoration: none; transition: all 0.3s ease;}
  a:hover {color: var(--accent-2); text-shadow: 0 0 8px rgba(224, 81, 255, 0.5);}
  .wrap{max-width:1000px;margin:auto;padding:16px; width: 100%;}
  h1,h2,h3{font-family:'Montserrat',sans-serif;letter-spacing:.2px; margin-top: 0;}
  h1{font-size:clamp(1.8rem,3vw,2.5rem);color:var(--accent);margin:8px 0 6px; text-align: center; text-shadow: 0 0 10px rgba(191, 0, 191, 0.4);}
  p.lede{color:#f0d1ff;margin:.25rem 0 1rem; font-size: 1.1rem; text-align: center; line-height: 1.5;}
  
  /* Header branding */
  .branding{display:flex;align-items:center;gap:10px;margin-bottom:10px; justify-content: center; flex-direction: column; text-align: center;}
  .logo{font-size:2.2rem;font-weight:800;color:var(--accent);background:linear-gradient(45deg, var(--accent), var(--accent-2), #ff00ff, #bf00bf);-webkit-background-clip:text;-webkit-text-fill-color:transparent; animation: logoPulse 4s infinite ease-in-out, logoColors 8s infinite linear; text-shadow: 0 0 15px rgba(191, 0, 191, 0.5); margin-bottom: 5px; cursor: pointer;}
  @keyframes logoPulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
  }
  @keyframes logoColors {
    0% { filter: hue-rotate(0deg); }
    100% { filter: hue-rotate(360deg); }
  }
  .tagline{color:var(--muted);font-size:1rem; max-width: 500px; line-height: 1.4;}
  
  /* Mobile Header with Menu */
  .mobile-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 16px;
    background: var(--card-gradient);
    border-bottom: 1px solid var(--line);
    position: sticky;
    top: 0;
    z-index: 1000;
    box-shadow: var(--shadow);
  }
  
  .mobile-header .logo {
    font-size: 1.6rem;
    margin: 0;
  }
  
  .mobile-menu-btn {
    background: var(--chip);
    color: var(--ink);
    border: 1px solid var(--line);
    border-radius: 8px;
    padding: 10px;
    font-size: 1.2rem;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
  }
  
  .mobile-menu-btn:hover {
    background: var(--accent);
    transform: translateY(-2px);
    box-shadow: var(--glow);
  }
  
  .mobile-nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 2000;
    display: none;
    flex-direction: column;
    padding: 20px;
    overflow-y: auto;
  }
  
  .mobile-nav-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--line);
  }
  
  .mobile-nav-title {
    font-size: 1.4rem;
    color: var(--accent-2);
    font-weight: 700;
  }
  
  .mobile-nav-close {
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
  }
  
  .mobile-nav-close:hover {
    background: var(--accent-2);
    transform: scale(1.1);
  }
  
  .mobile-nav-section {
    margin-bottom: 25px;
  }
  
  .mobile-nav-section-title {
    font-size: 1.1rem;
    color: var(--accent-2);
    margin-bottom: 12px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1px;
  }
  
  .mobile-nav-links {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  
  .mobile-nav-link {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 15px;
    background: var(--card-gradient);
    border-radius: 10px;
    border: 1px solid var(--line);
    color: var(--ink);
    transition: all 0.3s ease;
  }
  
  .mobile-nav-link:hover {
    background: rgba(191, 0, 191, 0.1);
    border-color: var(--accent);
    transform: translateX(5px);
  }
  
  .mobile-nav-link.highlight {
    background: var(--chip);
    font-weight: 700;
  }
  
  .mobile-nav-link.highlight:hover {
    background: var(--accent);
  }
  
  /* Top checker card */
  .tool{background:var(--card-gradient);border-radius:14px;padding:20px;box-shadow:var(--shadow);position:sticky;top:0.35rem;z-index:5; animation: fadeIn 0.8s ease-out; border: 1px solid var(--line); margin-bottom: 25px;}
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .tool h2{font-size:1.3rem;margin:.2rem 0 .6rem;color:var(--accent-2); text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px;}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .sel{flex:1 1 100%;min-width:0;display:flex;flex-direction:column;gap:6px}
  label{font-weight:700;color:var(--accent);font-size:.9rem; display: flex; align-items: center; gap: 5px;}
  select{width:100%;padding:.8rem 1rem;border:1px solid var(--line);border-radius:10px;background:#220022;color:var(--ink);appearance:none; transition: all 0.3s ease; font-size: 1rem;}
  select:focus {outline: none; border-color: var(--accent-2); box-shadow: 0 0 0 2px rgba(224, 81, 255, 0.3);}
  button.primary{background:var(--accent);color:#fff;border:0;border-radius:10px;padding:.9rem 1.2rem;font-weight:800;cursor:pointer; transition: all 0.3s ease; position: relative; overflow: hidden; font-size: 1rem; width: 100%;}
  button.primary:hover {background: var(--accent-2); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(191, 0, 191, 0.4);}
  button.primary:active{transform:translateY(1px)}
  button.primary::after {content: ''; position: absolute; top: 50%; left: 50%; width: 5px; height: 5px; background: rgba(255, 255, 255, 0.5); opacity: 0; border-radius: 100%; transform: scale(1, 1) translate(-50%); transform-origin: 50% 50%;}
  button.primary:focus:not(:active)::after {animation: ripple 1s ease-out;}
  @keyframes ripple {0% {transform: scale(0, 0); opacity: 0.5;} 100% {transform: scale(20, 20); opacity: 0;}}
  .icons{font-size:1.05rem;opacity:.95; animation: iconGlow 2s infinite alternate;}
  @keyframes iconGlow {
    from { text-shadow: 0 0 5px rgba(191, 0, 191, 0.5); }
    to { text-shadow: 0 0 10px rgba(224, 81, 255, 0.8); }
  }
  .result{margin-top:20px;border:1px dashed var(--line);border-radius:12px;padding:15px;background:#170717; animation: slideIn 0.5s ease-out; max-height: 500px; overflow-y: auto;}
  @keyframes slideIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .result h3{margin:.2rem 0 .4rem;color:#ffd6ff;font-size:1.2rem; text-align: center;}
  .pairs{margin:.4rem 0 0;padding-left:18px}
  .pair-detail{background:#1f001f;border-radius:8px;padding:15px;margin:12px 0;border-left:4px solid var(--accent); animation: fadeInUp 0.5s ease-out; box-shadow: 0 2px 8px rgba(0,0,0,0.2); position: relative;}
  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }
  .pair-detail.risk-low{border-left-color:var(--low-risk); box-shadow: 0 2px 8px rgba(77, 255, 136, 0.1);}
  .pair-detail.risk-caution{border-left-color:var(--caution); box-shadow: 0 2px 8px rgba(255, 184, 77, 0.1);}
  .pair-detail.risk-strong{border-left-color:var(--accent);}
  .pair-detail.risk-danger{border-left-color:var(--danger); box-shadow: 0 2px 8px rgba(255, 77, 77, 0.1);}
  .risk-icon {position: absolute; top: 15px; right: 15px; font-size: 1.5rem; animation: pulse 2s infinite;}
  @keyframes pulse {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }
  .legend{display:flex;gap:10px;flex-wrap:wrap;margin:15px 0 0;font-size:.95rem;color:var(--muted); justify-content: center;}
  .legend span{display:inline-flex;gap:6px;align-items:center;background:#200120;border:1px solid var(--line);border-radius:999px;padding:.4rem .8rem; transition: all 0.3s ease;}
  .legend span:hover {transform: translateY(-2px); box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);}
  
  /* Matrix Key Section */
  .matrix-key {
    background: var(--card-gradient);
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
    border: 1px solid var(--line);
    box-shadow: var(--shadow);
    animation: fadeIn 0.8s ease-out;
  }
  
  .matrix-key h3 {
    color: var(--accent-2);
    margin-top: 0;
    text-align: center;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  
  .key-items {
    display: grid;
    grid-template-columns: 1fr;
    gap: 15px;
    margin-top: 15px;
  }
  
  .key-item {
    background: #1f001f;
    border-radius: 8px;
    padding: 15px;
    border-left: 4px solid;
    animation: fadeInUp 0.5s ease-out;
  }
  
  .key-item.low { border-left-color: var(--low-risk); }
  .key-item.caution { border-left-color: var(--caution); }
  .key-item.strong { border-left-color: var(--accent); }
  .key-item.danger { border-left-color: var(--danger); }
  
  .key-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 10px;
  }
  
  .key-icon {
    font-size: 1.5rem;
  }
  
  .key-title {
    font-weight: 700;
    font-size: 1.1rem;
  }
  
  /* Share Results */
  .share-results {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    flex-wrap: wrap;
    justify-content: center;
  }
  
  .share-btn {
    background: var(--chip);
    color: var(--ink);
    border: 1px solid var(--line);
    border-radius: 999px;
    padding: 10px 15px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 5px;
    font-size: 0.9rem;
    flex: 1;
    min-width: 140px;
    justify-content: center;
  }
  
  .share-btn:hover {
    background: var(--accent);
    transform: translateY(-2px);
    box-shadow: var(--glow);
  }
  
  /* Matrix */
  .controls{display:flex;align-items:center;gap:15px;margin:20px 0 15px;flex-wrap:wrap; justify-content: center;}
  .download{background:var(--accent);color:#fff;border:0;border-radius:999px;padding:.9rem 1.4rem;font-weight:800;cursor:pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; font-size: 1rem;}
  .download:hover {background: var(--accent-2); transform: translateY(-2px); box-shadow: 0 4px 12px rgba(191, 0, 191, 0.4);}
  .share{background:#2a002a;color:#fff;border:1px solid var(--line);border-radius:999px;padding:.9rem 1.4rem;font-weight:700;cursor:pointer; transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; font-size: 1rem;}
  .share:hover {background: #3a003a; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);}
  .matrix{overflow:auto;border-radius:12px;box-shadow:var(--shadow);border:1px solid var(--line);background:#160616; animation: fadeIn 0.8s ease-out 0.2s both; margin-bottom: 25px;}
  table{border-collapse:collapse;width:100%;min-width:980px;font-size:.92rem}
  th,td{border:1px solid var(--line);padding:.45rem .55rem;text-align:center;vertical-align:middle; transition: all 0.3s ease; position: relative;}
  thead th{position:sticky;top:0;background:#3b0a3b;color:#ffe5ff;z-index:2; box-shadow: 0 2px 5px rgba(0,0,0,0.2);}
  tbody th{position:sticky;left:0;background:#2a002a;color:#fff;z-index:1; box-shadow: 2px 0 5px rgba(0,0,0,0.2);}
  td{background:#1f001f; transition: all 0.3s ease; cursor: pointer;}
  td:hover {transform: scale(1.05); z-index: 3; box-shadow: 0 0 10px rgba(191, 0, 191, 0.5); animation: cellPulse 0.5s;}
  @keyframes cellPulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1.05); }
  }
  td.risk-low{background:#0a2a14}
  td.risk-caution{background:#2a200a}
  td.risk-strong{background:#2a0a2a}
  td.risk-danger{background:#2a0a0a}
  .chip {display:inline-block;background:var(--chip);border-radius:999px;padding:.18rem .55rem;font-weight:700; transition: all 0.3s ease;}
  .chip:hover {transform: scale(1.05); background: var(--accent);}
  
  /* Sections at bottom (accordion) */
  details.info{background:var(--card-gradient);border:1px solid var(--line);border-radius:12px;padding:.8rem 1rem;margin:.8rem 0; transition: all 0.3s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.1);}
  details.info:hover {border-color: var(--accent); transform: translateY(-2px);}
  details.info summary{cursor:pointer;font-weight:800;list-style:none; transition: all 0.3s ease; display: flex; align-items: center; padding: 12px 0; font-size: 1.1rem;}
  details.info summary:hover {color: var(--accent-2);}
  details.info summary::marker, details.info summary::-webkit-details-marker{display:none}
  details.info summary .tag{margin-left:.5rem;opacity:.85; font-size: 0.8rem; background: var(--chip); padding: 2px 8px; border-radius: 10px;}
  details.info[open] {animation: accordionOpen 0.5s ease-out;}
  @keyframes accordionOpen {
    from { opacity: 0; max-height: 0; }
    to { opacity: 1; max-height: 500px; }
  }
  
  /* Back to top button */
  .back-to-top{position:fixed;bottom:20px;right:20px;background:var(--accent);color:#fff;border:0;border-radius:50%;width:50px;height:50px;font-size:1.5rem;cursor:pointer;box-shadow:var(--shadow);z-index:100;display:none; transition: all 0.3s ease; animation: bounce 2s infinite;}
  @keyframes bounce {
    0%, 20%, 50%, 80%, 100% {transform: translateY(0);}
    40% {transform: translateY(-10px);}
    60% {transform: translateY(-5px);}
  }
  .back-to-top:hover {background: var(--accent-2); transform: translateY(-3px) scale(1.1); box-shadow: 0 6px 15px rgba(191, 0, 191, 0.5);}
  
  /* Footer */
  footer{border-top:1px solid var(--line);color:var(--muted);font-size:.9rem;padding:18px;margin-top:16px;text-align:center; animation: fadeIn 0.8s ease-out 0.4s both;}
  .pill{display:inline-block;background:var(--chip);padding:.22rem .6rem;border-radius:999px;font-weight:800; transition: all 0.3s ease;}
  .pill:hover {transform: scale(1.05); background: var(--accent);}
  
  /* Footer Navigation */
  .footer-nav {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 10px;
    margin: 20px 0;
  }
  
  .footer-link {
    color: var(--muted);
    transition: all 0.3s ease;
    padding: 10px 15px;
    border-radius: 20px;
    border: 1px solid transparent;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 0.9rem;
  }
  
  .footer-link:hover {
    color: var(--accent-2);
    border-color: var(--accent);
    transform: translateY(-2px);
  }
  
  .footer-link.highlight {
    background: var(--chip);
    color: var(--ink);
    font-weight: 700;
  }
  
  .footer-link.highlight:hover {
    background: var(--accent);
  }
  
  /* Mobile swipe indicators */
  .swipe-indicator {
    display: block;
    text-align: center;
    margin: 10px 0;
    color: var(--muted);
    font-size: 0.9rem;
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 0.7; }
    50% { opacity: 1; }
  }
  
  /* Section headings */
  .section-heading {
    display: flex;
    align-items: center;
    gap: 10px;
    margin: 25px 0 15px;
    color: var(--accent-2);
    font-size: 1.4rem;
    animation: fadeIn 0.8s ease-out;
  }
  
  .section-heading::after {
    content: '';
    flex: 1;
    height: 2px;
    background: linear-gradient(90deg, var(--accent-2), transparent);
  }
  
  /* Floating particles animation */
  .particles {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: -1;
  }
  
  .particle {
    position: absolute;
    width: 4px;
    height: 4px;
    background: var(--accent-2);
    border-radius: 50%;
    animation: float 15s infinite linear;
    opacity: 0.3;
  }
  
  @keyframes float {
    0% {
      transform: translateY(100vh) translateX(0);
      opacity: 0;
    }
    10% {
      opacity: 0.3;
    }
    90% {
      opacity: 0.3;
    }
    100% {
      transform: translateY(-100px) translateX(100px);
      opacity: 0;
    }
  }
  
  /* Matrix Detail Modal */
  .matrix-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 3000;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease-out;
    padding: 20px;
  }
  
  .matrix-modal-content {
    background: var(--card-gradient);
    border-radius: 12px;
    padding: 20px;
    width: 100%;
    max-width: 500px;
    box-shadow: var(--shadow);
    border: 1px solid var(--line);
    animation: slideIn 0.3s ease-out;
    max-height: 80vh;
    overflow-y: auto;
  }
  
  .matrix-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }
  
  .matrix-modal h3 {
    margin: 0;
    color: var(--accent-2);
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 1.3rem;
  }
  
  .matrix-modal-close {
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 50%;
    width: 36px;
    height: 36px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.3s ease;
    font-size: 1rem;
  }
  
  .matrix-modal-close:hover {
    background: var(--accent-2);
    transform: scale(1.1);
  }
  
  /* Save page modal */
  .save-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.9);
    z-index: 3000;
    justify-content: center;
    align-items: center;
    animation: fadeIn 0.3s ease-out;
    padding: 20px;
  }
  
  .save-modal-content {
    background: var(--card-gradient);
    border-radius: 12px;
    padding: 20px;
    width: 100%;
    max-width: 500px;
    box-shadow: var(--shadow);
    border: 1px solid var(--line);
    animation: slideIn 0.3s ease-out;
  }
  
  .save-modal h3 {
    margin-top: 0;
    color: var(--accent-2);
    text-align: center;
    font-size: 1.3rem;
  }
  
  .save-options {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
    margin: 15px 0;
  }
  
  .save-option {
    background: var(--chip);
    border: 1px solid var(--line);
    border-radius: 8px;
    padding: 15px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
  }
  
  .save-option:hover {
    background: var(--accent);
    transform: translateY(-2px);
  }
  
  .modal-close {
    background: var(--accent);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    width: 100%;
    font-size: 1rem;
    font-weight: 700;
  }
  
  .modal-close:hover {
    background: var(--accent-2);
  }
  
  /* Desktop-only elements */
  .desktop-only {
    display: none;
  }
  
  /* Mobile optimizations */
  @media (min-width: 768px) {
    .mobile-header {
      display: none;
    }
    
    .desktop-only {
      display: block;
    }
    
    .sel {
      flex: 1 1 180px;
    }
    
    button.primary {
      width: auto;
    }
    
    .key-items {
      grid-template-columns: repeat(2, 1fr);
    }
    
    .save-options {
      grid-template-columns: repeat(3, 1fr);
    }
    
    .share-btn {
      flex: 0 1 auto;
      min-width: auto;
    }
    
    .footer-nav {
      gap: 15px;
    }
    
    .footer-link {
      font-size: 1rem;
    }
  }
  
  @media (max-width: 767px) {
    .tool {
      position: static;
      margin-top: 20px;
    }
    
    .legend {
      font-size: .85rem;
    }
    
    table {
      font-size: .8rem;
      min-width: 800px;
    }
    
    .controls {
      flex-direction: column;
      align-items: stretch;
      gap: 10px;
    }
    
    .download, .share {
      width: 100%;
      justify-content: center;
    }
    
    .branding {
      display: none;
    }
    
    h1 {
      font-size: 1.6rem;
      margin-top: 10px;
    }
    
    p.lede {
      font-size: 1rem;
    }
  }
  
  /* Prevent text selection on interactive elements */
  .no-select {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
</style>
</head>
<body>
  <!-- Floating particles -->
  <div class="particles" id="particles"></div>
  
  <!-- Mobile Header -->
  <div class="mobile-header">
    <div class="logo" id="mobileHomeLink">PLURderapolis</div>
    <button class="mobile-menu-btn" id="mobileMenuBtn">
      <i class="fas fa-bars"></i>
    </button>
  </div>
  
  <!-- Mobile Navigation Menu -->
  <div class="mobile-nav" id="mobileNav">
    <div class="mobile-nav-header">
      <div class="mobile-nav-title">Navigation</div>
      <button class="mobile-nav-close" id="mobileNavClose">
        <i class="fas fa-times"></i>
      </button>
    </div>
    
    <div class="mobile-nav-section">
      <div class="mobile-nav-section-title">Page Sections</div>
      <div class="mobile-nav-links">
        <a href="#tool" class="mobile-nav-link">
          <i class="fas fa-search-plus"></i>
          <span>Interaction Checker</span>
        </a>
        <a href="#matrix-key" class="mobile-nav-link">
          <i class="fas fa-key"></i>
          <span>Matrix Key</span>
        </a>
        <a href="#matrix" class="mobile-nav-link">
          <i class="fas fa-table"></i>
          <span>Risk Matrix</span>
        </a>
        <a href="#tips" class="mobile-nav-link">
          <i class="fas fa-lightbulb"></i>
          <span>Harm Reduction Tips</span>
        </a>
        <a href="#categories" class="mobile-nav-link">
          <i class="fas fa-layer-group"></i>
          <span>Combo Categories</span>
        </a>
      </div>
    </div>
    
    <div class="mobile-nav-section">
      <div class="mobile-nav-section-title">Site Pages</div>
      <div class="mobile-nav-links">
        <a href="rx-combos.html" class="mobile-nav-link highlight">
          <i class="fas fa-prescription-bottle"></i>
          <span>Rx Combos</span>
        </a>
        <a href="resources.html" class="mobile-nav-link">
          <i class="fas fa-book"></i>
          <span>Resources</span>
        </a>
        <a href="emergency.html" class="mobile-nav-link">
          <i class="fas fa-exclamation-triangle"></i>
          <span>Emergency</span>
        </a>
        <a href="spiking.html" class="mobile-nav-link">
          <i class="fas fa-skull-crossbones"></i>
          <span>Spiking</span>
        </a>
        <a href="fake.html" class="mobile-nav-link">
          <i class="fas fa-search"></i>
          <span>Fake Drugs</span>
        </a>
      </div>
    </div>
  </div>
  
  <div class="wrap">
    <!-- Desktop Branding (hidden on mobile) -->
    <div class="branding desktop-only">
      <div class="logo" id="homeLink">PLURderapolis</div>
      <div class="tagline">Harm Reduction & Community Safety - Empowering informed decisions through education and support</div>
    </div>
    
    <h1>Polydrug Interaction Checker <span class="icons">âš¡ðŸ’ŠðŸ’€ðŸŒˆ</span></h1>
    <p class="lede">Mobile-first, harm-reduction focused tool to check drug combination risks. Pick up to three substances and see detailed safety information. Matrix is downloadable + shareable.</p>

    <!-- ===== Interaction Checker (TOP) ===== -->
    <section class="tool" aria-label="Polydrug Interaction Checker" id="tool">
      <h2><i class="fas fa-search-plus"></i> Quick Check</h2>
      <div class="row">
        <div class="sel">
          <label for="drugA"><i class="fas fa-pills"></i> Substance A</label>
          <select id="drugA"></select>
        </div>
        <div class="sel">
          <label for="drugB"><i class="fas fa-pills"></i> Substance B</label>
          <select id="drugB"></select>
        </div>
        <div class="sel">
          <label for="drugC"><i class="fas fa-pills"></i> Substance C (optional)</label>
          <select id="drugC"></select>
        </div>
        <div class="sel">
          <button class="primary" id="checkBtn"><i class="fas fa-search"></i> Check Interactions <span class="icons">âš¡</span></button>
        </div>
      </div>

      <div class="legend" aria-label="Legend">
        <span><b>ðŸŒˆ</b> Low concern</span>
        <span><b>âš¡</b> Caution</span>
        <span><b>ðŸ’Š</b> Strong caution</span>
        <span><b>ðŸ’€</b> Dangerous</span>
      </div>

      <div class="result" id="resultBox" aria-live="polite">
        <h3><i class="fas fa-clipboard-list"></i> Results will appear here</h3>
        <p>We'll show A+B, A+C, B+C and a combined A+B+C overview with detailed harm-reduction pointers.</p>
        <div class="share-results" id="shareResults" style="display: none;">
          <button class="share-btn" id="copyResults"><i class="fas fa-copy"></i> Copy Results</button>
          <button class="share-btn" id="saveResults"><i class="fas fa-save"></i> Save Results</button>
          <button class="share-btn" id="shareTwitter"><i class="fab fa-twitter"></i> Tweet</button>
          <button class="share-btn" id="shareReddit"><i class="fab fa-reddit"></i> Reddit</button>
        </div>
      </div>
    </section>

    <!-- ===== Matrix Key ===== -->
    <div class="section-heading" id="matrix-key">
      <i class="fas fa-key"></i> Matrix Risk Key
    </div>

    <div class="matrix-key">
      <h3><i class="fas fa-info-circle"></i> Understanding the Risk Levels</h3>
      <div class="key-items">
        <div class="key-item low">
          <div class="key-header">
            <span class="key-icon">ðŸŒˆ</span>
            <span class="key-title">Low Risk (ðŸŒˆ)</span>
          </div>
          <p><strong>Minimal interaction concerns</strong> - These substances typically have minimal negative interactions when used together. However, individual responses can vary based on dosage, tolerance, and personal health factors.</p>
          <p><strong>Harm Reduction Tips:</strong> Start with lower doses than you would take individually, stay hydrated, and have a sober friend present if trying this combination for the first time.</p>
        </div>
        
        <div class="key-item caution">
          <div class="key-header">
            <span class="key-icon">âš¡</span>
            <span class="key-title">Caution (âš¡)</span>
          </div>
          <p><strong>Moderate interaction concerns</strong> - These combinations may increase side effects or intensify experiences beyond comfortable levels. Requires careful dosing and monitoring.</p>
          <p><strong>Potential Concerns:</strong> Increased heart rate, blood pressure changes, anxiety, or unexpected psychological effects.</p>
          <p><strong>Harm Reduction Tips:</strong> Use significantly lower doses than you would take individually, wait longer between doses to assess effects, and avoid operating vehicles or machinery.</p>
        </div>
        
        <div class="key-item strong">
          <div class="key-header">
            <span class="key-icon">ðŸ’Š</span>
            <span class="key-title">Strong Caution (ðŸ’Š)</span>
          </div>
          <p><strong>Significant interaction risk</strong> - These substances have known pharmacological interactions that can significantly increase risks. Should be approached with extreme caution.</p>
          <p><strong>Specific Risks:</strong> Potential for serotonin syndrome, respiratory depression, cardiovascular stress, or unpredictable psychological effects.</p>
          <p><strong>Harm Reduction Tips:</strong> Avoid this combination if possible. If combining, use minimal doses and have medical supervision available. Do not use alone.</p>
        </div>
        
        <div class="key-item danger">
          <div class="key-header">
            <span class="key-icon">ðŸ’€</span>
            <span class="key-title">Dangerous (ðŸ’€)</span>
          </div>
          <p><strong>High risk of severe harm or death</strong> - These combinations create a high risk of fatal overdose, severe medical complications, or permanent harm. Among the most dangerous drug combinations known.</p>
          <p><strong>Specific Life-Threatening Risks:</strong> Profound respiratory depression, cardiac arrest, seizure risk, extreme hyperthermia, or coma.</p>
          <p><strong>CRITICAL SAFETY INFORMATION:</strong> DO NOT COMBINE THESE SUBSTANCES. If accidental exposure occurs, call emergency services immediately.</p>
        </div>
      </div>
    </div>

    <!-- ===== Controls + Matrix ===== -->
    <div class="swipe-indicator">
      <i class="fas fa-arrows-left-right"></i> Swipe left/right to explore the full matrix
    </div>
    
    <div class="controls">
      <button class="download" id="savePageBtn"><i class="fas fa-download"></i> Save Page</button>
      <button class="share" id="shareBtn"><i class="fas fa-share-alt"></i> Share Page</button>
    </div>

    <div class="section-heading" id="matrix">
      <i class="fas fa-table"></i> Interaction Matrix
    </div>

    <div class="matrix" role="region" aria-label="Combo Risk Matrix">
      <table id="matrixTable"></table>
    </div>

    <!-- ===== Tips (quick) ===== -->
    <details class="info" open id="tips">
      <summary><i class="fas fa-lightbulb"></i> Harm Reduction Tips <span class="tag">(quick)</span></summary>
      <ul>
        <li><strong>Test what you can.</strong> Start low, go slow. Space redoses.</li>
        <li><span class="pill">Never stack depressants</span> (alcohol, benzos, GHB, opioids) â€” biggest driver of fatal ODs.</li>
        <li><strong>Heat + stimulants = risk.</strong> Cool environment, electrolyte sips, rest breaks.</li>
        <li><strong>Carry naloxone</strong> if opioids could be around. Don't use alone. Recovery position if someone is out.</li>
        <li><strong>On Rx meds?</strong> Avoid chasing "muted" effects by redosing â€” risk goes up even if euphoria doesn't.</li>
      </ul>
    </details>

    <!-- ===== Category cards at bottom ===== -->
    <div class="section-heading" id="categories">
      <i class="fas fa-layer-group"></i> Combo Categories
    </div>

    <details class="info"><summary><i class="fas fa-capsules"></i> Depressant Ã— Depressant <span class="tag">benzodiazepines, alcohol, GHB, opioids, trazodone, gabapentin</span></summary>
      <p><b>Risk:</b> <b>ðŸ’€</b> â€” synergistic respiratory depression, blackouts, aspiration.</p>
      <ul>
        <li>Keep people awake & breathing; recovery position if unresponsive.</li>
        <li>Naloxone reverses opioids (not benzos/GHB); still call EMS.</li>
      </ul>
    </details>

    <details class="info"><summary><i class="fas fa-bolt"></i> Stimulant Ã— Stimulant <span class="tag">MDMA, cocaine, ADHD meds, bupropion</span></summary>
      <p><b>Risk:</b> <b>ðŸ’Šâ†’ðŸ’€</b> â€” hypertension, hyperthermia, arrhythmia, panic.</p>
      <ul>
        <li>Avoid stacking; cool down, hydrate, don't chase muted highs.</li>
      </ul>
    </details>

    <details class="info"><summary><i class="fas fa-balance-scale"></i> Stimulant Ã— Depressant <span class="tag">e.g., cocaine+alcohol, MDMA+GHB</span></summary>
      <p><b>Risk:</b> <b>ðŸ’Š</b> â€” masking sedation, dehydration, liver stress (cocaethylene with alcohol+cocaine).</p>
      <ul>
        <li>Don't redose to "even it out". Watch breathing and heat load.</li>
      </ul>
    </details>

    <details class="info"><summary><i class="fas fa-cloud-sun"></i> Psychedelics with Cannabis</summary>
      <p>Can potentiate intensity/anxiety. Delay THC until past peak; micro-puffs if at all.</p>
    </details>

    <details class="info"><summary><i class="fas fa-head-side-virus"></i> Dissociative Ã— Depressant <span class="tag">ketamine/nitrous + alcohol/benzos/GHB</span></summary>
      <p>Hypoxia/airway risk + amnesia. Sit down, supervised, fresh air breaks.</p>
    </details>

    <!-- Footer Navigation -->
    <div class="footer-nav">
      <a href="rx-combos.html" class="footer-link highlight"><i class="fas fa-prescription-bottle"></i> Rx Combos</a>
      <a href="resources.html" class="footer-link"><i class="fas fa-book"></i> Resources</a>
      <a href="emergency.html" class="footer-link"><i class="fas fa-exclamation-triangle"></i> Emergency</a>
      <a href="spiking.html" class="footer-link"><i class="fas fa-skull-crossbones"></i> Spiking</a>
      <a href="fake.html" class="footer-link"><i class="fas fa-search"></i> Fake Drugs</a>
    </div>

    <!-- ===== Legal disclaimer (single) ===== -->
    <footer>
      <p><strong>Legal & Medical Disclaimer:</strong> The information provided on PLURderapolis.org is for educational and harm reduction purposes only. It is not intended as medical advice, diagnosis, or treatment. Always seek the advice of qualified healthcare providers with any questions regarding medical conditions or substance use.</p>
      
      <p>No information on this site should be interpreted as encouraging or promoting substance use. The interaction data presented is based on established harm reduction resources and clinical literature, but individual responses to substances vary widely based on numerous factors including genetics, tolerance, metabolism, underlying health conditions, dosage, and setting.</p>
      
      <p>PLURderapolis.org makes no representations or warranties about the accuracy, completeness, or suitability of the information provided. Users assume all risks associated with any actions taken based on this information. In case of medical emergency, contact emergency services immediately.</p>
      
      <p>By using this site, you acknowledge and agree that PLURderapolis.org, its creators, and contributors are not liable for any direct, indirect, incidental, consequential, or punitive damages arising from your use of or reliance on the information provided.</p>
      
      <p>Â© 2025 PLURderapolis â€¢ <span class="pill">Stay safe. Stay kind.</span></p>
    </footer>
  </div>

  <!-- Save Page Modal -->
  <div class="save-modal" id="saveModal">
    <div class="save-modal-content">
      <h3><i class="fas fa-save"></i> Save Page</h3>
      <p>Choose how you'd like to save this information:</p>
      <div class="save-options">
        <div class="save-option" id="savePdf">
          <i class="fas fa-file-pdf fa-2x"></i>
          <div>PDF</div>
        </div>
        <div class="save-option" id="saveHtml">
          <i class="fas fa-code fa-2x"></i>
          <div>HTML</div>
        </div>
        <div class="save-option" id="saveImage">
          <i class="fas fa-image fa-2x"></i>
          <div>Image</div>
        </div>
      </div>
      <button class="modal-close" id="closeModal">Close</button>
    </div>
  </div>

  <!-- Matrix Detail Modal -->
  <div class="matrix-modal" id="matrixModal">
    <div class="matrix-modal-content">
      <div class="matrix-modal-header">
        <h3 id="matrixModalTitle"><i class="fas fa-info-circle"></i> Interaction Details</h3>
        <button class="matrix-modal-close" id="matrixModalClose"><i class="fas fa-times"></i></button>
      </div>
      <div id="matrixModalBody"></div>
    </div>
  </div>

  <!-- Back to top button -->
  <button class="back-to-top" id="backToTop" aria-label="Back to top"><i class="fas fa-arrow-up"></i></button>

<script>
// Mobile navigation functionality
const mobileMenuBtn = document.getElementById('mobileMenuBtn');
const mobileNav = document.getElementById('mobileNav');
const mobileNavClose = document.getElementById('mobileNavClose');
const mobileHomeLink = document.getElementById('mobileHomeLink');

mobileMenuBtn.addEventListener('click', () => {
  mobileNav.style.display = 'flex';
  document.body.style.overflow = 'hidden';
});

mobileNavClose.addEventListener('click', () => {
  mobileNav.style.display = 'none';
  document.body.style.overflow = 'auto';
});

mobileHomeLink.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Close mobile nav when clicking on a link
document.querySelectorAll('.mobile-nav-link').forEach(link => {
  link.addEventListener('click', () => {
    mobileNav.style.display = 'none';
    document.body.style.overflow = 'auto';
  });
});

// Close mobile nav when clicking outside
mobileNav.addEventListener('click', (e) => {
  if (e.target === mobileNav) {
    mobileNav.style.display = 'none';
    document.body.style.overflow = 'auto';
  }
});

// Home link functionality
document.getElementById('homeLink').addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Interaction data based on provided information
const interactionData = {
  "Cannabis|LSD": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|Mushrooms": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|DMT": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|Mescaline": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|DOx": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|NBOMes": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|2C-x": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|2C-T-x": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Cannabis|Î±MT": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics. Small amounts can reduce nausea with aMT but take care." },
  "Cannabis|5-MeO-xxT": { risk: "âš¡", desc: "Cannabis has an unexpectedly strong and somewhat unpredictable synergy with psychedelics." },
  "Amphetamines|LSD": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Amphetamines|Mushrooms": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Amphetamines|DMT": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Amphetamines|Mescaline": { risk: "âš¡", desc: "The focus and anxiety caused by stimulants is magnified by psychedelics and results in an increased risk of thought loops." },
  "Amphetamines|DOx": { risk: "ðŸ’Š", desc: "The combined stimulating effects of the two can lead to an uncomfortable body-load, while the focusing effects of amphetamine can easily lead to thought loops. Coming down from amphetamines while the DOx is still active can be quite anxiogenic." },
  "Amphetamines|NBOMes": { risk: "ðŸ’Š", desc: "Amphetamines and NBOMes both provide considerable stimulation. When combined they can result in tachycardia, hypertension, vasoconstriction and in extreme cases heart failure. The anxiogenic and focusing effects of stimulants are also not good in combination with psychedelics as they can lead to unpleasant thought loops. NBOMes are known to cause seizures and stimulants can increase this risk." },
  "Amphetamines|2C-x": { risk: "âš¡", desc: "The anxiogenic and focusing effects of stimulants increase the chance of unpleasant thought loops. The combination is generally uneccessary because of the stimulating effects of psychedelics. Combination of the stimulating effects may be uncomfortable." },
  "Amphetamines|2C-T-x": { risk: "ðŸ’Š", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences. In extreme cases, they can result in severe vasoconstriction, tachycardia, hypertension, and in extreme cases heart failure." },
  "Amphetamines|5-MeO-xxT": { risk: "ðŸ’Š", desc: "The anxiogenic and focusing effects of stimulants increase the chance of unpleasant thought loops. The combination is generally unnecessary because of the stimulating effects of psychedelics." },
  "Amphetamines|Cannabis": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Amphetamines|Ketamine": { risk: "âš¡", desc: "No unexpected interactions, though likely to increase blood pressure but not an issue with sensible doses. Moving around on high doses of this combination may be ill advised due to risk of physical injury." },
  "Amphetamines|MXE": { risk: "âš¡", desc: "Risk of tachycardia, hypertension, and manic states." },
  "Amphetamines|DXM": { risk: "ðŸ’Š", desc: "Both substances raise heart rate, in extreme cases, panic attacks caused by these drugs have led to more serious heart issues." },
  "Amphetamines|PCP": { risk: "ðŸ’Š", desc: "This combination can easily lead to hypermanic states." },
  "Amphetamines|MDMA": { risk: "ðŸŒˆ", desc: "Amphetamines increase the neurotoxic effects of MDMA." },
  "Cocaine|LSD": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Cocaine|Mushrooms": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Cocaine|DMT": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Cocaine|Mescaline": { risk: "âš¡", desc: "The focus and anxiety caused by stimulants is magnified by psychedelics and results in an increased risk of thought loops." },
  "Cocaine|DOx": { risk: "ðŸ’Š", desc: "The combined stimulating effects of the two can lead to an uncomfortable body-load, while the focusing effects of cocaine can easily lead to thought loops. Coming down from cocaine while the DOx is still active can be quite anxiogenic." },
  "Cocaine|NBOMes": { risk: "ðŸ’Š", desc: "Cocaine and NBOMes both provide considerable stimulation. When combined they can result in severe vasoconstriction, tachycardia, hypertension, and in extreme cases heart failure." },
  "Cocaine|2C-x": { risk: "âš¡", desc: "The anxiogenic and focusing effects of stimulants increase the chance of unpleasant thought loops. The combination is generally unnecessary because of the stimulating effects of psychedelics. Combination of the stimulating effects may be uncomfortable." },
  "Cocaine|2C-T-x": { risk: "ðŸ’Š", desc: "Cocaine and 2c-t-x both provide considerable stimulation. When combined they can result in severe vasoconstriction, tachycardia, hypertension, and in extreme cases heart failure." },
  "Cocaine|5-MeO-xxT": { risk: "ðŸ’Š", desc: "The anxiogenic and focusing effects of stimulants increase the chance of unpleasant thought loops. The combination is generally unnecessary because of the stimulating effects of psychedelics." },
  "Cocaine|Cannabis": { risk: "âš¡", desc: "Stimulants increase anxiety levels and the risk of thought loops which can lead to negative experiences." },
  "Cocaine|Ketamine": { risk: "âš¡", desc: "No unexpected interactions, though likely to increase blood pressure but not an issue with sensible doses. Moving around on high doses of this combination may be ill advised due to risk of physical injury." },
  "Cocaine|MXE": { risk: "âš¡", desc: "Stimulants taken with MXE can lead to hypermanic states much more easily, especially if sleep is avoided." },
  "Cocaine|DXM": { risk: "ðŸ’Š", desc: "Both substances raise heart rate, in extreme cases, panic attacks caused by these drugs have led to more serious heart issues." },
  "Cocaine|PCP": { risk: "ðŸ’Š", desc: "This combination can easily lead to hypermanic states." },
  "Cocaine|MDMA": { risk: "âš¡", desc: "Cocaine blocks some of the desirable effects of MDMA while increasing the risk of heart attack." },
  "Cocaine|Amphetamines": { risk: "âš¡", desc: "This combination of stimulants will increase strain on the heart. It is not generally worth it as cocaine has a mild blocking effect on dopamine releasers like amphetamine." },
  "Tramadol|LSD": { risk: "ðŸ’Š", desc: "Tramadol is well known to lower seizure threshold and psychedelics also cause occasional seizures." },
  "Tramadol|Mushrooms": { risk: "ðŸ’Š", desc: "Tramadol is well known to lower seizure threshold and psychedelics also cause occasional seizures." },
  "Tramadol|DMT": { risk: "ðŸ’Š", desc: "Tramadol is well known to lower seizure threshold and psychedelics also cause occasional seizures." },
  "Tramadol|Mescaline": { risk: "ðŸ’Š", desc: "This combination can cause seizures due to the lowering of the threshold by tramadol and the potential of mescaline to cause seziures." },
  "Tramadol|DOx": { risk: "ðŸ’Š", desc: "Tramadol is well known to lower seizure threshold and psychedelics also cause occasional seizures." },
  "Tramadol|NBOMes": { risk: "ðŸ’Š", desc: "Tramadol is well known to lower seizure threshold and NBOMes have also shown a tendency to cause severe seizures." },
  "Tramadol|2C-x": { risk: "ðŸ’Š", desc: "Tramadol is well known to lower seizure threshold and psychedelics raise the risk of seizures." },
  "Tramadol|Nitrous": { risk: "âš¡", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. While unconscious, vomit aspiration is a risk if not placed in the recovery position. Memory blackouts are likely." },
  "Tramadol|Amphetamines": { risk: "ðŸ’€", desc: "Tramadol and stimulants both increase the risk of seizures." },
  "Tramadol|MDMA": { risk: "ðŸ’€", desc: "Tramadol and stimulants both increase the risk of seizures." },
  "Tramadol|Cocaine": { risk: "ðŸ’€", desc: "Tramadol and stimulants both increase the risk of seizures." },
  "Tramadol|Alcohol": { risk: "ðŸ’€", desc: "Heavy CNS depressants, risk of seizures. Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. Place affected patients in the recovery position to prevent vomit aspiration from excess. Memory blackouts are likely." },
  "Tramadol|GHB": { risk: "ðŸ’€", desc: "The sedative effects of this combination can lead to dangerous respiratory depression." },
  "Tramadol|Opioids": { risk: "ðŸ’€", desc: "Concomitant use of tramadol increases the seizure risk in patients taking other opioids. These agents are often individually epileptogenic and may have additive effects on seizure threshold during coadministration. Central nervous system- and/or respiratory-depressant effects may be additively or synergistically present." },
  "Tramadol|Benzodiazepines": { risk: "ðŸ’€", desc: "Central nervous system- and/or respiratory-depressant effects may be additively or synergistically present. Vomit aspiration a risk when passed out, lay down in recovery position if ingested." },
  "MDMA|Cannabis": { risk: "ðŸŒˆ", desc: "Large amounts of either or both may cause strong and somewhat unpredictable experiences, which can be as intense as psychedelics. Consider rather Set and Setting are good, before you combine these. Cannabis should be saved for towards the end of the MDMA experience if possible, where the psychedelic alike effect won't come to play." },
  "MDMA|Ketamine": { risk: "ðŸŒˆ", desc: "No unexpected interactions, though likely to increase blood pressure but not an issue with sensible doses. Moving around on high doses of this combination may be ill advised due to risk of physical injury." },
  "MDMA|MXE": { risk: "âš¡", desc: "There have been reports of risky serotonergic interactions when the two are taken at the same time, but MXE taken to the end of an MDMA experience does not appear to cause the same issues." },
  "MDMA|DOx": { risk: "âš¡", desc: "The combined stimulating effects of the two can be uncomfortable. Coming down on the MDMA while the DOx is still active can be quite anxiogenic." },
  "MDMA|5-MeO-xxT": { risk: "âš¡", desc: "Some of the 5-MeO tryptamines are a bit unpredictable and should be mixed with MDMA with care." },
  "MDMA|Alcohol": { risk: "âš¡", desc: "Both MDMA and alcohol cause dehydration. Approach this combination with caution, moderation and sufficient hydration. More than a small amount of alcohol will dull the euphoria of MDMA." },
  "MDMA|GHB": { risk: "âš¡", desc: "Large amounts of GHB/GBL may overwhelm the effects of MDMA on the comedown." },
  "MDMA|MAOIs": { risk: "ðŸ’€", desc: "MAO-B inhibitors can increase the potency and duration of phenethylamines unpredictably. MAO-A inhibitors with MDMA will lead to hypertensive crises." },
  "Alcohol|Cannabis": { risk: "ðŸŒˆ", desc: "In excess, this combination can cause nausea." },
  "Alcohol|Ketamine": { risk: "ðŸ’€", desc: "Both substances cause ataxia and bring a very high risk of vomiting and unconsciousness. If the user falls unconscious while under the influence there is a severe risk of vomit aspiration if they are not placed in the recovery position." },
  "Alcohol|MXE": { risk: "ðŸ’€", desc: "There is a high risk of memory loss, vomiting and severe ataxia from this combination." },
  "Alcohol|DXM": { risk: "ðŸ’€", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. Place affected patients in the recovery position to prevent vomit aspiration from excess. Additionally CNS depression can lead to difficulty breathing. Avoid on anything higher than 1st plateau." },
  "Alcohol|PCP": { risk: "ðŸ’Š", desc: "Details of this combination are not well understood but PCP generally interacts in an unpredictable manner." },
  "Alcohol|Nitrous": { risk: "âš¡", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. While unconscious, vomit aspiration is a risk if not placed in the recovery position. Memory blackouts are likely." },
  "Alcohol|DOx": { risk: "ðŸŒˆ", desc: "Drinking on stimulants is risky because the sedative effects of the alcohol are reduced, and these are what the body uses to gauge drunkenness. This typically leads to excessive drinking with greatly reduced inhibitions, high risk of liver damage and increased dehydration. They will also allow you to drink past a point where you might normally pass out, increasing the risk." },
  "Alcohol|2C-T-x": { risk: "ðŸŒˆ", desc: "Both these classes of compound can interact unpredictably. Caution should be exercised." },
  "Alcohol|Î±MT": { risk: "âš¡", desc: "Î±MT has a broad mechanism of action in the brain and so does alcohol so the combination can be unpredictable." },
  "Alcohol|Amphetamines": { risk: "âš¡", desc: "Drinking on stimulants is risky because the sedative effects of the alcohol are reduced, and these are what the body uses to gauge drunkenness. This typically leads to excessive drinking with greatly reduced inhibitions, high risk of liver damage and increased dehydration. They will also allow you to drink past a point where you might normally pass out, increasing the risk. If you do decide to do this then you should set a limit of how much you will drink each hour and stick to it, bearing in mind that you will feel the alcohol and the stimulant less. Extended release formulations may severely impede sleep, further worsening the hangover." },
  "Alcohol|Cocaine": { risk: "ðŸ’Š", desc: "Drinking on stimulants is risky because the sedative effects of the alcohol are reduced, and these are what the body uses to gauge drunkenness. This typically leads to excessive drinking with greatly reduced inhibitions, high risk of liver damage and increased dehydration. They will also allow you to drink past a point where you might normally pass out, increasing the risk. If you do decide to do this then you should set a limit of how much you will drink each hour and stick to it, bearing in mind that you will feel the alcohol less. Cocaine is potentiated somewhat by alcohol because of the formation of cocaethylene." },
  "Alcohol|GHB": { risk: "ðŸ’€", desc: "Even in very low doses this combination rapidly leads to memory loss, severe ataxia and unconsciousness. There is a high risk of vomit aspiration while unconscious." },
  "Alcohol|Opioids": { risk: "ðŸ’€", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. Place affected patients in the recovery position to prevent vomit aspiration from excess. Memory blackouts are likely." },
  "Alcohol|Benzodiazepines": { risk: "ðŸ’€", desc: "Ethanol ingestion may potentiate the CNS effects of many benzodiazepines. The two substances potentiate each other strongly and unpredictably, very rapidly leading to unconsciousness. While unconscious, vomit aspiration is a risk if not placed in the recovery position. Blacking out and memory loss is almost certain." },
  "Alcohol|MAOIs": { risk: "ðŸ’Š", desc: "Tyramine found in many alcoholic beverages can have dangerous reactions with MAOIs, causing an increase in blood pressure." },
  "Alcohol|SSRIs": { risk: "âš¡", desc: "Alcohol may potentiate some of the pharmacologic effects of CNS-active agents. Use in combination may result in additive central nervous system depression and/or impairment of judgment, thinking, and psychomotor skills." },
  "GHB|Ketamine": { risk: "ðŸ’€", desc: "Both substances cause ataxia and bring a risk of vomiting and unconsciousness. If the user falls unconscious while under the influence there is a severe risk of vomit aspiration if they are not placed in the recovery position." },
  "GHB|MXE": { risk: "ðŸ’€", desc: "Both substances cause ataxia and bring a risk of vomiting and unconsciousness. If the patient falls unconscious while under the influence there is a severe risk of vomit aspiration if they are not placed in the recovery position." },
  "GHB|DXM": { risk: "ðŸ’€", desc: "Both substances cause ataxia and bring a risk of vomiting and unconsciousness. If the patient falls unconscious while under the influence there is a severe risk of vomit aspiration if they are not placed in the recovery position. This combination is hard to predict." },
  "GHB|PCP": { risk: "ðŸ’€", desc: "Details of this combination are not well understood but PCP generally interacts in an unpredictable manner." },
  "GHB|Nitrous": { risk: "âš¡", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. While unconscious, vomit aspiration is a risk if not placed in the recovery position. Memory blackouts are likely." },
  "GHB|Amphetamines": { risk: "âš¡", desc: "Stimulants increase respiration rate allowing a higher dose of sedatives. If the stimulant wears off first then the opiate may overcome the patient and cause respiratory arrest." },
  "GHB|Cocaine": { risk: "âš¡", desc: "Stimulants increase respiration rate allowing a higher dose of sedatives. If the stimulant wears off first then the opiate may overcome the patient and cause respiratory arrest. Likewise the G can wear off and leave a dangerous concentration of cocaine behind." },
  "GHB|Opioids": { risk: "ðŸ’€", desc: "The two substances potentiate each other strongly and unpredictably, very rapidly leading to unconsciousness. While unconscious, vomit aspiration is a risk if not placed in the recovery position." },
  "GHB|Benzodiazepines": { risk: "ðŸ’€", desc: "The two substances potentiate each other strongly and unpredictably, very rapidly leading to unconsciousness. While unconscious, vomit aspiration is a risk if not placed in the recovery position." },
  "Opioids|Ketamine": { risk: "ðŸ’€", desc: "Both substances bring a risk of vomiting and unconsciousness. If the user falls unconscious while under the influence there is a severe risk of vomit aspiration if they are not placed in the recovery position." },
  "Opioids|MXE": { risk: "ðŸ’€", desc: "This combination can potentiate the effects of the opioid." },
  "Opioids|DXM": { risk: "ðŸ’€", desc: "CNS depression, difficult breathing, heart issues, hepatoxic, just very unsafe combination all around. Additionally if one takes dxm, their tolerance of opiates goes down slightly, thus causing additional synergistic effects." },
  "Opioids|PCP": { risk: "âš¡", desc: "PCP can reduce opioid tolerance, increasing the risk of overdose." },
  "Opioids|Nitrous": { risk: "âš¡", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. While unconscious, vomit aspiration is a risk if not placed in the recovery position. Memory blackouts are likely." },
  "Opioids|DOx": { risk: "ðŸŒˆ", desc: "No unexpected interactions." },
  "Opioids|2C-T-x": { risk: "ðŸŒˆ", desc: "No expected interactions, some opioids have serotonin action, and could lead to Serotonin Syndrome or a seizure. These are pretty much only to Pentazocine, Methadone, Tramadol, Tapenatdol." },
  "Opioids|Î±MT": { risk: "ðŸŒˆ", desc: "No unexpected interactions." },
  "Opioids|Amphetamines": { risk: "âš¡", desc: "Stimulants increase respiration rate allowing a higher dose of opiates. If the stimulant wears off first then the opiate may overcome the patient and cause respiratory arrest." },
  "Opioids|Cocaine": { risk: "ðŸ’€", desc: "Stimulants increase respiration rate allowing a higher dose of opiates. If the stimulant wears off first then the opiate may overcome the patient and cause respiratory arrest." },
  "Opioids|Benzodiazepines": { risk: "ðŸ’€", desc: "Central nervous system and/or respiratory-depressant effects may be additively or synergistically present. The two substances potentiate each other strongly and unpredictably, very rapidly leading to unconsciousness. While unconscious, vomit aspiration is a risk if not placed in the recovery position Blackouts/memory loss likely." },
  "Opioids|MAOIs": { risk: "âš¡", desc: "Coadministration of monoamine oxidase inhibitors (MAOIs) with certain opioids has been associated with rare reports of severe and fatal adverse reactions. There appear to be two types of interaction, an excitatory and a depressive one. Symptoms of the excitatory reaction may include agitation, headache, diaphoresis, hyperpyrexia, flushing, shivering, myoclonus, rigidity, tremor, diarrhea, hypertension, tachycardia, seizures, and coma. Death has occurred in some cases." },
  "Opioids|SSRIs": { risk: "ðŸŒˆ", desc: "There have been very infrequent reports of a risk of serotonin syndrome with this combination, though this should not be a practical concern." },
  "Benzodiazepines|Ketamine": { risk: "âš¡", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. While unconscious, vomit aspiration is a risk if not placed in the recovery position." },
  "Benzodiazepines|MXE": { risk: "âš¡", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. Place affected patients in the recovery position to prevent vomit aspiration from excess." },
  "Benzodiazepines|DXM": { risk: "âš¡", desc: "Small doses of benzos can end a bad trip, but both substances potentiate the ataxia and sedation caused by the other and this can lead to unexpected loss of consciousness at high doses. While unconscious, vomit aspiration is a risk if not placed in the recovery position." },
  "Benzodiazepines|PCP": { risk: "ðŸ’Š", desc: "Both substances potentiate the ataxia and sedation caused by the other and can lead to unexpected loss of consciousness at high doses. While unconscious, vomit aspiration is a risk if not placed in the recovery position. Memory blackouts are likely." },
  "Benzodiazepines|Amphetamines": { risk: "ðŸŒˆ", desc: "Both can dull each other's effects, so if one wears off before the other it's possible to overdose due to the lack of counteraction." },
  "MAOIs|Ketamine": { risk: "âš¡", desc: "MAO-B inhibitors appear to increase the potency of Ketamine. MAO-A inhbitors have some negative reports associated with the combination but there isn't much information available." },
  "MAOIs|MXE": { risk: "ðŸ’Š", desc: "MAO-B inhibitors appear to increase the potency of MXE. MAO-A inhbitors have some negative reports associated with the combination but there isn't much information available." },
  "MAOIs|DXM": { risk: "ðŸ’€", desc: "High risk of serotonin syndrome." },
  "MAOIs|PCP": { risk: "ðŸ’€", desc: "This combination is very poorly explored." },
  "MAOIs|DOx": { risk: "âš¡", desc: "MAO-B inhibitors can increase the potency and duration of phenethylamines unpredictably." },
  "MAOIs|NBOMes": { risk: "âš¡", desc: "MAO-B inhibitors can increase the potency and duration of phenethylamines unpredictably." },
  "MAOIs|2C-x": { risk: "âš¡", desc: "MAO-B inhibitors can increase the potency and duration of phenethylamines unpredictably." },
  "MAOIs|2C-T-x": { risk: "âš¡", desc: "MAO-B inhibitors can increase the potency and duration of phenethylamines unpredictably, which could be dangerous given the unpredictability of the 2C-T-x series." },
  "MAOIs|Î±MT": { risk: "ðŸ’€", desc: "Î±MT is an MAOI on its own. Using enzyme inhibitors can greatly reduce predictability of effects." },
  "MAOIs|Amphetamines": { risk: "ðŸ’€", desc: "MAO-B inhibitors can increase the potency and duration of phenethylamines unpredictably. MAO-A inhibitors with amphetamine can lead to hypertensive crises." },
  "MAOIs|Cocaine": { risk: "ðŸ’€", desc: "This combination is poorly explored." },
  "SSRIs|MXE": { risk: "âš¡", desc: "Depending on the SSRI this combination can be unpredictable." },
  "SSRIs|DXM": { risk: "ðŸ’€", desc: "High risk of serotonin syndrome." },
  "SSRIs|PCP": { risk: "ðŸ’Š", desc: "Details of this combination are not well understood but PCP generally interacts in an unpredictable manner." },
  "SSRIs|Cocaine": { risk: "ðŸŒˆ", desc: "May reduce each others' effectiveness. Cocaine can reduce mental stability and therefore exacerbate conditions which SSRIs are used to treat." },
  "Ketamine|DOx": { risk: "ðŸŒˆ", desc: "Ketamine and psychedelics tend to potentiate each other - go slowly." },
  "Ketamine|LSD": { risk: "ðŸŒˆ", desc: "Ketamine and psychedelics tend to potentiate each other - go slowly." },
  "Ketamine|Mushrooms": { risk: "ðŸŒˆ", desc: "Ketamine and psychedelics tend to potentiate each other - go slowly." },
  "Ketamine|DMT": { risk: "ðŸŒˆ", desc: "Ketamine and psychedelics tend to potentiate each other - go slowly." },
  "Ketamine|Mescaline": { risk: "ðŸŒˆ", desc: "Ketamine and psychedelics tend to potentiate each other - go slowly." },
  "MXE|DOx": { risk: "âš¡", desc: "As an NMDA antagonist MXE potentiates DOx which can be unpleasantly intense." },
  "MXE|NBOMes": { risk: "âš¡", desc: "As an NMDA antagonist MXE potentiates NBOMes which can be unpleasantly intense." },
  "MXE|5-MeO-xxT": { risk: "ðŸŒˆ", desc: "Little information exists about this combination." },
  "DXM|DOx": { risk: "ðŸ’Š", desc: "The DOx class as psychedelic stimulants have the potential to mask the effects of DXM and could lead to redosing to an unsafe level. DXM can also potentiate DOx resulting in an unpleasantly intense experience." },
  "DXM|5-MeO-xxT": { risk: "ðŸ’Š", desc: "Little information exists about this combination." },
  "PCP|DOx": { risk: "ðŸ’Š", desc: "Details of this combination are not well understood but PCP generally interacts in an unpredictable manner." },
  "PCP|MXE": { risk: "âš¡", desc: "There are no reports available about this combination." },
  "Caffeine|Mescaline": { risk: "ðŸŒˆ", desc: "High doses of caffeine are uncomfortable and this will be magnified by psychedelics." },
  "Caffeine|DOx": { risk: "âš¡", desc: "High doses of caffeine may cause anxiety which is less manageable when tripping, and since both are stimulating it may cause some physical discomfort." },
  "Caffeine|NBOMes": { risk: "âš¡", desc: "Caffiene can bring out the natural stimulation from psychedelic drugs to make it uncomfortable. High doses can cause anxiety which is hard to handle while tripping." },
  "Caffeine|2C-x": { risk: "ðŸŒˆ", desc: "High doses of caffeine may cause anxiety which is less manageable when tripping, and since both are stimulating the combination may cause some physical discomfort." },
  "Caffeine|2C-T-x": { risk: "ðŸŒˆ", desc: "High doses of caffeine may cause anxiety which is less manageable when tripping, and since both are stimulating the combination may cause some physical discomfort." },
  "Caffeine|Î±MT": { risk: "âš¡", desc: "High doses of caffeine may cause anxiety which is less manageable when tripping, and since both are stimulating the combination may cause some physical discomfort." },
  "Caffeine|5-MeO-xxT": { risk: "ðŸŒˆ", desc: "High doses of caffeine may cause anxiety which is less manageable when tripping, and since both are stimulating the combination may cause some physical discomfort." },
  "Caffeine|Ketamine": { risk: "ðŸŒˆ", desc: "No unexpected interactions." },
  "Caffeine|MXE": { risk: "ðŸŒˆ", desc: "No likely interactions." },
  "Caffeine|DXM": { risk: "ðŸŒˆ", desc: "High doses of caffeine may cause anxiety which is less manageable when tripping, and since both are stimulating the combination may cause some physical discomfort." },
  "Caffeine|PCP": { risk: "âš¡", desc: "Details of this combination are not well understood but PCP generally interacts in an unpredictable manner." },
  "Caffeine|Amphetamines": { risk: "âš¡", desc: "This combination of stimulants is not generally necessary and may increase strain on the heart, as well as potentially causing anxiety and greater physical discomfort." },
  "Caffeine|MDMA": { risk: "âš¡", desc: "Caffiene is not really necessary with MDMA and increases any neurotoxic effects from MDMA." },
  "Caffeine|Cocaine": { risk: "âš¡", desc: "Both stimulants, risk of tachycardia, hypertension, and in extreme cases heart failure." },
  "5-MeO-xxT|Mescaline": { risk: "âš¡", desc: "The 5-MeO class of tryptamines can be unpredictable in their interactions." },
  "5-MeO-xxT|DOx": { risk: "âš¡", desc: "The 5-MeO class of tryptamines can be unpredictable in their interactions, particularly increasing the risk of unpleasant physical side effects." },
  "5-MeO-xxT|NBOMes": { risk: "âš¡", desc: "The 5-MeO class of tryptamines can be unpredictable in their interactions and the NBOMes are known to be unpredictable even alone. This combination is best avoided." },
  "5-MeO-xxT|2C-x": { risk: "âš¡", desc: "The 5-MeO psychedelics can interact unpredictably to potentiate other psychedelics." },
  "5-MeO-xxT|2C-T-x": { risk: "âš¡", desc: "Both classes of compounds can be unpredictable alone." }
};

// All substances in the database
const allSubstances = [
  "Cannabis", "LSD", "Mushrooms", "DMT", "Mescaline", "DOx", "NBOMes", "2C-x", "2C-T-x", "Î±MT", "5-MeO-xxT",
  "Amphetamines", "Cocaine", "Tramadol", "MDMA", "Alcohol", "GHB", "Opioids", "Benzodiazepines", "MAOIs", "SSRIs",
  "Ketamine", "MXE", "DXM", "PCP", "Nitrous", "Caffeine"
];

// Fill select dropdowns
function fillSelect(id) {
  const sel = document.getElementById(id);
  sel.innerHTML = '<option value="">â€” Select â€”</option>' + allSubstances.map(s => `<option>${s}</option>`).join('');
}
["drugA", "drugB", "drugC"].forEach(fillSelect);

// Render matrix table with clickable cells
function renderMatrix() {
  const tbl = document.getElementById("matrixTable");
  const thead = document.createElement("thead");
  const hrow = document.createElement("tr");
  hrow.appendChild(document.createElement("th")).textContent = "â†“ / â†’";
  allSubstances.forEach(h => {
    const th = document.createElement("th");
    th.textContent = h;
    hrow.appendChild(th);
  });
  thead.appendChild(hrow);
  const tbody = document.createElement("tbody");
  allSubstances.forEach(r => {
    const tr = document.createElement("tr");
    const rowTh = document.createElement("th");
    rowTh.textContent = r;
    tr.appendChild(rowTh);
    allSubstances.forEach(c => {
      const td = document.createElement("td");
      td.setAttribute("data-label", c);
      let val = "ðŸŒˆ"; // Default to low risk
      let desc = "No specific interaction data available.";

      // Check for interaction data
      const key1 = `${r}|${c}`;
      const key2 = `${c}|${r}`;
      
      if (interactionData[key1]) {
        val = interactionData[key1].risk;
        desc = interactionData[key1].desc;
      } else if (interactionData[key2]) {
        val = interactionData[key2].risk;
        desc = interactionData[key2].desc;
      } else if (r === c) {
        val = "â€”";
        desc = "Same substance - no interaction data needed.";
      }

      td.textContent = val;
      td.className = getRiskClass(val);
      td.title = `${r} + ${c}: ${desc}`;

      // Add click event to show detailed explanation
      td.addEventListener('click', () => {
        showMatrixDetail(r, c, val, desc);
      });

      tr.appendChild(td);
    });
    tbody.appendChild(tr);
  });
  tbl.appendChild(thead);
  tbl.appendChild(tbody);
}

function getRiskClass(icon) {
  switch (icon) {
    case "ðŸŒˆ": return "risk-low";
    case "âš¡": return "risk-caution";
    case "ðŸ’Š": return "risk-strong";
    case "ðŸ’€": return "risk-danger";
    default: return "";
  }
}

function iconExplain(x) {
  switch (x) {
    case "ðŸŒˆ": return "Low concern / typical co-use profile reported";
    case "âš¡": return "Caution â€” increased side-effect potential; go slow";
    case "ðŸ’Š": return "Strong caution â€” meaningful interaction risk";
    case "ðŸ’€": return "Danger â€” avoid / high overdose or medical risk";
    default: return "â€”";
  }
}

// Show matrix detail modal
function showMatrixDetail(substanceA, substanceB, riskLevel, description) {
  const modal = document.getElementById('matrixModal');
  const modalTitle = document.getElementById('matrixModalTitle');
  const modalBody = document.getElementById('matrixModalBody');

  modalTitle.innerHTML = `<i class="fas fa-info-circle"></i> ${substanceA} + ${substanceB} â†’ ${riskLevel}`;

  let content = '';

  if (substanceA === substanceB) {
    content = `
      <div class="pair-detail ${getRiskClass(riskLevel)}">
        <p><strong>Same Substance Combination:</strong> Using ${substanceA} with itself typically doesn't present additional interaction risks beyond the normal effects of the substance itself.</p>
        <p><strong>Harm Reduction Tips:</strong></p>
        <ul>
          <li>Be mindful of cumulative dosing and tolerance</li>
          <li>Follow standard harm reduction practices for this substance</li>
          <li>Remember that redosing increases risks even with the same substance</li>
        </ul>
      </div>
    `;
  } else {
    content = detailedExplanations[riskLevel](substanceA, substanceB, description);
  }

  modalBody.innerHTML = content;
  modal.style.display = 'flex';
  document.body.style.overflow = 'hidden';
}

// Close matrix modal
document.getElementById('matrixModalClose').addEventListener('click', () => {
  document.getElementById('matrixModal').style.display = 'none';
  document.body.style.overflow = 'auto';
});

// Close modal when clicking outside
document.getElementById('matrixModal').addEventListener('click', (e) => {
  if (e.target === document.getElementById('matrixModal')) {
    document.getElementById('matrixModal').style.display = 'none';
    document.body.style.overflow = 'auto';
  }
});

// Detailed explanations for each interaction
const detailedExplanations = {
  "ðŸŒˆ": (a, b, desc) => `
    <div class="pair-detail risk-low">
      <p><strong>Low Risk Interaction:</strong> ${a} and ${b} typically have minimal negative interactions when used together. However, individual responses can vary based on dosage, tolerance, and personal health factors.</p>
      <p><strong>Note:</strong> ${desc}</p>
      <p><strong>Harm Reduction Tips:</strong></p>
      <ul>
        <li>Start with lower doses than you would take individually</li>
        <li>Stay hydrated and in a safe environment</li>
        <li>Have a sober friend present if trying this combination for the first time</li>
      </ul>
    </div>
  `,
  "âš¡": (a, b, desc) => `
    <div class="pair-detail risk-caution">
      <p><strong>Caution Advised:</strong> Combining ${a} and ${b} may increase side effects or intensify experiences beyond comfortable levels. This combination requires careful dosing and monitoring.</p>
      <p><strong>Note:</strong> ${desc}</p>
      <p><strong>Harm Reduction Tips:</strong></p>
      <ul>
        <li>Use significantly lower doses than you would take individually</li>
        <li>Wait longer between doses to assess effects</li>
        <li>Have benzodiazepines available if anxiety becomes overwhelming (only if prescribed)</li>
        <li>Avoid operating vehicles or machinery</li>
      </ul>
    </div>
  `,
  "ðŸ’Š": (a, b, desc) => `
    <div class="pair-detail risk-strong">
      <p><strong>Strong Caution - Significant Interaction Risk:</strong> ${a} and ${b} have known pharmacological interactions that can significantly increase risks. This combination should be approached with extreme caution.</p>
      <p><strong>Note:</strong> ${desc}</p>
      <p><strong>Harm Reduction Tips:</strong></p>
      <ul>
        <li>Avoid this combination if possible</li>
        <li>If combining, use minimal doses and have medical supervision available</li>
        <li>Be aware of signs of overdose or adverse reactions</li>
        <li>Have naloxone available if opioids are involved</li>
        <li>Do not use alone</li>
      </ul>
    </div>
  `,
  "ðŸ’€": (a, b, desc) => `
    <div class="pair-detail risk-danger">
      <p><strong>DANGEROUS COMBINATION - AVOID:</strong> Combining ${a} and ${b} creates a high risk of fatal overdose, severe medical complications, or permanent harm. This is one of the most dangerous drug combinations known.</p>
      <p><strong>Note:</strong> ${desc}</p>
      <p><strong>CRITICAL SAFETY INFORMATION:</strong></p>
      <ul>
        <li><strong>DO NOT COMBINE THESE SUBSTANCES</strong></li>
        <li>If accidental exposure occurs, call emergency services immediately</li>
        <li>Have multiple doses of naloxone available if opioids are involved</li>
        <li>This combination has resulted in numerous fatal overdoses</li>
        <li>Consider alternative substances that don't carry this extreme risk</li>
      </ul>
    </div>
  `,
  "â€”": (a, b, desc) => `
    <div class="pair-detail">
      <p><strong>Same Substance:</strong> Using ${a} with itself typically doesn't present additional interaction risks beyond the normal effects of the substance itself.</p>
      <p><strong>Harm Reduction Tips:</strong></p>
      <ul>
        <li>Be mindful of cumulative dosing and tolerance</li>
        <li>Follow standard harm reduction practices for this substance</li>
        <li>Remember that redosing increases risks even with the same substance</li>
      </ul>
    </div>
  `
};

// Check button functionality
document.getElementById("checkBtn").addEventListener("click", () => {
  const sel = ["drugA", "drugB", "drugC"].map(id => document.getElementById(id).value).filter(Boolean);
  const box = document.getElementById("resultBox");
  if (sel.length < 2) {
    box.innerHTML = `<h3>Please select at least two substances.</h3>`;
    document.getElementById("shareResults").style.display = "none";
    return;
  }

  let content = `<h3><i class="fas fa-clipboard-check"></i> Interaction Analysis</h3>`;

  // Add detailed explanations for each pair
  for (let i = 0; i < sel.length; i++) {
    for (let j = i + 1; j < sel.length; j++) {
      const a = sel[i], b = sel[j];
      let v = "ðŸŒˆ"; // Default to low risk
      let desc = "No specific interaction data available.";

      // Check for interaction data
      const key1 = `${a}|${b}`;
      const key2 = `${b}|${a}`;
      
      if (interactionData[key1]) {
        v = interactionData[key1].risk;
        desc = interactionData[key1].desc;
      } else if (interactionData[key2]) {
        v = interactionData[key2].risk;
        desc = interactionData[key2].desc;
      }

      content += detailedExplanations[v](a, b, desc);
    }
  }

  content += `<p style="margin-top:1rem;color:var(--muted);font-size:0.9rem;">Remember: individual responses vary based on dosage, tolerance, metabolism, and underlying health conditions. This information is for harm reduction purposes only.</p>`;

  box.innerHTML = content;

  // Show share buttons
  document.getElementById("shareResults").style.display = "flex";

  // Scroll to results
  box.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
});

// Save page functionality
const saveModal = document.getElementById("saveModal");
const savePageBtn = document.getElementById("savePageBtn");
const closeModal = document.getElementById("closeModal");

savePageBtn.addEventListener("click", () => {
  saveModal.style.display = "flex";
  document.body.style.overflow = 'hidden';
});

closeModal.addEventListener("click", () => {
  saveModal.style.display = "none";
  document.body.style.overflow = 'auto';
});

// Close save modal when clicking outside
saveModal.addEventListener('click', (e) => {
  if (e.target === saveModal) {
    saveModal.style.display = 'none';
    document.body.style.overflow = 'auto';
  }
});

// Back to top button functionality
const backToTopBtn = document.getElementById('backToTop');
window.addEventListener('scroll', () => {
  if (window.pageYOffset > 300) {
    backToTopBtn.style.display = 'block';
  } else {
    backToTopBtn.style.display = 'none';
  }
});

backToTopBtn.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});

// Create floating particles
function createParticles() {
  const particlesContainer = document.getElementById('particles');
  const particleCount = 20;

  for (let i = 0; i < particleCount; i++) {
    const particle = document.createElement('div');
    particle.classList.add('particle');

    // Random position
    const left = Math.random() * 100;
    const delay = Math.random() * 15;
    const duration = 15 + Math.random() * 10;

    particle.style.left = `${left}vw`;
    particle.style.animationDelay = `${delay}s`;
    particle.style.animationDuration = `${duration}s`;

    particlesContainer.appendChild(particle);
  }
}

// Initialize everything when the page loads
window.addEventListener('DOMContentLoaded', () => {
  renderMatrix();
  createParticles();
});
</script>
</body>
</html>
